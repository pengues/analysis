(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    110061,       2338]
NotebookOptionsPosition[    107024,       2285]
NotebookOutlinePosition[    107475,       2303]
CellTagsIndexPosition[    107432,       2300]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
This script analyses FCS autocorrelation curves with multi-species analysis \
as presented Pengue 2023. It is written to work with data exported from \
Symphotime 64.

The parameters inserted here are tuned to work with the example provided. \
This example consists of a mixture of one protein (karyopherin \[Beta]1, MW \
100kDa) labelled with Alexa647 NHS and free Alexa647.  The protein is \
expected to be at concentration of 6 nM, the free dye at 4 nM.\
\>", "Text",
 CellChangeTimes->{{3.90254836213878*^9, 3.902548447733947*^9}, {
  3.902656759035369*^9, 3.902656956939046*^9}, {3.902657687303554*^9, 
  3.902657712665971*^9}},ExpressionUUID->"cf41266c-fe6c-4791-bdc8-\
ff892b344b12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"clean", " ", "up", " ", "the", " ", "kernel"}], "*)"}]}]], "Input",\

 CellChangeTimes->{{3.902555517206855*^9, 3.9025555308690453`*^9}},
 CellLabel->
  "In[234]:=",ExpressionUUID->"a0a97180-a7d2-449e-980d-0a64b43b1374"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"We", " ", "set", " ", "the", " ", "working", " ", "directory"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"launch", " ", "=", " ", 
    RowBox[{"StringDelete", "[", 
     RowBox[{
      RowBox[{"DateString", "[", 
       RowBox[{"DateObject", "[", "]"}], "]"}], ",", " ", "\"\<:\>\""}], 
     "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "we", " ", "define", " ", "this", " ", "string", " ", "to", " ", "create", 
    " ", "a", " ", "directory", " ", "to", " ", "export", " ", "all", " ", 
    "the", " ", "plots"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fileNames", " ", "=", 
    RowBox[{"FileNames", "[", "\"\<*.dat\>\"", "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "All", " ", "the", " ", "file", " ", "names", " ", "with", " ", 
    "extension", " ", "dat", " ", "in", " ", "the", " ", "directory", " ", 
    "are", " ", "read"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"fileNames", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], " ", "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"i", ",", " ", "1", ",", " ", 
       RowBox[{"Length", "@", "fileNames"}]}], "}"}]}], "]"}], "//", 
   "MatrixForm"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"filenames", " ", 
     RowBox[{"listed", ".", " ", "By"}], " ", "choosing", " ", "the", " ", 
     "number", " ", 
     RowBox[{"(", 
      RowBox[{"shown", " ", "below"}], ")"}]}], ",", " ", 
    RowBox[{"we", " ", "can", " ", "select", " ", "the", " ", "file"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"fileNum", " ", "=", " ", "1", " ", 
  RowBox[{"(*", 
   RowBox[{"choose", " ", "your", " ", "file"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7106812669968996`*^9, 3.7106812682605076`*^9}, {
   3.7106815000137243`*^9, 3.7106815006689286`*^9}, {3.710827078312729*^9, 
   3.710827078421929*^9}, {3.7190443130990343`*^9, 3.7190443201814346`*^9}, {
   3.723280356658907*^9, 3.72328035738525*^9}, {3.753784476547172*^9, 
   3.7537844767536373`*^9}, 3.753784729226161*^9, 3.780807576095207*^9, 
   3.789471720401086*^9, {3.806115432805599*^9, 3.8061154486389236`*^9}, {
   3.806116466480892*^9, 3.8061164668485823`*^9}, {3.806117219602456*^9, 
   3.806117219787302*^9}, {3.806117251292624*^9, 3.806117288372096*^9}, {
   3.80612237370222*^9, 3.80612237823909*^9}, {3.80612249888457*^9, 
   3.806122500663495*^9}, {3.806122539994192*^9, 3.8061225407250633`*^9}, {
   3.80612258100408*^9, 3.806122581161929*^9}, {3.806122942274798*^9, 
   3.8061229454416018`*^9}, {3.806123006335135*^9, 3.806123025069931*^9}, {
   3.8061232243256598`*^9, 3.806123226758025*^9}, {3.806127134745768*^9, 
   3.8061271402363358`*^9}, {3.807540762248725*^9, 3.8075407624459887`*^9}, {
   3.809236267573292*^9, 3.8092362676967773`*^9}, {3.809238521586091*^9, 
   3.809238521991036*^9}, {3.809262516079751*^9, 3.809262517059827*^9}, {
   3.8093439887838907`*^9, 3.809343989992552*^9}, 3.810283023159034*^9, {
   3.810283073665564*^9, 3.810283074307054*^9}, {3.8102997163025503`*^9, 
   3.81029971666047*^9}, 3.810300220868948*^9, {3.810371482444275*^9, 
   3.810371500094352*^9}, {3.810373759765649*^9, 3.8103737831396217`*^9}, {
   3.810442232679448*^9, 3.810442241606453*^9}, {3.8104423043209047`*^9, 
   3.810442304973769*^9}, {3.810442735470119*^9, 3.810442982045323*^9}, {
   3.8104430144013567`*^9, 3.8104431004203463`*^9}, {3.813911421811945*^9, 
   3.813911502524502*^9}, {3.8139115631547832`*^9, 3.813911563543228*^9}, {
   3.813912034762412*^9, 3.813912050570559*^9}, {3.813919093146019*^9, 
   3.813919108553117*^9}, 3.813919164935403*^9, {3.821706469872841*^9, 
   3.821706500934835*^9}, {3.821879903664*^9, 3.8218800020105467`*^9}, {
   3.821880034945561*^9, 3.82188005317496*^9}, 3.8218801258134537`*^9, {
   3.821933326064633*^9, 3.821933398598977*^9}, 3.821933452369759*^9, {
   3.821933645100481*^9, 3.8219336465607347`*^9}, {3.825562703162468*^9, 
   3.825562704721416*^9}, {3.82556281754456*^9, 3.8255628733643637`*^9}, {
   3.825563001002194*^9, 3.82556301309939*^9}, {3.86377618036631*^9, 
   3.863776246232283*^9}, {3.863779827814103*^9, 3.8637798719110317`*^9}, {
   3.863780332787862*^9, 3.863780384261825*^9}, {3.863781150665778*^9, 
   3.863781160230886*^9}, {3.8637811927008142`*^9, 3.863781219885488*^9}, {
   3.883802876879775*^9, 3.8838029537056723`*^9}, {3.887866996411627*^9, 
   3.8878670078993053`*^9}, 3.887952543782645*^9, {3.888847296534957*^9, 
   3.88884730576147*^9}, {3.888851432602385*^9, 3.8888514561108923`*^9}, {
   3.888852155867321*^9, 3.888852189200171*^9}, {3.890659183311665*^9, 
   3.890659200672344*^9}, {3.890659230786075*^9, 3.890659251022438*^9}, {
   3.890659317408949*^9, 3.890659326606965*^9}, {3.902548312862644*^9, 
   3.9025483531787767`*^9}, {3.902548462905938*^9, 3.9025485558964653`*^9}, {
   3.9025492239307756`*^9, 3.902549228087672*^9}, {3.9025492606331*^9, 
   3.902549335652527*^9}, {3.902551615635682*^9, 3.9025516380548077`*^9}},
 CellLabel->
  "In[235]:=",ExpressionUUID->"74c8ac51-d760-4c36-a9ed-28a896a2135e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"dataRaw", " ", "=", 
    RowBox[{"Drop", "[", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"fileNames", "[", 
        RowBox[{"[", "fileNum", "]"}], "]"}], "]"}], ",", "2"}], "]"}]}], 
   ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Here", " ", "we", " ", "import", " ", "the", " ", "file", " ", "removing",
     " ", 
    RowBox[{"headers", ".", " ", "Edit"}], " ", "this", " ", "if", " ", "you",
     " ", "are", " ", "using", " ", "a", " ", "different", " ", "software", 
    " ", "to", " ", "calculatte", " ", "G", 
    RowBox[{"(", "t", ")"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"start", " ", "=", " ", "1"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"This", " ", "is", " ", "the", " ", "starting", " ", 
     RowBox[{"point", ".", " ", "If"}], " ", "you", " ", "want", " ", "to", 
     " ", "exclude", " ", "some", " ", "points"}], ",", " ", 
    RowBox[{"set", " ", "it", " ", "higher", " ", "then", " ", "1."}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mid", "  ", "=", " ", "49"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "establishes", " ", "the", " ", "boundary", " ", "for", " ", 
    "fitting", " ", "triplets", " ", "within", " ", "the", " ", 
    RowBox[{"region", "."}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"time", " ", "=", " ", 
    RowBox[{"dataRaw", "[", 
     RowBox[{"[", 
      RowBox[{";;", ",", "1"}], "]"}], "]"}]}], "  ", ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Correlation", " ", "time"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"data", " ", "=", " ", 
    RowBox[{"dataRaw", "[", 
     RowBox[{"[", 
      RowBox[{";;", ",", 
       RowBox[{"-", "2"}]}], "]"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Correlation", " ", "G", 
    RowBox[{"(", "t", ")"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"err", " ", "=", "  ", 
    RowBox[{"dataRaw", "[", 
     RowBox[{"[", 
      RowBox[{";;", ",", 
       RowBox[{"-", "1"}]}], "]"}], "]"}]}], ";"}], "   ", 
  RowBox[{"(*", "Error", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aData", " ", "=", 
    RowBox[{"data", "/", 
     RowBox[{"data", "[", 
      RowBox[{"[", "mid", "]"}], "]"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"normalised", " ", "data"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aErr", " ", "=", " ", 
    RowBox[{"err", "/", 
     RowBox[{"data", "[", 
      RowBox[{"[", "mid", "]"}], "]"}]}]}], ";"}], "    ", 
  RowBox[{"(*", 
   RowBox[{"normalised", " ", "error"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"aBar", " ", "=", " ", 
    RowBox[{"MapThread", "[", 
     RowBox[{"Around", ",", 
      RowBox[{"{", 
       RowBox[{"aData", ",", " ", "aErr"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"data", " ", "points", " ", "with", " ", "error", " ", "bars"}], 
    ",", " ", 
    RowBox[{"to", " ", "ease", " ", "plotting"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ToString", "[", 
    RowBox[{"time", "[", 
     RowBox[{"[", "mid", "]"}], "]"}], "]"}], "<>", "\"\< ms\>\""}], 
  RowBox[{"(*", 
   RowBox[{"print", " ", "the", " ", "triplet", " ", "time"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "we", " ", "define", " ", "here", " ", "a", " ", "function", " ", "to", 
    " ", "evaluate", " ", "the", " ", "diffusion", " ", "coefficent", " ", 
    "given", " ", "the", " ", "diffusion", " ", 
    RowBox[{"time", ".", " ", "Insert"}], " ", "your", " ", "instrument", " ",
     "calibration", " ", "parameters", " ", 
    RowBox[{"(", 
     RowBox[{
     "the", " ", "ratio", " ", "of", " ", "vertical", " ", "over", " ", 
      "horizontal", " ", "radius", " ", "\[Kappa]", " ", "and", " ", 
      "confocal", " ", "volume", " ", "V"}], ")"}], " ", "in", " ", 
    RowBox[{"d", "[", "t_", "]"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w0", "[", 
   RowBox[{"k_", ",", " ", "v_"}], "]"}], " ", "=", " ", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     FractionBox[
      RowBox[{"Quantity", "[", 
       RowBox[{"v", ",", " ", "\"\<Femtoliters\>\""}], "]"}], "k"], ")"}], 
    RowBox[{"1", "/", "3"}]], 
   SuperscriptBox["\[Pi]", 
    RowBox[{"-", "0.5"}]]}]}], "\n", 
 RowBox[{
  RowBox[{"d", "[", "t_", "]"}], "=", " ", 
  RowBox[{"UnitConvert", "[", 
   RowBox[{
    RowBox[{"(", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"w0", "[", 
        RowBox[{"6.67", ",", " ", "1.31"}], "]"}], "2"], 
      RowBox[{"4", " ", 
       RowBox[{"Quantity", "[", 
        RowBox[{"t", ",", " ", "\"\<Milliseconds\>\""}], "]"}]}]], ")"}], ",",
     " ", 
    RowBox[{
     SuperscriptBox["\"\<Micrometers\>\"", "2"], "/", "\"\<Seconds\>\""}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7106812669968996`*^9, 3.7106812682605076`*^9}, {
   3.7106815000137243`*^9, 3.7106815006689286`*^9}, {3.710827078312729*^9, 
   3.710827078421929*^9}, {3.7190443130990343`*^9, 3.7190443201814346`*^9}, {
   3.723280356658907*^9, 3.72328035738525*^9}, {3.753784476547172*^9, 
   3.7537844767536373`*^9}, 3.753784729226161*^9, 3.780807576095207*^9, 
   3.789471720401086*^9, {3.806115432805599*^9, 3.8061154486389236`*^9}, {
   3.806116466480892*^9, 3.8061164668485823`*^9}, {3.806117219602456*^9, 
   3.806117219787302*^9}, {3.806117251292624*^9, 3.806117288372096*^9}, {
   3.80612237370222*^9, 3.80612237823909*^9}, {3.80612249888457*^9, 
   3.806122500663495*^9}, {3.806122539994192*^9, 3.8061225407250633`*^9}, {
   3.80612258100408*^9, 3.806122581161929*^9}, {3.806122942274798*^9, 
   3.8061229454416018`*^9}, {3.806123006335135*^9, 3.806123025069931*^9}, {
   3.8061232243256598`*^9, 3.806123226758025*^9}, {3.806127134745768*^9, 
   3.8061271402363358`*^9}, {3.807540762248725*^9, 3.8075407624459887`*^9}, {
   3.809236267573292*^9, 3.8092362676967773`*^9}, {3.809238521586091*^9, 
   3.809238521991036*^9}, {3.809262516079751*^9, 3.809262517059827*^9}, {
   3.8093439887838907`*^9, 3.809343989992552*^9}, 3.810283023159034*^9, {
   3.810283073665564*^9, 3.810283074307054*^9}, {3.8102997163025503`*^9, 
   3.81029971666047*^9}, 3.810300220868948*^9, {3.810371482444275*^9, 
   3.810371500094352*^9}, {3.810373759765649*^9, 3.8103737831396217`*^9}, {
   3.810442232679448*^9, 3.810442241606453*^9}, {3.8104423043209047`*^9, 
   3.810442304973769*^9}, {3.810442735470119*^9, 3.810442982045323*^9}, {
   3.8104430144013567`*^9, 3.8104431004203463`*^9}, {3.813911421811945*^9, 
   3.813911502524502*^9}, {3.8139115631547832`*^9, 3.813911563543228*^9}, {
   3.813912034762412*^9, 3.813912050570559*^9}, {3.813919093146019*^9, 
   3.813919108553117*^9}, 3.813919164935403*^9, {3.821706469872841*^9, 
   3.821706500934835*^9}, {3.821879903664*^9, 3.8218800020105467`*^9}, {
   3.821880034945561*^9, 3.82188005317496*^9}, 3.8218801258134537`*^9, {
   3.821933326064633*^9, 3.821933398598977*^9}, 3.821933452369759*^9, {
   3.821933645100481*^9, 3.8219336465607347`*^9}, {3.825562703162468*^9, 
   3.825562704721416*^9}, {3.82556281754456*^9, 3.8255628733643637`*^9}, {
   3.825563001002194*^9, 3.82556301309939*^9}, {3.86377618036631*^9, 
   3.863776246232283*^9}, {3.863779827814103*^9, 3.8637798719110317`*^9}, {
   3.863780332787862*^9, 3.863780384261825*^9}, {3.863781150665778*^9, 
   3.863781160230886*^9}, {3.8637811927008142`*^9, 3.863781219885488*^9}, {
   3.883802876879775*^9, 3.8838029537056723`*^9}, {3.887866996411627*^9, 
   3.8878670078993053`*^9}, 3.887952543782645*^9, {3.888847296534957*^9, 
   3.88884730576147*^9}, {3.888851432602385*^9, 3.8888514561108923`*^9}, {
   3.888852155867321*^9, 3.888852189200171*^9}, {3.890659183311665*^9, 
   3.890659200672344*^9}, {3.890659230786075*^9, 3.890659251022438*^9}, {
   3.890659317408949*^9, 3.890659326606965*^9}, {3.902548312862644*^9, 
   3.9025483531787767`*^9}, {3.902548462905938*^9, 3.9025485558964653`*^9}, {
   3.9025493458340273`*^9, 3.902549491968341*^9}, {3.9025526168529*^9, 
   3.90255262161831*^9}, {3.902553321935734*^9, 3.902553433835619*^9}, {
   3.902562635007106*^9, 3.90256270147293*^9}, {3.902562786127203*^9, 
   3.9025627874553556`*^9}, {3.902652699905383*^9, 3.902652751091117*^9}, {
   3.9026535138842278`*^9, 3.902653520268729*^9}, {3.9026536060553913`*^9, 
   3.902653609952077*^9}, {3.902655126696213*^9, 3.902655150425775*^9}, {
   3.902655195486709*^9, 3.902655248527157*^9}, {3.902655288382369*^9, 
   3.902655313342152*^9}},ExpressionUUID->"837fdd6b-665f-4a70-a365-\
c9a110e8ea41"],

Cell[BoxData[
 RowBox[{"ListLogLinearPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"time", ",", "aBar"}], "}"}], "\[Transpose]"}], ",", " ", 
   RowBox[{"PlotStyle", "->", 
    RowBox[{"{", 
     RowBox[{"Gray", ",", 
      RowBox[{"PointSize", "[", "0.003", "]"}]}], "}"}]}], ",", " ", 
   RowBox[{"IntervalMarkers", "->", "\"\<Bands\>\""}], ",", " ", 
   RowBox[{"Joined", "->", "False"}], ",", 
   RowBox[{"Frame", "->", "True"}], ",", 
   RowBox[{"AspectRatio", "->", 
    RowBox[{"1", "/", "3"}]}], ",", 
   RowBox[{"ImageSize", "->", "Large"}], ",", 
   RowBox[{"FrameLabel", "->", 
    RowBox[{"{", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<ACF (normalised)\>\"", ",", " ", "None"}], "}"}], ",", 
      " ", 
      RowBox[{"{", 
       RowBox[{"\"\<Time (ms)\>\"", ",", "\"\<Display data\>\""}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"LabelStyle", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"16", ",", " ", 
      RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", " ", 
      "Black"}], "}"}]}], ",", " ", 
   RowBox[{"GridLines", "->", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"time", "[", 
        RowBox[{"[", "mid", "]"}], "]"}], "}"}], ",", " ", "None"}], 
     "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.902562771148508*^9, 3.902562853604298*^9}, {
  3.9026535240499372`*^9, 3.902653524863409*^9}, {3.9026554634369183`*^9, 
  3.902655465440934*^9}},
 CellLabel->
  "In[803]:=",ExpressionUUID->"6336137a-c6e3-4eb2-9240-216ec84177b0"],

Cell[CellGroupData[{

Cell["Fit", "Section",
 CellChangeTimes->{{3.807429099715198*^9, 
  3.807429110424027*^9}},ExpressionUUID->"9fc84298-2069-45ed-8f94-\
4d52f8cd2d97"],

Cell[CellGroupData[{

Cell["Triplets", "Subsection",
 CellChangeTimes->{{3.8848659335527363`*^9, 
  3.884865945135858*^9}},ExpressionUUID->"177ad1ca-52d0-46d0-a8ed-\
1e9e3480bdf2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fTripTwo", "[", 
   RowBox[{
   "a1_", ",", " ", "\[Theta]1_", ",", "a2_", ",", " ", "\[Theta]2_", ",", 
    " ", "t_"}], "]"}], ":=", 
  RowBox[{"(", 
   RowBox[{"1", " ", "+", " ", 
    RowBox[{"a1", 
     RowBox[{"(", " ", 
      RowBox[{"Exp", "[", 
       FractionBox[
        RowBox[{"-", "t"}], "\[Theta]1"], "]"}], ")"}]}], "+", " ", 
    RowBox[{"a2", 
     RowBox[{"(", " ", 
      RowBox[{"Exp", "[", 
       FractionBox[
        RowBox[{"-", "t"}], "\[Theta]2"], "]"}], ")"}]}]}], ")"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"triplet", " ", "model", " ", "with", " ", "two", " ", 
     RowBox[{"exponentials", ".", " ", "You"}], " ", "can", " ", "insert", 
     " ", "a", " ", "different", " ", "triplet", " ", "model", " ", 
     RowBox[{"here", ".", " ", "For"}], " ", "a", " ", "single", " ", 
     "triplet", " ", "model"}], ",", " ", 
    RowBox[{
    "you", " ", "can", " ", "simply", " ", "set", " ", "0", " ", "in", " ", 
     "the", " ", "amplitude", " ", "a2", " ", "below", " ", "in", " ", "the", 
     " ", "fitting", " ", "function"}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.887991704869364*^9, 3.8879917320690117`*^9}, {
  3.902551510695348*^9, 3.902551512215521*^9}, {3.902551542889908*^9, 
  3.902551589039919*^9}},
 CellLabel->
  "In[661]:=",ExpressionUUID->"945bc2ab-5859-4d77-a4cb-912845d21caa"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fitTriplet", " ", "=", 
     RowBox[{
      RowBox[{"NonlinearModelFit", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"time", "[", 
            RowBox[{"[", 
             RowBox[{"start", ";;", "mid"}], "]"}], "]"}], ",", " ", 
           RowBox[{"aData", "[", 
            RowBox[{"[", 
             RowBox[{"start", ";;", "mid"}], "]"}], "]"}]}], "}"}], 
         "\[Transpose]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"fTripTwo", "[", 
           RowBox[{
           "a1", ",", " ", "\[Theta]1", ",", "0", ",", " ", "1", ",", " ", 
            "t"}], "]"}], ",", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"3", ">", "a1", ">", "0"}], ",", " ", 
            RowBox[{"0.1", ">", "\[Theta]1", ">", "0"}]}], 
           RowBox[{"(*", 
            RowBox[{",", " ", 
             RowBox[{"3", ">", "a2", ">", "0"}], ",", " ", 
             RowBox[{"0.1", ">", "\[Theta]2", ">", "0"}]}], "*)"}], "}"}]}], 
         "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a1", ",", "0.5"}], "}"}], ",", 
          RowBox[{"{", " ", 
           RowBox[{"\[Theta]1", ",", "0.001"}], "}"}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"{", 
            RowBox[{"a2", ",", "0.5"}], "}"}], ",", 
           RowBox[{"{", " ", 
            RowBox[{"\[Theta]2", ",", "0.01"}], "}"}]}], "*)"}], "}"}], ",", 
        " ", "t", ",", " ", 
        RowBox[{"Method", "->", "\"\<InteriorPoint\>\""}], ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Weights", "->", 
           RowBox[{"1", "/", 
            SuperscriptBox[
             RowBox[{"errData", "[", 
              RowBox[{"[", 
               RowBox[{"start", ";;", "mid"}], "]"}], "]"}], "2"]}]}], ","}], 
         "*)"}], " ", 
        RowBox[{"MaxIterations", "->", "5000"}], ",", " ", 
        RowBox[{"AccuracyGoal", "->", "5"}], ",", 
        RowBox[{"PrecisionGoal", "->", "Infinity"}]}], "]"}], "//", 
      "Quiet"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"this", " ", "is", " ", "the", " ", "fitting", " ", 
     RowBox[{"function", ".", " ", "You"}], " ", "can", " ", "directly", " ", 
     "edit", " ", "here", " ", "the", " ", "boundaries", " ", "and", " ", 
     "starting", " ", 
     RowBox[{"values", ".", " ", "Please"}], " ", "note", " ", "that", " ", 
     "Mathematica", " ", "only", " ", "uses", " ", "\"\<interior point\>\"", 
     " ", "method", " ", "for", " ", "constrained", " ", "fit"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "here", " ", "we", " ", "plot", " ", "the", " ", "fit", " ", "of", " ", 
     "the", " ", "triplet"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"plotFitTrip", "=", 
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ListLogLinearPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"start", ";;", "mid"}], "]"}], "]"}], ",", 
             RowBox[{"aBar", "[", 
              RowBox[{"[", 
               RowBox[{"start", ";;", "mid"}], "]"}], "]"}]}], "}"}], 
           "\[Transpose]"}], ",", " ", 
          RowBox[{"PlotStyle", "->", 
           RowBox[{"{", 
            RowBox[{"Gray", ",", 
             RowBox[{"PointSize", "[", "0.013", "]"}]}], "}"}]}], ",", " ", 
          RowBox[{"IntervalMarkers", "->", "\"\<Fences\>\""}], ",", " ", 
          RowBox[{"Joined", "->", "False"}], ",", 
          RowBox[{"Frame", "->", "True"}], ",", 
          RowBox[{"AspectRatio", "->", 
           RowBox[{"1", "/", "3"}]}], ",", 
          RowBox[{"ImageSize", "->", "Large"}], ",", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", " ", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<ACF (normalised)\>\"", ",", " ", "None"}], "}"}], 
             ",", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<Time (ms)\>\"", ",", "\"\<Fit triplets\>\""}], 
              "}"}]}], "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"16", ",", " ", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", " ",
              "Black"}], "}"}]}]}], "]"}], "//", "Quiet"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"LogLinearPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"fitTriplet", "[", "t", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", " ", 
            RowBox[{"time", "[", 
             RowBox[{"[", "start", "]"}], "]"}], ",", " ", 
            RowBox[{"time", "[", 
             RowBox[{"[", "mid", "]"}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"PlotStyle", "->", 
           RowBox[{"{", 
            RowBox[{"Blue", ",", 
             RowBox[{"Thickness", "->", "0.005"}]}], "}"}]}], ",", " ", 
          RowBox[{"PlotPoints", "->", "3"}], ",", " ", 
          RowBox[{"MaxRecursion", "->", "3"}]}], "]"}], "//", "Quiet"}]}], 
      "\[IndentingNewLine]", "]"}], "//", "Quiet"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.809401350938382*^9, 3.809401419330657*^9}, {
   3.809402145953486*^9, 3.80940214785629*^9}, {3.809422552079093*^9, 
   3.8094225544068537`*^9}, 3.809422609687688*^9, 3.809424045286172*^9, {
   3.809424118044672*^9, 3.8094241207373047`*^9}, 3.809425039260988*^9, {
   3.809837823711467*^9, 3.809837832979415*^9}, 3.8102854708771544`*^9, {
   3.810299289031291*^9, 3.810299311502825*^9}, {3.8103798594577627`*^9, 
   3.810380001389316*^9}, {3.810380099417005*^9, 3.81038011968953*^9}, {
   3.8103801760949507`*^9, 3.810380195276792*^9}, {3.810380318386902*^9, 
   3.810380350513732*^9}, {3.8103818544431477`*^9, 3.810381855771723*^9}, {
   3.810440926172367*^9, 3.810440928167544*^9}, {3.810440971786581*^9, 
   3.810440972018849*^9}, {3.810441053872662*^9, 3.810441067536384*^9}, {
   3.810443705429123*^9, 3.810443736167049*^9}, {3.810445194572722*^9, 
   3.810445207162706*^9}, {3.810445274604986*^9, 3.810445312490048*^9}, {
   3.8104453540543327`*^9, 3.810445402045405*^9}, {3.810445448648044*^9, 
   3.8104454512440977`*^9}, {3.81045847998167*^9, 3.81045848266364*^9}, {
   3.813912822218479*^9, 3.8139128277461367`*^9}, {3.813919222389576*^9, 
   3.813919227653129*^9}, {3.823432832973033*^9, 3.823432854478011*^9}, {
   3.8639411059662*^9, 3.863941106346468*^9}, {3.8802783274284697`*^9, 
   3.8802783275846577`*^9}, {3.882779368325323*^9, 3.882779376618746*^9}, {
   3.8827800187771187`*^9, 3.8827801292468243`*^9}, {3.882780172207912*^9, 
   3.88278017703767*^9}, {3.882781320499795*^9, 3.882781376791699*^9}, {
   3.882781462346592*^9, 3.8827814932640123`*^9}, {3.8827827556679773`*^9, 
   3.882782842076869*^9}, {3.8827828795458717`*^9, 3.882782882290215*^9}, {
   3.882782913842614*^9, 3.882782928474948*^9}, {3.88278371303089*^9, 
   3.882783850382049*^9}, {3.882783931214279*^9, 3.882784038108869*^9}, {
   3.882784146220623*^9, 3.882784195436449*^9}, {3.8827842483661423`*^9, 
   3.882784354169818*^9}, {3.882784392607184*^9, 3.882784393255797*^9}, {
   3.8827844293576813`*^9, 3.8827844310191593`*^9}, {3.882784483617632*^9, 
   3.882784509477949*^9}, {3.882784684998407*^9, 3.882784690227901*^9}, 
   3.882788812784094*^9, {3.882790299217395*^9, 3.8827903057966213`*^9}, {
   3.882790368857401*^9, 3.8827904280499077`*^9}, {3.882790479245965*^9, 
   3.882790489402918*^9}, {3.882791421558419*^9, 3.882791445057797*^9}, {
   3.882860537844679*^9, 3.882860604888077*^9}, {3.882860671399124*^9, 
   3.8828606776081047`*^9}, {3.882860711555065*^9, 3.882860755058964*^9}, 
   3.882860804610448*^9, {3.882865739154703*^9, 3.882865741961144*^9}, {
   3.8828658310464573`*^9, 3.882865904391755*^9}, {3.882866118691351*^9, 
   3.882866129170554*^9}, {3.882868013616981*^9, 3.882868015647477*^9}, {
   3.882868233059825*^9, 3.8828682419263973`*^9}, 3.8828683099714203`*^9, {
   3.882868370697606*^9, 3.882868384621365*^9}, {3.882868903509261*^9, 
   3.882868911611176*^9}, {3.882869613416795*^9, 3.882869630347014*^9}, {
   3.882869711885232*^9, 3.88286972753791*^9}, {3.88286989350849*^9, 
   3.882869904647114*^9}, {3.882870068408909*^9, 3.882870081473716*^9}, 
   3.882870292537249*^9, {3.882870322815153*^9, 3.882870374173258*^9}, {
   3.882870504373706*^9, 3.8828705049602623`*^9}, {3.882870659226981*^9, 
   3.882870662768062*^9}, {3.8828707323210497`*^9, 3.882870738458185*^9}, {
   3.882870827982217*^9, 3.882870829882072*^9}, {3.882870864047176*^9, 
   3.882870864672657*^9}, {3.8829371559081984`*^9, 3.882937156233694*^9}, {
   3.882937367304286*^9, 3.882937373347563*^9}, {3.883116531684527*^9, 
   3.883116532018173*^9}, {3.8833765675789137`*^9, 3.883376575479084*^9}, {
   3.883377370071219*^9, 3.883377382768634*^9}, {3.8833775391450043`*^9, 
   3.88337757478726*^9}, {3.8833780264936533`*^9, 3.883378042505293*^9}, {
   3.883378179802133*^9, 3.883378217276458*^9}, {3.8836690991378803`*^9, 
   3.883669127713282*^9}, 3.883669225630704*^9, {3.884867181975767*^9, 
   3.884867399620304*^9}, {3.884867446860026*^9, 3.88486746522858*^9}, {
   3.8848675049303217`*^9, 3.884867532991682*^9}, 3.885122552818562*^9, {
   3.885206489495185*^9, 3.885206494318946*^9}, {3.886829799107184*^9, 
   3.8868298054188337`*^9}, {3.8873728945468616`*^9, 3.887372913920308*^9}, {
   3.887373147651882*^9, 3.8873731605373383`*^9}, {3.887373320691791*^9, 
   3.887373323368018*^9}, {3.887374428641489*^9, 3.887374507405943*^9}, {
   3.887374554370686*^9, 3.887374554472845*^9}, {3.8873745978212967`*^9, 
   3.887374604257263*^9}, {3.887374785009407*^9, 3.887374799538206*^9}, {
   3.887374883756971*^9, 3.887374890592793*^9}, {3.887378976058423*^9, 
   3.887378987708273*^9}, {3.8873793146409473`*^9, 3.887379349165785*^9}, {
   3.887385244618969*^9, 3.887385251678138*^9}, {3.887436867295998*^9, 
   3.8874368727650948`*^9}, 3.887436954783351*^9, 3.887547760491548*^9, {
   3.8875483256013317`*^9, 3.8875483360083103`*^9}, {3.88754838880503*^9, 
   3.887548391813833*^9}, 3.887888130726149*^9, {3.8878889374002857`*^9, 
   3.887889070023355*^9}, 3.8878896732151127`*^9, {3.887991744365635*^9, 
   3.8879917595630417`*^9}, {3.902551597362259*^9, 3.902551612045148*^9}, {
   3.9025521622606297`*^9, 3.902552162722272*^9}, {3.902552305098918*^9, 
   3.9025524665981913`*^9}, {3.90255321390203*^9, 3.902553220127586*^9}, {
   3.902553469110119*^9, 3.90255347208706*^9}, {3.9025557601497*^9, 
   3.902555760498207*^9}, 3.902562715390424*^9, {3.902563223249454*^9, 
   3.9025632238709383`*^9}, {3.902563255670638*^9, 3.9025633207864733`*^9}, {
   3.9025634801154737`*^9, 3.9025634813943644`*^9}, {3.902653432252089*^9, 
   3.902653436195817*^9}, {3.9026534711809607`*^9, 3.90265350037122*^9}, 
   3.9026554940451727`*^9, {3.902655724169464*^9, 3.902655791376855*^9}, 
   3.902656588708992*^9},ExpressionUUID->"03f05cf0-4156-4fb6-8b5e-\
3420f044f9bd"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</export/\>\"", "<>",
        "launch", "<>", "\"\</temp/\>\"", "<>", "\"\<_triplet.png\>\""}], ",",
       "plotFitTrip", ",", 
      RowBox[{"ImageResolution", "->", "500"}], ",", " ", 
      RowBox[{"OverwriteTarget", "->", "\"\<KeepBoth\>\""}]}], "]"}], ";"}], 
   " ", 
   RowBox[{"(*", 
    RowBox[{"export", " ", "plot"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</export/\>\"", "<>",
        "launch", "<>", "\"\</fitTriplet.mx\>\""}], ",", " ", "fitTriplet", 
      ",", " ", 
      RowBox[{"OverwriteTarget", "->", "True"}]}], "]"}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"export", " ", "fit", " ", "Mathematica", " ", "object"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.882871517949423*^9, 3.8828715217749987`*^9}, {
   3.882871568947966*^9, 3.882871571297304*^9}, {3.882871911009297*^9, 
   3.8828719140208673`*^9}, 3.882876799764203*^9, {3.8828769988192987`*^9, 
   3.88287700592369*^9}, 3.882951275118998*^9, 3.8848674066782618`*^9, {
   3.884939865842244*^9, 3.884939885742033*^9}, {3.887107182481078*^9, 
   3.887107184514921*^9}, {3.887374955054196*^9, 3.887374955406609*^9}, {
   3.887376993437913*^9, 3.887376999484131*^9}, {3.8873770875990877`*^9, 
   3.887377106300589*^9}, {3.887377144110362*^9, 3.887377166396995*^9}, {
   3.8873773777423897`*^9, 3.887377382076509*^9}, {3.8873789638180437`*^9, 
   3.887378969111843*^9}, {3.887379378138877*^9, 3.887379382335267*^9}, {
   3.887889703831195*^9, 3.8878897237868967`*^9}, {3.902553478113606*^9, 
   3.902553539040504*^9}},
 CellLabel->
  "In[664]:=",ExpressionUUID->"1f63ee48-e781-4802-ba99-a9d38602f239"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[OpenCurlyQuote]Well-defined\[CloseCurlyQuote] D model", "Subsection",
 CellChangeTimes->{{3.890627993567073*^9, 3.890628009089315*^9}, {
   3.902637478323098*^9, 3.902637500969583*^9}, 
   3.902637553787003*^9},ExpressionUUID->"2976eb84-80eb-41a0-ab17-\
3b4da478e36e"],

Cell["\<\
This is the ' traditional' FCS fit . We directly search for the diffusion \
time and the amplitude. We have two species diffusing in bulk solution. \
\>", "Text",
 CellChangeTimes->{{3.902655803984305*^9, 
  3.902655868487574*^9}},ExpressionUUID->"ab53e59f-adb5-444c-88ec-\
c24086fe2d30"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"g2Diff", "[", 
    RowBox[{"\[Rho]_", ",", " ", "\[Tau]_", ",", " ", "g_", ",", " ", "t_"}], 
    "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"(", 
     FractionBox["\[Rho]", 
      RowBox[{"1", "+", 
       RowBox[{"(", 
        FractionBox["t", 
         RowBox[{"Abs", "@", "\[Tau]"}]], ")"}]}]], ")"}], "+", "g"}]}], " ", 
  
  RowBox[{"(*", 
   RowBox[{"two", " ", "dimensional", " ", "function"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g3Diff2", "[", 
   RowBox[{
   "\[Rho]1_", ",", " ", "\[Tau]1_", ",", " ", "\[Rho]2_", ",", " ", 
    "\[Tau]2_", ",", "\[Kappa]_", ",", " ", "g_", ",", " ", "t_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     FractionBox[
      RowBox[{"Abs", "@", "\[Rho]1"}], 
      RowBox[{"1", "+", 
       RowBox[{"(", 
        FractionBox["t", 
         RowBox[{"Abs", "@", "\[Tau]1"}]], ")"}]}]], ")"}], 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", 
       RowBox[{"1", "+", 
        RowBox[{"(", 
         FractionBox["t", 
          RowBox[{
           RowBox[{"Abs", "@", "\[Tau]1"}], " ", 
           SuperscriptBox["\[Kappa]", "2"]}]], ")"}]}]], ")"}], "0.5"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     FractionBox[
      RowBox[{"Abs", "@", "\[Rho]2"}], 
      RowBox[{"1", "+", 
       RowBox[{"(", 
        FractionBox["t", 
         RowBox[{"Abs", "@", "\[Tau]2"}]], ")"}]}]], ")"}], 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", 
       RowBox[{"1", "+", 
        RowBox[{"(", 
         FractionBox["t", 
          RowBox[{
           RowBox[{"Abs", "@", "\[Tau]2"}], " ", 
           SuperscriptBox["\[Kappa]", "2"]}]], ")"}]}]], ")"}], "0.5"]}], "+",
    "g", " ", 
   RowBox[{"(*", 
    RowBox[{"three", " ", "dimensional", " ", 
     RowBox[{"function", " ", "/", " ", "two"}], " ", "species"}], 
    "*)"}]}]}]}], "Input",
 CellChangeTimes->{{3.887876018675934*^9, 3.887876028425745*^9}, {
   3.8878761071807423`*^9, 3.8878761512413483`*^9}, {3.887903166022085*^9, 
   3.887903209807963*^9}, {3.8879032897564993`*^9, 3.887903335500613*^9}, {
   3.887993137875909*^9, 3.887993142085026*^9}, {3.902553963141309*^9, 
   3.90255399907806*^9}, 3.9025557783085747`*^9, 3.902563358791644*^9},
 CellLabel->
  "In[745]:=",ExpressionUUID->"a8f9ca12-58b0-451e-bed4-d6ce46f9f65e"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8878897986391697`*^9, 3.887889883953117*^9}, {
   3.887890578599592*^9, 3.887890614711555*^9}, {3.887903714978957*^9, 
   3.887903758708346*^9}, 3.887952413292696*^9, {3.887974945478304*^9, 
   3.8879749467096863`*^9}, 3.8889357493811007`*^9, {3.888935896817053*^9, 
   3.888935911128374*^9}, 3.888988848804678*^9, {3.89065934506768*^9, 
   3.890659348699781*^9}, {3.8906595629893084`*^9, 3.890659570585676*^9}, {
   3.902554007020734*^9, 3.902554007783934*^9}},
 CellLabel->
  "In[747]:=",ExpressionUUID->"0551396e-e01a-4918-8c14-24bc779064dd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "fitDiff", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "to", " ", "go", " ", "from", " ", "one", " ", "to", " ", "two", " ", 
     "dimension", " ", "quickly", " ", "you", " ", "can", " ", "simply", " ", 
     "set", " ", "\[Rho]2"}], " ", "=", " ", 
    RowBox[{"0", " ", "below"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fitDiff", " ", "=", 
    RowBox[{
     RowBox[{"NonlinearModelFit", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"time", "[", 
           RowBox[{"[", 
            RowBox[{"start", ";;"}], "]"}], "]"}], ",", " ", 
          RowBox[{"aData", "[", 
           RowBox[{"[", 
            RowBox[{"start", ";;"}], "]"}], "]"}]}], "}"}], "\[Transpose]"}], 
       ",", 
       RowBox[{
        RowBox[{"fitTriplet", "[", "\"\<BestFit\>\"", "]"}], " ", 
        RowBox[{"g3Diff2", "[", 
         RowBox[{
         "\[Rho]1", ",", " ", "\[Tau]1", ",", "\[Rho]2", ",", " ", "\[Tau]2", 
          ",", "6.69", ",", "0", ",", " ", "t"}], "]"}]}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Rho]1", ",", "0.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Tau]1", ",", " ", "0.5"}], "}"}], " ", ",", 
         RowBox[{"{", 
          RowBox[{"\[Rho]2", ",", "0.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Tau]2", ",", " ", "1.5"}], "}"}]}], " ", "}"}], ",", "t",
        ",", " ", 
       RowBox[{"Method", "->", "\"\<LevenbergMarquardt\>\""}], ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Weights", "->", 
          RowBox[{"1", "/", 
           SuperscriptBox["errData", "2"]}]}], ","}], "*)"}], " ", 
       RowBox[{"MaxIterations", "->", "5000"}], ",", " ", 
       RowBox[{"AccuracyGoal", "->", "5"}], ",", 
       RowBox[{"PrecisionGoal", "->", "Infinity"}]}], "]"}], "//", 
     "Quiet"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "you", " ", "can", " ", "uncomment", " ", "the", " ", "weights", " ", "to",
     " ", "have", " ", "weighted", " ", "fit"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "this", " ", "is", " ", "to", " ", "extract", " ", "the", " ", "numerical",
     " ", "value", " ", "of", " ", "the", " ", 
    RowBox[{"fit", ".", " ", "comment"}], " ", "if", " ", "not", " ", 
    "needed"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Abs", "@", "\[Tau]1"}], "/.", 
    RowBox[{"(", 
     RowBox[{"fitDiff", "[", "\"\<BestFitParameters\>\"", "]"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", " ", "=", 
   RowBox[{
    RowBox[{"Abs", "@", "\[Rho]1"}], "/.", 
    RowBox[{"(", 
     RowBox[{"fitDiff", "[", "\"\<BestFitParameters\>\"", "]"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t2", " ", "=", " ", 
   RowBox[{
    RowBox[{"Abs", "@", "\[Tau]2"}], "/.", 
    RowBox[{"(", 
     RowBox[{"fitDiff", "[", "\"\<BestFitParameters\>\"", "]"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"r2", " ", "=", 
    RowBox[{
     RowBox[{"Abs", "@", "\[Rho]2"}], "/.", 
     RowBox[{"(", 
      RowBox[{"fitDiff", "[", "\"\<BestFitParameters\>\"", "]"}], ")"}]}]}], 
   ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"plotFitDiff", "=", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ListLogLinearPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"time", ",", "aBar"}], "}"}], "\[Transpose]"}], ",", " ", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"Gray", ",", 
           RowBox[{"PointSize", "[", "0.013", "]"}]}], "}"}]}], ",", " ", 
        RowBox[{"IntervalMarkers", "->", "\"\<Bands\>\""}], ",", " ", 
        RowBox[{"Joined", "->", "False"}], ",", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"AspectRatio", "->", 
         RowBox[{"1", "/", "3"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", 
        RowBox[{"FrameLabel", "->", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<ACF (normalised)\>\"", ",", " ", "None"}], "}"}], 
           ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Time (ms)\>\"", ",", "\"\<'Well-defined' D model\>\""}], 
            "}"}]}], "}"}]}], ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"12", ",", " ", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", " ", 
           "Black"}], "}"}]}]}], "]"}], "//", "Quiet"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LogLinearPlot", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"fitDiff", "[", "t", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", " ", 
          RowBox[{"time", "[", 
           RowBox[{"[", "start", "]"}], "]"}], ",", " ", 
          RowBox[{"time", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", " ", 
        RowBox[{"PlotStyle", "->", 
         RowBox[{"{", 
          RowBox[{"Blue", ",", 
           RowBox[{"Thickness", "->", "0.005"}]}], "}"}]}], ",", " ", 
        RowBox[{"PlotPoints", "->", "3"}], ",", " ", 
        RowBox[{"MaxRecursion", "->", "3"}]}], "]"}], "//", "Quiet"}]}], 
    "\[IndentingNewLine]", "]"}], "//", 
   "Quiet"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.809401350938382*^9, 3.809401419330657*^9}, {
   3.809402145953486*^9, 3.80940214785629*^9}, {3.809422552079093*^9, 
   3.8094225544068537`*^9}, 3.809422609687688*^9, 3.809424045286172*^9, {
   3.809424118044672*^9, 3.8094241207373047`*^9}, 3.809425039260988*^9, {
   3.809837823711467*^9, 3.809837832979415*^9}, 3.8102854708771544`*^9, {
   3.810299289031291*^9, 3.810299311502825*^9}, {3.8103798594577627`*^9, 
   3.810380001389316*^9}, {3.810380099417005*^9, 3.81038011968953*^9}, {
   3.8103801760949507`*^9, 3.810380195276792*^9}, {3.810380318386902*^9, 
   3.810380350513732*^9}, {3.8103818544431477`*^9, 3.810381855771723*^9}, {
   3.810440926172367*^9, 3.810440928167544*^9}, {3.810440971786581*^9, 
   3.810440972018849*^9}, {3.810441053872662*^9, 3.810441067536384*^9}, {
   3.810443705429123*^9, 3.810443736167049*^9}, {3.810445194572722*^9, 
   3.810445207162706*^9}, {3.810445274604986*^9, 3.810445312490048*^9}, {
   3.8104453540543327`*^9, 3.810445402045405*^9}, {3.810445448648044*^9, 
   3.8104454512440977`*^9}, {3.81045847998167*^9, 3.81045848266364*^9}, {
   3.813912822218479*^9, 3.8139128277461367`*^9}, {3.813919222389576*^9, 
   3.813919227653129*^9}, {3.823432832973033*^9, 3.823432854478011*^9}, {
   3.8639411059662*^9, 3.863941106346468*^9}, {3.8802783274284697`*^9, 
   3.8802783275846577`*^9}, {3.882779368325323*^9, 3.882779376618746*^9}, {
   3.8827800187771187`*^9, 3.8827801292468243`*^9}, {3.882780172207912*^9, 
   3.88278017703767*^9}, {3.882781320499795*^9, 3.882781376791699*^9}, {
   3.882781462346592*^9, 3.8827814932640123`*^9}, {3.8827827556679773`*^9, 
   3.882782842076869*^9}, {3.8827828795458717`*^9, 3.882782882290215*^9}, {
   3.882782913842614*^9, 3.882782928474948*^9}, {3.88278371303089*^9, 
   3.882783850382049*^9}, {3.882783931214279*^9, 3.882784038108869*^9}, {
   3.882784146220623*^9, 3.882784195436449*^9}, {3.8827842483661423`*^9, 
   3.882784354169818*^9}, {3.882784392607184*^9, 3.882784393255797*^9}, {
   3.8827844293576813`*^9, 3.8827844310191593`*^9}, {3.882784483617632*^9, 
   3.882784509477949*^9}, {3.882784684998407*^9, 3.882784690227901*^9}, 
   3.882788812784094*^9, {3.882790299217395*^9, 3.8827903057966213`*^9}, {
   3.882790368857401*^9, 3.8827904280499077`*^9}, {3.882790479245965*^9, 
   3.882790489402918*^9}, {3.882791421558419*^9, 3.882791445057797*^9}, {
   3.882860537844679*^9, 3.882860604888077*^9}, {3.882860671399124*^9, 
   3.8828606776081047`*^9}, {3.882860711555065*^9, 3.882860755058964*^9}, 
   3.882860804610448*^9, {3.882865739154703*^9, 3.882865741961144*^9}, {
   3.8828658310464573`*^9, 3.882865904391755*^9}, {3.882866118691351*^9, 
   3.882866129170554*^9}, {3.882868013616981*^9, 3.882868015647477*^9}, {
   3.882868233059825*^9, 3.8828682419263973`*^9}, 3.8828683099714203`*^9, {
   3.882868370697606*^9, 3.882868384621365*^9}, {3.882868903509261*^9, 
   3.882868911611176*^9}, {3.882869613416795*^9, 3.882869630347014*^9}, {
   3.882869711885232*^9, 3.88286972753791*^9}, {3.88286989350849*^9, 
   3.882869904647114*^9}, {3.882870068408909*^9, 3.882870081473716*^9}, 
   3.882870292537249*^9, {3.882870322815153*^9, 3.882870374173258*^9}, {
   3.882870504373706*^9, 3.8828705049602623`*^9}, {3.882870659226981*^9, 
   3.882870662768062*^9}, {3.8828707323210497`*^9, 3.882870738458185*^9}, {
   3.882870827982217*^9, 3.882870829882072*^9}, {3.882870864047176*^9, 
   3.882870864672657*^9}, {3.8829371559081984`*^9, 3.882937156233694*^9}, {
   3.882937367304286*^9, 3.882937373347563*^9}, {3.883116531684527*^9, 
   3.883116532018173*^9}, {3.8833765675789137`*^9, 3.883376575479084*^9}, {
   3.883377370071219*^9, 3.883377382768634*^9}, {3.8833775391450043`*^9, 
   3.88337757478726*^9}, {3.8833780264936533`*^9, 3.883378042505293*^9}, {
   3.883378179802133*^9, 3.883378217276458*^9}, {3.8836690991378803`*^9, 
   3.883669127713282*^9}, 3.883669225630704*^9, {3.8848676416224327`*^9, 
   3.8848676467719393`*^9}, {3.88486771010054*^9, 3.8848677122625103`*^9}, {
   3.884867770616171*^9, 3.884867791154107*^9}, {3.884942437770544*^9, 
   3.884942446354741*^9}, {3.884942787586062*^9, 3.884942794021247*^9}, {
   3.885122612802191*^9, 3.8851226380117693`*^9}, {3.885122726933608*^9, 
   3.88512276576125*^9}, {3.885302136578298*^9, 3.885302153639677*^9}, {
   3.8853025263941917`*^9, 3.88530253014822*^9}, 3.8853026132704477`*^9, {
   3.8868298924319277`*^9, 3.88682989692332*^9}, {3.8873769355843782`*^9, 
   3.887376965416525*^9}, {3.887377559807127*^9, 3.887377614413239*^9}, {
   3.887378187215187*^9, 3.887378242818605*^9}, {3.8873783196474752`*^9, 
   3.887378335185484*^9}, {3.887385269185527*^9, 3.88738530269903*^9}, {
   3.88743665870614*^9, 3.8874366640686913`*^9}, {3.887436840297221*^9, 
   3.8874368554303513`*^9}, 3.887436972162971*^9, {3.8874404497907753`*^9, 
   3.887440460978362*^9}, {3.887443266024212*^9, 3.887443266985756*^9}, 
   3.887547766177884*^9, {3.887548343866084*^9, 3.887548353265828*^9}, {
   3.88754839751116*^9, 3.8875483999261208`*^9}, {3.88789062477735*^9, 
   3.8878907008253183`*^9}, {3.887890751049436*^9, 3.887890802558219*^9}, {
   3.887890838463318*^9, 3.887890910532084*^9}, {3.8879030916788597`*^9, 
   3.88790309178225*^9}, {3.887903137416812*^9, 3.887903149992319*^9}, {
   3.8879036767365026`*^9, 3.887903678273831*^9}, {3.887903792290016*^9, 
   3.887903954712407*^9}, {3.8879039952237473`*^9, 3.887904082941115*^9}, 
   3.8879524440226994`*^9, {3.887975087258532*^9, 3.887975096051272*^9}, {
   3.887992126381604*^9, 3.887992231354721*^9}, {3.887992264570416*^9, 
   3.887992301155899*^9}, {3.887992424425823*^9, 3.887992444842499*^9}, {
   3.887992561898176*^9, 3.8879925663463287`*^9}, {3.887992989801662*^9, 
   3.887993029075617*^9}, 3.888041127623508*^9, {3.8880412364201107`*^9, 
   3.888041268697012*^9}, {3.888041299413444*^9, 3.888041307494108*^9}, 
   3.888924254953697*^9, {3.888924496879562*^9, 3.8889245548858213`*^9}, 
   3.888935881679729*^9, {3.888988859783869*^9, 3.888988862416183*^9}, {
   3.888990482117219*^9, 3.888990506515669*^9}, 3.890659358946432*^9, 
   3.890659474891884*^9, {3.9025540112621813`*^9, 3.902554031752604*^9}, {
   3.902554107154264*^9, 3.9025541401878853`*^9}, {3.9025551049666977`*^9, 
   3.902555220706325*^9}, {3.9025552558971033`*^9, 3.902555460829995*^9}, {
   3.902555791939349*^9, 3.9025557981728077`*^9}, 3.902556013008943*^9, {
   3.902556094191368*^9, 3.902556130419705*^9}, {3.9025561709667273`*^9, 
   3.902556180289212*^9}, {3.90255624935216*^9, 3.902556252427803*^9}, {
   3.902556291060727*^9, 3.902556330044322*^9}, {3.9025624876367702`*^9, 
   3.902562504048662*^9}, {3.902562615919345*^9, 3.90256261898065*^9}, {
   3.90256273117626*^9, 3.902562732227495*^9}, 3.902563241324182*^9, {
   3.902563362544938*^9, 3.9025634004039297`*^9}, {3.902563431454514*^9, 
   3.9025634716696787`*^9}, {3.9026375114628143`*^9, 3.902637542693906*^9}, {
   3.902637809718341*^9, 3.902637888074593*^9}, {3.9026410302465363`*^9, 
   3.902641039608717*^9}, 3.902656590482203*^9, {3.9026577254261103`*^9, 
   3.9026577259453163`*^9}},ExpressionUUID->"e2260233-31fb-4cbd-a9e0-\
7c752c1e1193"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</export/\>\"", "<>",
        "launch", "<>", "\"\<_diff.jpg\>\""}], ",", "plotFitDiff", ",", 
      RowBox[{"ImageResolution", "->", "500"}], ",", " ", 
      RowBox[{"OverwriteTarget", "->", "\"\<KeepBoth\>\""}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</export/\>\"", "<>",
        "launch", "<>", "\"\</fitDiff.mx\>\""}], ",", " ", "fitDiff", ",", 
      " ", 
      RowBox[{"OverwriteTarget", "->", "True"}]}], "]"}], ";"}]}]}]], "Input",\

 CellChangeTimes->{{3.882871517949423*^9, 3.8828715217749987`*^9}, {
   3.882871568947966*^9, 3.882871571297304*^9}, {3.882871911009297*^9, 
   3.8828719140208673`*^9}, 3.882876799764203*^9, {3.8828769988192987`*^9, 
   3.88287700592369*^9}, 3.882951275118998*^9, 3.8849428082312937`*^9, 
   3.8871072085836983`*^9, {3.887378563056649*^9, 3.887378576090301*^9}, 
   3.887378700081109*^9, {3.887385319675722*^9, 3.887385319799881*^9}, {
   3.887437165275045*^9, 3.8874371673518133`*^9}, {3.88744327997902*^9, 
   3.887443280151411*^9}, 3.887904094520135*^9, {3.8879041448791513`*^9, 
   3.887904178026249*^9}, {3.902555403206781*^9, 3.902555403485299*^9}, {
   3.902653547962109*^9, 3.902653556453095*^9}},
 CellLabel->
  "In[757]:=",ExpressionUUID->"6841312a-675d-4dc8-b742-3ebc715df063"]
}, Open  ]],

Cell[CellGroupData[{

Cell["LogNormal Monomodal 3D", "Subsection",
 CellChangeTimes->{{3.882269399222597*^9, 3.882269405988082*^9}, {
  3.882351934468061*^9, 3.882351944611165*^9}, {3.8823829778605747`*^9, 
  3.882382986525423*^9}, {3.882608646519363*^9, 3.882608668005756*^9}, {
  3.88790502240449*^9, 3.887905023088559*^9}, {3.887905054761629*^9, 
  3.887905054996649*^9}},ExpressionUUID->"1a6a0035-b322-4d32-803c-\
111dd1e913c2"],

Cell[CellGroupData[{

Cell["definitions", "Subsubsection",
 CellChangeTimes->{{3.902656440786751*^9, 
  3.9026564538921843`*^9}},ExpressionUUID->"50ab4e87-9e3b-4cbb-ac24-\
82b6e29f0b12"],

Cell["\<\
We define all the functions necessary to fit the data with a lognormal \
distribution of diffusion time\
\>", "Text",
 CellChangeTimes->{{3.902656464231159*^9, 
  3.902656507303162*^9}},ExpressionUUID->"21a7886a-f7e8-49a4-854b-\
751d9400548d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"\[Rho]_", ",", " ", "\[Tau]_", ",", " ", "t_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     FractionBox["\[Rho]", 
      RowBox[{"1", "+", 
       RowBox[{"(", 
        FractionBox["t", 
         RowBox[{"Abs", "@", "\[Tau]"}]], ")"}]}]], ")"}], 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", 
       RowBox[{"1", "+", 
        RowBox[{"(", 
         FractionBox["t", 
          RowBox[{
           RowBox[{"Abs", "@", "\[Tau]"}], " ", 
           SuperscriptBox["6.69", "2"]}]], ")"}]}]], ")"}], "0.5"]}]}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"this", " ", "is", " ", "3", "D", " ", "G", 
     RowBox[{"(", "t", ")"}], " ", "for", " ", "one", " ", 
     RowBox[{"species", ".", " ", "To"}], " ", "simplify", " ", "matters"}], 
    ",", " ", 
    RowBox[{
    "the", " ", "value", " ", "of", " ", "k", " ", "is", " ", "directly", " ", 
     RowBox[{"inserted", "."}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gLog", " ", "[", 
    RowBox[{"\[Mu]_", ",", " ", "\[Sigma]_", ",", " ", "x_"}], "]"}], ":=", 
   " ", 
   RowBox[{
    FractionBox["1", 
     RowBox[{
      RowBox[{"Abs", "[", "\[Sigma]", "]"}], " ", "x", " ", 
      SqrtBox[
       RowBox[{"2", " ", "\[Pi]", " "}]]}]], 
    SuperscriptBox["E", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{
          RowBox[{"Log", "[", "x", "]"}], "-", " ", "\[Mu]"}], "\[Sigma]"], 
        ")"}], "2"]}]]}]}], 
  RowBox[{"(*", 
   RowBox[{"Lognormal", " ", "distribution"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gridLog", " ", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      SuperscriptBox["10", "i"], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"-", "3"}], ",", " ", "3", ",", " ", ".005"}], "}"}]}], 
     "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "log", " ", "base", " ", "for", " ", "discretizing", " ", "the", " ", 
    "integral"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"baseLogT", " ", "=", " ", 
    RowBox[{"MovingAverage", "[", 
     RowBox[{"gridLog", ",", " ", "2"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"adjustement", " ", "of", "  ", "log", " ", "base"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dBaseLog", "=", 
    RowBox[{"Association", "[", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"baseLogT", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "->", 
        RowBox[{
         RowBox[{"Differences", "[", " ", "gridLog", "]"}], "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], " ", ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"Length", "@", "baseLogT"}]}], "}"}]}], "]"}], "]"}]}], 
   ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "this", " ", "is", " ", "needed", " ", "to", " ", "evaluate", " ", "the", 
    " ", 
    RowBox[{"integral", ".", " ", "It"}], " ", "calculated", " ", "the", " ", 
    "finite", " ", "differences", " ", "between", " ", "consecutive", " ", 
    "elements", " ", "of", " ", "the", " ", "base"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sumLog", "[", 
    RowBox[{"\[Mu]_", ",", " ", "\[Sigma]_", ",", "t_"}], "]"}], " ", ":=", 
   " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", " ", "\[Tau]", ",", " ", "t"}], "]"}], " ", 
      RowBox[{"gLog", "[", 
       RowBox[{"\[Mu]", ",", "  ", "\[Sigma]", ",", " ", "\[Tau]"}], "]"}], 
      RowBox[{"dBaseLog", " ", "[", "\[Tau]", "]"}]}], " ", ",", 
     RowBox[{"{", " ", 
      RowBox[{"\[Tau]", ",", " ", "baseLogT"}], "}"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "integral", " ", "for", " ", "one", " ", "lognormal", " ", "distribution", 
    " ", 
    RowBox[{"(", 
     RowBox[{"monomodal", " ", "model"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sumTwoLog", " ", "[", 
    RowBox[{
    "\[Mu]1_", ",", " ", "\[Sigma]1_", ",", "\[Mu]2_", ",", " ", "\[Sigma]2_",
      ",", "\[Rho]_", ",", "t_"}], "]"}], ":=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"1", ",", " ", "\[Tau]", ",", " ", "t"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Rho]", "2"], 
         RowBox[{"gLog", "[", 
          RowBox[{"\[Mu]1", ",", "  ", "\[Sigma]1", ",", " ", "\[Tau]"}], 
          "]"}]}], "+", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["\[Rho]", "2"]}], ")"}], "]"}], 
         RowBox[{"gLog", "[", 
          RowBox[{"\[Mu]2", ",", "  ", "\[Sigma]2", ",", " ", "\[Tau]"}], 
          "]"}]}]}], ")"}], 
      RowBox[{"dBaseLog", " ", "[", "\[Tau]", "]"}]}], " ", ",", 
     RowBox[{"{", " ", 
      RowBox[{"\[Tau]", ",", " ", "baseLogT"}], "}"}]}], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
   "integral", " ", "for", " ", "two", " ", "lognormal", " ", "distribution", 
    " ", 
    RowBox[{"(", 
     RowBox[{"bimodal", " ", "model"}], ")"}]}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.878706785893057*^9, 3.878706832245388*^9}, {
   3.8787068804539337`*^9, 3.878706992023139*^9}, {3.878707047862609*^9, 
   3.878707048123102*^9}, {3.8787206616449337`*^9, 3.878720702236333*^9}, {
   3.879411230120973*^9, 3.8794112351565323`*^9}, {3.8798271540344*^9, 
   3.879827174641552*^9}, {3.879855578696269*^9, 3.879855617941187*^9}, {
   3.879855660403594*^9, 3.879855665925931*^9}, {3.8798558258808603`*^9, 
   3.879855835987277*^9}, {3.879856545923551*^9, 3.879856557837154*^9}, {
   3.879856622758039*^9, 3.879856624849141*^9}, {3.879857191568055*^9, 
   3.879857203526271*^9}, {3.880087103085163*^9, 3.880087109374648*^9}, {
   3.880095740833579*^9, 3.880095752807852*^9}, {3.8800961432846212`*^9, 
   3.880096145925229*^9}, {3.880096257683402*^9, 3.880096271275526*^9}, {
   3.880096995758099*^9, 3.880097004472117*^9}, {3.880097121898758*^9, 
   3.880097131824098*^9}, {3.880097175305768*^9, 3.880097180979815*^9}, {
   3.880101196135097*^9, 3.880101200187749*^9}, {3.8801017072325163`*^9, 
   3.88010171124334*^9}, {3.88010188320886*^9, 3.880101889302903*^9}, {
   3.880109992802245*^9, 3.880110024301881*^9}, {3.88011010718747*^9, 
   3.8801101094741793`*^9}, {3.880110391619132*^9, 3.880110417743167*^9}, {
   3.880110489383994*^9, 3.880110530195539*^9}, {3.880110617441391*^9, 
   3.880110629408942*^9}, {3.8801106703097477`*^9, 3.880110672906909*^9}, {
   3.880110720877664*^9, 3.88011072924727*^9}, {3.880188832900456*^9, 
   3.880188834467535*^9}, {3.8801895985014143`*^9, 3.88018960142906*^9}, {
   3.8801953399441023`*^9, 3.880195343453341*^9}, {3.880195419463375*^9, 
   3.880195421466962*^9}, {3.880195657800579*^9, 3.8801956584521427`*^9}, {
   3.880195761703977*^9, 3.8801957643438063`*^9}, {3.880201988696987*^9, 
   3.88020199615693*^9}, {3.880265520189539*^9, 3.880265520806065*^9}, {
   3.880265619539133*^9, 3.88026563724655*^9}, {3.880266570024712*^9, 
   3.880266578003696*^9}, {3.880267849679563*^9, 3.880267859408147*^9}, {
   3.8802679383976994`*^9, 3.880267961587742*^9}, {3.8802753531080647`*^9, 
   3.880275354454999*^9}, {3.880277967300502*^9, 3.8802779698733473`*^9}, {
   3.880295837225429*^9, 3.8802958621765537`*^9}, {3.882262901011772*^9, 
   3.88226291547887*^9}, {3.882262969781851*^9, 3.882262971166835*^9}, {
   3.8827908595665827`*^9, 3.8827909580140057`*^9}, {3.887905072644745*^9, 
   3.8879050941464787`*^9}, 3.88790543545325*^9, {3.887909101747815*^9, 
   3.887909123916484*^9}, {3.902563627662849*^9, 3.9025637080164557`*^9}, {
   3.902564296935267*^9, 3.902564478279936*^9}, {3.902564509248809*^9, 
   3.902564531186233*^9}, {3.9025647748546667`*^9, 3.9025647900357523`*^9}, {
   3.902564874637024*^9, 3.902564901242709*^9}, {3.902565098835127*^9, 
   3.902565162911626*^9}, 
   3.902643295813189*^9},ExpressionUUID->"153b627e-74f2-429b-8222-\
8de61f3107cf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"DateString", "[", 
    RowBox[{"DateObject", "[", "]"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClearAll", "@", "fitMono"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "startMuS", ",", " ", "startSigmaS", ",", "muSA", ",", " ", "sigmaSA", 
     ",", " ", "fitASingle"}], "}"}], ",", 
   RowBox[{"(*", 
    RowBox[{
    "Module", " ", "makes", " ", "the", " ", "variables", " ", "listed", " ", 
     "here", " ", "local"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "the", " ", "first", " ", "round", " ", "uses", " ", "a", " ", "global", 
      " ", "minimisation", " ", "heuristic", " ", 
      RowBox[{"algorithm", ".", " ", "It"}], " ", "is", " ", "quite", " ", 
      RowBox[{"slow", ".", " ", "weights"}], " ", "are", " ", "not", " ", 
      "recommended", " ", "as", " ", "the", " ", "algorithm", " ", "might", 
      " ", "not", " ", 
      RowBox[{"converge", ".", " ", "At"}], " ", "the", " ", "first", " ", 
      "attempot"}], ",", " ", 
     RowBox[{
     "you", " ", "can", " ", "guess", " ", "relatively", " ", "good", " ", 
      "starting", " ", "values", " ", "of", " ", "\[Micro]", " ", "from", " ", 
      RowBox[{"the", " ", "'"}], "Well", " ", 
      RowBox[{"defined", "'"}], " ", "D", " ", "model", " ", "by", " ", 
      "setting", "  ", 
      RowBox[{
       RowBox[{"Log", "[", 
        RowBox[{"Mean", "[", 
         RowBox[{"{", 
          RowBox[{"t1", ",", "t2"}], "}"}], "]"}], "]"}], ".", " ", "I"}], 
      " ", "suggest", " ", "to", " ", "keep", " ", "\[Sigma]", " ", "narrow", 
      " ", "at", " ", "the", " ", 
      RowBox[{"beginning", ".", " ", "Before"}], " ", "playing", " ", 
      "around", " ", "with", " ", "these", " ", "parameters", " ", "and", " ",
       "tryint", " ", "to", " ", "interpret", " ", "the", " ", "outcome", " ",
       "of", " ", "this", " ", "model"}], ",", " ", 
     RowBox[{
     "it", " ", "is", " ", "strongly", " ", "recommended", " ", "to", " ", 
      "become", " ", "familiar", " ", "with", " ", "the", " ", "lognormal", 
      " ", "distribution", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"e", ".", "g", ".", " ", "on"}], " ", "Wikipedia"}], 
       ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"starting", " ", "values"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"startMuS", " ", "=", " ", 
     RowBox[{"Log", "[", 
      RowBox[{"Mean", "[", 
       RowBox[{"{", 
        RowBox[{"t1", ",", "t2"}], "}"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"startSigmaS", " ", "=", " ", "0.1"}], ";", "\[IndentingNewLine]",
     "\[IndentingNewLine]", 
    RowBox[{"fitASingle", " ", "=", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NonlinearModelFit", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"time", ",", " ", "aData"}], "}"}], "\[Transpose]"}], ",", 
        RowBox[{
         RowBox[{"fitTriplet", "[", "\"\<BestFit\>\"", "]"}], " ", 
         RowBox[{"sumLog", "[", 
          RowBox[{"\[Mu]", ",", " ", "\[Sigma]", ",", " ", "t"}], "]"}]}], 
        ",", " ", 
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", " ", "startMuS"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\[Sigma]", ",", " ", "startSigmaS"}], "}"}]}], "}"}], ",",
         " ", "t", ",", 
        RowBox[{"MaxIterations", "->", "5"}], ",", " ", 
        RowBox[{"AccuracyGoal", "->", "5000"}], ",", 
        RowBox[{"PrecisionGoal", "->", "Infinity"}], ",", 
        RowBox[{"Method", "->", 
         RowBox[{"{", 
          RowBox[{"\"\<NMinimize\>\"", ",", " ", 
           RowBox[{"Method", "->", "\"\<DifferentialEvolution\>\""}], ",", 
           " ", 
           RowBox[{"\"\<PostProcess\>\"", "->", "False"}]}], "}"}]}]}], "]"}],
       "//", "Quiet"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"muSA", " ", "=", " ", 
     RowBox[{
      RowBox[{"\[Mu]", "/.", 
       RowBox[{"(", 
        RowBox[{"fitASingle", "[", "\"\<BestFitParameters\>\"", "]"}], 
        ")"}]}], "//", "Quiet"}]}], ";", " ", 
    RowBox[{"(*", 
     RowBox[{
     "the", " ", "results", " ", "of", " ", "the", " ", "first", " ", "round",
       " ", "are", " ", "used", " ", "are", " ", "starting", " ", "guess", 
      " ", "of", " ", "the", " ", "second", " ", "round"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"sigmaSA", " ", "=", 
     RowBox[{
      RowBox[{"\[Sigma]", "/.", 
       RowBox[{"(", 
        RowBox[{"fitASingle", "[", "\"\<BestFitParameters\>\"", "]"}], 
        ")"}]}], "//", "Quiet"}]}], ";", "\n", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"second", " ", "round", " ", "of", " ", "fit"}], ",", " ", 
      RowBox[{
      "to", " ", "refine", " ", "locally", " ", "the", " ", "result", " ", 
       "using", " ", "a", " ", "non", " ", "heuristic", " ", 
       RowBox[{"method", ".", " ", "Weights"}], " ", "can", " ", "be", " ", 
       "added", " ", 
       RowBox[{"here", ".", " ", "This"}], " ", "is", " ", "quite", " ", 
       "fast"}]}], "*)"}], "\[IndentingNewLine]", "\n", 
    RowBox[{"fitMono", "=", 
     RowBox[{
      RowBox[{"NonlinearModelFit", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"time", ",", " ", "aData"}], "}"}], "\[Transpose]"}], ",", 
        RowBox[{
         RowBox[{"fitTriplet", "[", "\"\<BestFit\>\"", "]"}], " ", 
         RowBox[{"sumLog", "[", 
          RowBox[{"\[Mu]", ",", " ", "\[Sigma]", ",", " ", "t"}], "]"}]}], 
        ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", " ", "muSA"}], "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"\[Sigma]", ",", " ", "sigmaSA"}], "}"}]}], "}"}], ",", 
        " ", "t", ",", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Weights", "->", 
           RowBox[{"1", "/", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"stdData", "[", 
               RowBox[{"i", ",", "j"}], "]"}], ")"}], "2"]}]}], ","}], "*)"}],
         " ", 
        RowBox[{"MaxIterations", "->", "1000"}], ",", " ", 
        RowBox[{"AccuracyGoal", "->", "10"}], ",", 
        RowBox[{"PrecisionGoal", "->", "Infinity"}], ",", 
        RowBox[{"Method", "->", "\"\<LevenbergMarquardt\>\""}]}], "]"}], "//",
       "Quiet"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"muS", "=", " ", 
     RowBox[{
      RowBox[{"\[Mu]", "/.", 
       RowBox[{"(", 
        RowBox[{"fitMono", "[", "\"\<BestFitParameters\>\"", "]"}], ")"}]}], "//",
       "Quiet"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"sigmaS", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Abs", "@", "\[Sigma]"}], "/.", 
       RowBox[{"(", 
        RowBox[{"fitMono", "[", "\"\<BestFitParameters\>\"", "]"}], ")"}]}], "//",
       "Quiet"}]}], ";", "\n", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "plot", " ", "the", " ", "probability", " ", "mass", " ", "function"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"plotPmfMono", " ", "=", "  ", 
     RowBox[{
      RowBox[{"ListLogLinearPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{"baseLogT", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"(", " ", 
              RowBox[{
               RowBox[{"gLog", "[", 
                RowBox[{"muS", ",", " ", "sigmaS", ",", " ", "#"}], "]"}], 
               RowBox[{"dBaseLog", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
            "baseLogT"}]}], "}"}], "\[Transpose]"}], ",", " ", 
        RowBox[{"Frame", "->", "True"}], ",", 
        RowBox[{"PlotRange", "->", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.001", ",", "1000"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"0", ",", " ", "0.005"}], "}"}]}], "}"}]}], ",", " ", 
        RowBox[{"Joined", "->", "True"}], ",", "  ", 
        RowBox[{"Filling", "->", "Bottom"}], ",", " ", 
        RowBox[{"PlotStyle", "->", "Black"}], ",", " ", 
        RowBox[{"AspectRatio", "->", 
         RowBox[{"1", "/", "3"}]}], ",", 
        RowBox[{"ImageSize", "->", "Large"}], ",", " ", 
        RowBox[{"FrameLabel", "->", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<\[Rho]\>\"", ",", " ", "None"}], "}"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Time (ms)\>\"", ",", "\"\<Monomodal lognormal model\>\""}], 
            "}"}]}], "}"}]}], ",", " ", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"12", ",", " ", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", " ", 
           "Black"}], "}"}]}]}], "]"}], "//", "Quiet"}]}], ";", "\n", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"plot", " ", "the", " ", "fit"}], "*)"}], "\n", 
    RowBox[{"plotFitMono", " ", "=", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ListLogLinearPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"time", ",", "aBar"}], "}"}], "\[Transpose]"}], ",", " ", 
           RowBox[{"PlotStyle", "->", 
            RowBox[{"{", 
             RowBox[{"Gray", ",", 
              RowBox[{"PointSize", "[", "0.013", "]"}]}], "}"}]}], ",", " ", 
           RowBox[{"IntervalMarkers", "->", "\"\<Fences\>\""}], ",", " ", 
           RowBox[{"Joined", "->", "False"}], ",", 
           RowBox[{"Frame", "->", "True"}], ",", 
           RowBox[{"AspectRatio", "->", 
            RowBox[{"1", "/", "3"}]}], ",", 
           RowBox[{"ImageSize", "->", "Large"}], ",", " ", 
           RowBox[{"PlotLegends", "->", 
            RowBox[{"Placed", "[", 
             RowBox[{
              RowBox[{"Framed", "[", 
               RowBox[{"\"\<\[Mu] = \>\"", "<>", 
                RowBox[{"ToString", "[", "muS", "]"}], "<>", 
                "\"\<\n \[Sigma] = \>\"", "<>", 
                RowBox[{"ToString", "[", "sigmaS", "]"}]}], 
               "\[IndentingNewLine]", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Right", ",", "Top"}], "}"}]}], "]"}]}], ",", 
           RowBox[{"FrameLabel", "->", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<ACF (normalised)\>\"", ",", " ", "None"}], "}"}], 
              ",", " ", 
              RowBox[{"{", 
               RowBox[{
               "\"\<Time (ms)\>\"", ",", 
                "\"\<Monomodal lognormal model\>\""}], "}"}]}], "}"}]}], ",", 
           
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"12", ",", " ", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              " ", "Black"}], "}"}]}]}], "]"}], "//", "Quiet"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"LogLinearPlot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"fitMono", "[", "t", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", 
             RowBox[{"time", "[", 
              RowBox[{"[", "start", "]"}], "]"}], ",", " ", 
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"PlotStyle", "->", 
            RowBox[{"{", 
             RowBox[{"Red", ",", 
              RowBox[{"Thickness", "->", "0.005"}]}], "}"}]}], ",", " ", 
           RowBox[{"PlotPoints", "->", "3"}], ",", " ", 
           RowBox[{"MaxRecursion", "->", "3"}]}], "]"}], "//", "Quiet"}]}], 
       "\[IndentingNewLine]", "]"}], "//", "Quiet"}]}], ";"}]}], 
  "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", "plotFitMono", "\[IndentingNewLine]", \
"plotPmfMono", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</export/\>\"", "<>",
       "launch", "<>", "\"\</fitMono.mx\>\""}], ",", " ", "fitMono", ",", " ", 
     RowBox[{"OverwriteTarget", "->", "\"\<KeepBoth\>\""}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "the", " ", "plots", " ", "reports", " ", "the", " ", "best", " ", "fit", 
    " ", 
    RowBox[{"outcome", ".", " ", "please"}], " ", "remember", " ", "that", 
    " ", "\[Micro]", " ", "and", " ", "\[Sigma]", " ", "are", " ", "not", " ",
     "the", " ", "mean", " ", "and", " ", "standard", " ", "deviation", " ", 
    "and", " ", "\[Micro]", " ", "can", " ", "be", " ", "negative"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.880559426395584*^9, 3.880559458857769*^9}, {
   3.8805595601242743`*^9, 3.880559564720413*^9}, {3.880559680570365*^9, 
   3.8805596840206614`*^9}, {3.880559733413917*^9, 3.880559749857798*^9}, {
   3.880560570015729*^9, 3.880560571078814*^9}, {3.882260653932349*^9, 
   3.8822606594596643`*^9}, {3.88226165115924*^9, 3.882261683493895*^9}, {
   3.8822625793314257`*^9, 3.882262614919839*^9}, {3.882265145989744*^9, 
   3.882265219250605*^9}, 3.882265310150443*^9, {3.8822655528049517`*^9, 
   3.882265557335836*^9}, 3.882266246182499*^9, {3.8822678770562477`*^9, 
   3.882267911341453*^9}, {3.8822683320278473`*^9, 3.882268335420334*^9}, {
   3.882349111313114*^9, 3.882349120038539*^9}, {3.882349228442779*^9, 
   3.882349255965829*^9}, {3.882349569231271*^9, 3.882349600215426*^9}, {
   3.8823496839043083`*^9, 3.882349688132742*^9}, {3.8823502186737823`*^9, 
   3.8823502589453173`*^9}, 3.882350341715741*^9, {3.882350375934794*^9, 
   3.882350422930997*^9}, {3.882350541439286*^9, 3.882350555081381*^9}, {
   3.882351914991274*^9, 3.882351950092292*^9}, {3.8823519878157997`*^9, 
   3.882352059130848*^9}, {3.882353469556506*^9, 3.8823534697665462`*^9}, {
   3.882354919286654*^9, 3.882355019256679*^9}, {3.8823550605429173`*^9, 
   3.8823550620436993`*^9}, {3.8823551952719803`*^9, 3.882355213927846*^9}, {
   3.882355258676929*^9, 3.88235526860063*^9}, {3.8823555662417707`*^9, 
   3.882355573707123*^9}, {3.88235566522502*^9, 3.8823556701154118`*^9}, {
   3.882355722081698*^9, 3.8823557268162413`*^9}, {3.882355804326721*^9, 
   3.882355821267398*^9}, 3.8823571862889967`*^9, {3.882357463197028*^9, 
   3.8823574637212973`*^9}, 3.882358134885882*^9, {3.882358167229323*^9, 
   3.88235816739225*^9}, {3.882359232592852*^9, 3.8823592331457148`*^9}, 
   3.882359280947109*^9, {3.882359320282875*^9, 3.8823593206665373`*^9}, 
   3.882360095499134*^9, {3.8823627617288237`*^9, 3.882362772829747*^9}, 
   3.882363589284127*^9, {3.882363674024384*^9, 3.882363682338365*^9}, {
   3.8823640834593487`*^9, 3.88236411702676*^9}, 3.882382809887498*^9, {
   3.882382937716662*^9, 3.882382941654633*^9}, {3.882383095554731*^9, 
   3.882383205027608*^9}, {3.882383327207904*^9, 3.882383329935952*^9}, {
   3.8823833924085503`*^9, 3.882383405741989*^9}, {3.882383740211866*^9, 
   3.882383751900606*^9}, {3.882383877930173*^9, 3.882383878063201*^9}, {
   3.882384615727062*^9, 3.8823846162538643`*^9}, {3.882385168279353*^9, 
   3.882385187286881*^9}, {3.8826182063588037`*^9, 3.882618234699604*^9}, {
   3.882618511935459*^9, 3.882618512673319*^9}, {3.8826187415219307`*^9, 
   3.882618764837613*^9}, {3.882618796568557*^9, 3.882618823532881*^9}, {
   3.882619107349277*^9, 3.8826191078937693`*^9}, {3.882789896269806*^9, 
   3.882789922551251*^9}, {3.8827899876659527`*^9, 3.882790016092503*^9}, {
   3.882790048946203*^9, 3.882790056991212*^9}, {3.8827903412713614`*^9, 
   3.882790352039117*^9}, 3.8827907949645023`*^9, {3.882790915740675*^9, 
   3.8827909213459272`*^9}, {3.8827913995096207`*^9, 3.882791414398263*^9}, {
   3.882791467248101*^9, 3.8827915123784246`*^9}, {3.882791543621459*^9, 
   3.882791601230715*^9}, {3.882791645911682*^9, 3.882791679005453*^9}, {
   3.882791751400745*^9, 3.882791756046071*^9}, {3.8828708805615807`*^9, 
   3.8828708814251127`*^9}, {3.882872351307819*^9, 3.8828723666640463`*^9}, {
   3.8828724132325068`*^9, 3.882872435914646*^9}, {3.8828725341428757`*^9, 
   3.882872575748475*^9}, {3.882872610710479*^9, 3.882872631469943*^9}, {
   3.882872676081339*^9, 3.88287268102494*^9}, {3.8828727545385723`*^9, 
   3.882872757849641*^9}, {3.882872878991275*^9, 3.882872881352442*^9}, {
   3.882873111759775*^9, 3.882873124766457*^9}, 3.882876970026019*^9, {
   3.882937162336596*^9, 3.882937164879547*^9}, 3.8829374005171757`*^9, {
   3.882951302670385*^9, 3.882951408370393*^9}, {3.883377353814748*^9, 
   3.883377354697044*^9}, {3.883377397983004*^9, 3.883377403709382*^9}, 
   3.883377596748855*^9, {3.8833779991412582`*^9, 3.883378010499558*^9}, {
   3.8833782038223333`*^9, 3.883378212076078*^9}, {3.88362903151164*^9, 
   3.883629041469612*^9}, {3.883669153598804*^9, 3.8836691709869347`*^9}, 
   3.884867811924877*^9, 3.8848679800751753`*^9, 3.884938210745352*^9, {
   3.884942908246674*^9, 3.884942928394315*^9}, {3.8849457648570747`*^9, 
   3.884945787851396*^9}, {3.8849458262899427`*^9, 3.884945837747787*^9}, {
   3.885212451173581*^9, 3.88521245634899*^9}, {3.886420670478299*^9, 
   3.886420670613707*^9}, {3.8864208460587053`*^9, 3.8864208478105516`*^9}, {
   3.887905016674985*^9, 3.8879050370646677`*^9}, {3.88790512172187*^9, 
   3.887905122632975*^9}, {3.887905593355254*^9, 3.887905667521112*^9}, {
   3.8879060572549047`*^9, 3.887906102328548*^9}, 3.8879527197105217`*^9, {
   3.902570653656783*^9, 3.902570655428928*^9}, 3.902571283565895*^9, {
   3.9025713397247477`*^9, 3.902571348683465*^9}, {3.9025714291712227`*^9, 
   3.9025714549906473`*^9}, {3.9025716258761063`*^9, 3.902571670299488*^9}, {
   3.9025718008861227`*^9, 3.902571804016114*^9}, {3.902571896780034*^9, 
   3.902571996535459*^9}, {3.902572267620618*^9, 3.902572396558857*^9}, {
   3.902574490954072*^9, 3.902574493406775*^9}, {3.902574563050684*^9, 
   3.9025746300900593`*^9}, 3.9025749194335527`*^9, {3.902575144283403*^9, 
   3.90257516194718*^9}, {3.902575199362904*^9, 3.902575242589683*^9}, {
   3.902635748889151*^9, 3.9026358327774143`*^9}, {3.902635864161978*^9, 
   3.902635906567577*^9}, {3.902637419909506*^9, 3.902637463657701*^9}, {
   3.9026375653923073`*^9, 3.9026376576336193`*^9}, {3.902637696254225*^9, 
   3.902637740118223*^9}, {3.902637909249461*^9, 3.9026381141997004`*^9}, {
   3.90264124922291*^9, 3.902641385929956*^9}, {3.90264327763944*^9, 
   3.9026433286197042`*^9}, {3.902647572981827*^9, 3.902647574333685*^9}, 
   3.9026520167896223`*^9, {3.902656519725841*^9, 3.9026565600748587`*^9}, 
   3.902656591818162*^9},ExpressionUUID->"195e1e7f-c876-4aaa-83c0-\
e5f50580745e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</export/\>\"", "<>",
       "launch", "<>", "\"\</\>\"", "<>", "\"\<mono_PMF.jpg\>\""}], ",", 
     "plotPmfMono", ",", 
     RowBox[{"ImageResolution", "->", "500"}], ",", " ", 
     RowBox[{"OverwriteTarget", "->", "\"\<KeepBoth\>\""}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</export/\>\"", "<>",
        "launch", "<>", "\"\</\>\"", "<>", "\"\<mono_Fit.jpg\>\""}], ",", 
      "plotFitMono", ",", 
      RowBox[{"ImageResolution", "->", "500"}], ",", " ", 
      RowBox[{"OverwriteTarget", "->", "\"\<KeepBoth\>\""}]}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8823637778499002`*^9, 3.88236395907382*^9}, {
   3.882363990050111*^9, 3.8823639928940163`*^9}, 3.882364230717732*^9, {
   3.882382882474758*^9, 3.8823829182256403`*^9}, {3.882383004731917*^9, 
   3.8823830424407578`*^9}, {3.8823845287657948`*^9, 
   3.8823845321772127`*^9}, {3.882414582409336*^9, 3.8824145955959387`*^9}, {
   3.882871082048923*^9, 3.882871118621793*^9}, {3.882871398669777*^9, 
   3.882871453856338*^9}, {3.882871484354006*^9, 3.882871496852149*^9}, {
   3.882871529572154*^9, 3.882871541133526*^9}, {3.882871923080647*^9, 
   3.8828719731419573`*^9}, {3.8828731538857107`*^9, 
   3.8828731586854353`*^9}, {3.882876787332612*^9, 3.882876789701189*^9}, {
   3.882876955508623*^9, 3.882876963717276*^9}, {3.882951264596184*^9, 
   3.8829512686523952`*^9}, {3.884942938613578*^9, 3.884942941909369*^9}, {
   3.887906527933938*^9, 3.8879065753723497`*^9}, {3.902575271386146*^9, 
   3.9025753044508657`*^9}},
 CellLabel->
  "In[410]:=",ExpressionUUID->"1d4582f0-3cc9-41b6-84f5-533b7ca9392e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["LogNormal Bimodal", "Subsection",
 CellChangeTimes->{{3.882269399222597*^9, 3.882269405988082*^9}, {
  3.882351934468061*^9, 3.882351944611165*^9}, {3.8823829778605747`*^9, 
  3.882382978625689*^9}, {3.882608656916181*^9, 
  3.882608663124687*^9}},ExpressionUUID->"0a374b17-c21c-4189-b6a3-\
fddfb8174010"],

Cell["\<\
In this part we are going to fit with the sum of two lognormal distributions. \
Here good starting guesses are relevant and it can be very slow.\
\>", "Text",
 CellChangeTimes->{{3.902656624520833*^9, 
  3.902656694355113*^9}},ExpressionUUID->"6f128a85-3853-47f8-97b2-\
d4a5ce4a8789"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mu1Start", ",", "mu2Start", ",", " ", "sigma1Start", ",", 
       "sigma2Start", ",", "rhoStart", ",", "fitA", ",", " ", "mu1A", ",", 
       " ", "sigma1A", ",", " ", "mu2A", ",", " ", "sigma2A", ",", " ", 
       "rhoA", ",", " ", "maxGLog2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mu1Start", " ", "=", " ", 
       RowBox[{"Log", "[", "t1", "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "in", " ", "this", " ", "example", " ", "the", " ", "starting", " ", 
        "guess", " ", "come", " ", "directly", " ", "from", " ", 
        RowBox[{"the", " ", "'"}], 
        RowBox[{"traditional", "'"}], " ", 
        RowBox[{"fit", ".", " ", "We"}], " ", "know", " ", "that", " ", 
        "there", " ", "is", " ", "no", " ", "spreading", " ", "species"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mu2Start", " ", "=", "  ", 
       RowBox[{"Log", "[", "t2", "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"sigma1Start", " ", "=", " ", "0.001"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sigma2Start", " ", "=", " ", "0.001"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"rhoStart", " ", "=", " ", 
       SqrtBox[".5"]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"this", " ", "means", " ", "equal", " ", "split", " ", 
        RowBox[{"(", 
         RowBox[{
         "it", " ", "is", " ", "squared", " ", "in", " ", "the", " ", 
          "definition", " ", "to", " ", "avoid", " ", "negative", " ", 
          "values"}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<starting time: \>\"", "<>", 
        RowBox[{"DateString", "[", 
         RowBox[{"DateObject", "[", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"like", " ", "before"}], ",", " ", 
        RowBox[{
        "this", " ", "is", " ", "the", " ", "first", " ", "round", " ", "of", 
         " ", "fit"}], ",", " ", 
        RowBox[{"heuristic", " ", "global", " ", 
         RowBox[{"minimisation", ".", " ", "This"}], " ", "is", " ", "really",
          " ", "slow"}], ",", " ", 
        RowBox[{
        "setting", " ", "MaxIterations", " ", "to", " ", "500", " ", "takes", 
         " ", "roughly", " ", "4", " ", "minutes", " ", "to", " ", "fit", " ",
          "one", " ", "curve", " ", "on", " ", "a", " ", "Macbook", " ", 
         "Pro", " ", "2017", " ", "with", " ", "i5", " ", "2.3", "GHz", " ", 
         "CPU"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "in", " ", "some", " ", "cases", " ", "it", " ", "is", " ", "better", 
        " ", "to", " ", "cut", " ", "off", " ", "the", " ", "triplets", " ", 
        "from", " ", "the", " ", "analysis"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"fitA", "=", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"start", ";;"}], "]"}], "]"}], ",", " ", 
             RowBox[{"aData", "[", 
              RowBox[{"[", 
               RowBox[{"start", ";;"}], "]"}], "]"}]}], "}"}], 
           "\[Transpose]"}], ",", 
          RowBox[{
           RowBox[{"fitTriplet", "[", "\"\<BestFit\>\"", "]"}], 
           RowBox[{"sumTwoLog", "[", 
            RowBox[{
            "\[Mu]1", ",", " ", "\[Sigma]1", ",", "\[Mu]2", ",", " ", 
             "\[Sigma]2", ",", "\[Rho]", ",", " ", "t"}], "]"}]}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Mu]1", ",", " ", "mu1Start"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\[Sigma]1", ",", " ", "sigma1Start"}], "}"}], ",", "  ", 
            RowBox[{"{", 
             RowBox[{"\[Mu]2", ",", "mu2Start"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\[Sigma]2", ",", "sigma2Start"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\[Rho]", ",", "rhoStart"}], "}"}]}], "}"}], ",", " ", 
          "t", ",", 
          RowBox[{"MaxIterations", "->", "1000"}], ",", " ", 
          RowBox[{"AccuracyGoal", "->", "5"}], ",", 
          RowBox[{"PrecisionGoal", "->", "Infinity"}], ",", 
          RowBox[{"Method", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<NMinimize\>\"", ",", " ", 
             RowBox[{"Method", "->", 
              RowBox[{"{", 
               RowBox[{"\"\<DifferentialEvolution\>\"", ",", " ", 
                RowBox[{"\"\<PostProcess\>\"", "->", "False"}]}], "}"}]}]}], 
            "}"}]}]}], "]"}], "//", "Quiet"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<first round completed - \>\"", "<>", "\"\<time: \>\"", "<>", 
        RowBox[{"DateString", "[", 
         RowBox[{"DateObject", "[", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "outcomes", " ", "of", " ", "the", " ", "first", " ", "fitt", " ", 
        "are", " ", "used", " ", "are", " ", "guesses", " ", "for", " ", 
        "the", " ", "second", " ", "round"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"mu1A", " ", "=", " ", 
       RowBox[{
        RowBox[{"\[Mu]1", "/.", 
         RowBox[{"(", 
          RowBox[{"fitA", "[", "\"\<BestFitParameters\>\"", "]"}], ")"}]}], "//",
         "Quiet"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sigma1A", " ", "=", 
       RowBox[{
        RowBox[{"\[Sigma]1", "/.", 
         RowBox[{"(", 
          RowBox[{"fitA", "[", "\"\<BestFitParameters\>\"", "]"}], ")"}]}], "//",
         "Quiet"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"mu2A", " ", "=", " ", 
       RowBox[{
        RowBox[{"\[Mu]2", "/.", 
         RowBox[{"(", 
          RowBox[{"fitA", "[", "\"\<BestFitParameters\>\"", "]"}], ")"}]}], "//",
         "Quiet"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sigma2A", " ", "=", 
       RowBox[{
        RowBox[{"\[Sigma]2", "/.", 
         RowBox[{"(", 
          RowBox[{"fitA", "[", "\"\<BestFitParameters\>\"", "]"}], ")"}]}], "//",
         "Quiet"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rhoA", " ", "=", 
       RowBox[{
        RowBox[{"\[Rho]", "/.", 
         RowBox[{"(", 
          RowBox[{"fitA", "[", "\"\<BestFitParameters\>\"", "]"}], ")"}]}], "//",
         "Quiet"}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"(*", 
       RowBox[{"second", " ", "round", " ", "of", " ", 
        RowBox[{"fit", ".", " ", "Weights"}], " ", "can", " ", "be", " ", 
        "introduced", " ", "here"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"fitBi", "=", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"time", "[", 
              RowBox[{"[", 
               RowBox[{"start", ";;"}], "]"}], "]"}], ",", " ", 
             RowBox[{"aData", "[", 
              RowBox[{"[", 
               RowBox[{"start", ";;"}], "]"}], "]"}]}], "}"}], 
           "\[Transpose]"}], ",", " ", 
          RowBox[{
           RowBox[{"fitTriplet", "[", "\"\<BestFit\>\"", "]"}], 
           RowBox[{"sumTwoLog", "[", 
            RowBox[{
            "\[Mu]1", ",", " ", "\[Sigma]1", ",", "\[Mu]2", ",", " ", 
             "\[Sigma]2", ",", "\[Rho]", ",", " ", "t"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Mu]1", ",", " ", "mu1A"}], " ", "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\[Sigma]1", ",", " ", "sigma1A"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\[Mu]2", ",", " ", "mu2A"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\[Sigma]2", ",", "  ", "sigma2A"}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"\[Rho]", ",", "rhoA"}], " ", "}"}]}], "}"}], ",", " ", 
          "t", ",", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Weights", "->", 
             RowBox[{"1", "/", 
              SuperscriptBox[
               RowBox[{"stdData", "[", "i", "]"}], "2"]}]}], ","}], "*)"}], 
          RowBox[{"MaxIterations", "->", "1000"}], ",", " ", 
          RowBox[{"AccuracyGoal", "->", "10"}], ",", 
          RowBox[{"PrecisionGoal", "->", "Infinity"}], ",", 
          RowBox[{"Method", "->", "\"\<LevenbergMarquardt\>\""}]}], "]"}], "//",
         "Quiet"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"mu1", "=", 
       RowBox[{
        RowBox[{"\[Mu]1", "/.", 
         RowBox[{"(", 
          RowBox[{"fitBi", "[", "\"\<BestFitParameters\>\"", "]"}], ")"}]}], "//",
         "Quiet"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sigma1", " ", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "@", "\[Sigma]1"}], "/.", 
         RowBox[{"(", 
          RowBox[{"fitBi", "[", "\"\<BestFitParameters\>\"", "]"}], ")"}]}], "//",
         "Quiet"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"mu2", " ", "=", 
       RowBox[{
        RowBox[{"\[Mu]2", "/.", 
         RowBox[{"(", 
          RowBox[{"fitBi", "[", "\"\<BestFitParameters\>\"", "]"}], ")"}]}], "//",
         "Quiet"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sigma2", " ", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "@", "\[Sigma]2"}], "/.", 
         RowBox[{"(", 
          RowBox[{"fitBi", "[", "\"\<BestFitParameters\>\"", "]"}], ")"}]}], "//",
         "Quiet"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rho", " ", "=", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Rho]", "/.", 
           RowBox[{"(", 
            RowBox[{"fitBi", "[", "\"\<BestFitParameters\>\"", "]"}], ")"}]}],
           "//", "Quiet"}], ")"}], "2"]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<second round completed - \>\"", "<>", "\"\<time: \>\"", "<>", 
        RowBox[{"DateString", "[", 
         RowBox[{"DateObject", "[", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\n", 
      RowBox[{"plotPmfBi", "=", "  ", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ListLogLinearPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", " ", 
               RowBox[{"baseLogT", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"rho", 
                   RowBox[{"(", " ", 
                    RowBox[{
                    RowBox[{"gLog", "[", 
                    RowBox[{"mu1", ",", " ", "sigma1", ",", " ", "#"}], "]"}], 
                    RowBox[{"dBaseLog", "[", "#", "]"}]}], ")"}]}], "&"}], "/@",
                  "baseLogT"}]}], "}"}], "\[Transpose]"}], ",", " ", 
             RowBox[{"Frame", "->", "True"}], ",", 
             RowBox[{"PlotRange", "->", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.001", ",", "1000"}], "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{"0", ",", " ", "0.005"}], "}"}]}], "}"}]}], ",", " ", 
             RowBox[{"Joined", "->", "True"}], ",", "  ", 
             RowBox[{"Filling", "->", "Bottom"}], ",", " ", 
             RowBox[{"PlotStyle", "->", "Black"}], ",", " ", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", "3"}]}], ",", 
             RowBox[{"ImageSize", "->", "Large"}], ",", " ", 
             RowBox[{"FrameLabel", "->", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<\[Rho]\>\"", ",", " ", "None"}], "}"}], ",", 
                " ", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Time (ms)\>\"", ",", 
                  "\"\<Bimodal lognormal model\>\""}], "}"}]}], "}"}]}], ",", 
             " ", 
             RowBox[{"LabelStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"12", ",", " ", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
                " ", "Black"}], "}"}]}]}], "]"}], "//", "Quiet"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ListLogLinearPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", " ", 
               RowBox[{"baseLogT", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "rho"}], ")"}], 
                   RowBox[{"(", " ", 
                    RowBox[{
                    RowBox[{"gLog", "[", 
                    RowBox[{"mu2", ",", " ", "sigma2", ",", " ", "#"}], "]"}], 
                    RowBox[{"dBaseLog", "[", "#", "]"}]}], ")"}]}], "&"}], "/@",
                  "baseLogT"}]}], "}"}], "\[Transpose]"}], ",", " ", 
             RowBox[{"Joined", "->", "True"}], ",", 
             RowBox[{"PlotRange", "->", "All"}], ",", "  ", 
             RowBox[{"Filling", "->", "Bottom"}], ",", " ", 
             RowBox[{"PlotStyle", "->", "Black"}]}], "]"}], "//", "Quiet"}]}],
          "]"}], "//", "Quiet"}]}], ";", "\n", "\n", 
      RowBox[{"plotFitBi", " ", "=", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ListLogLinearPlot", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"time", ",", "aData"}], "}"}], "\[Transpose]"}], ",", 
             " ", 
             RowBox[{"PlotStyle", "->", 
              RowBox[{"{", 
               RowBox[{"Gray", ",", 
                RowBox[{"PointSize", "[", "0.013", "]"}]}], "}"}]}], ",", " ", 
             RowBox[{"IntervalMarkers", "->", "\"\<Bands\>\""}], ",", " ", 
             RowBox[{"Joined", "->", "False"}], ",", 
             RowBox[{"Frame", "->", "True"}], ",", 
             RowBox[{"AspectRatio", "->", 
              RowBox[{"1", "/", "3"}]}], ",", 
             RowBox[{"ImageSize", "->", "Large"}], ",", " ", 
             RowBox[{"PlotLegends", "->", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"Framed", "[", 
                 RowBox[{"\"\<\[Mu]1 = \>\"", "<>", 
                  RowBox[{"ToString", "[", "mu1", "]"}], "<>", 
                  "\"\<\n \[Sigma]1 = \>\"", "<>", 
                  RowBox[{"ToString", "[", "sigma1", "]"}], "<>", 
                  "\"\<\n\[Mu]2 = \>\"", "<>", 
                  RowBox[{"ToString", "[", "mu2", "]"}], "<>", 
                  "\"\<\n \[Sigma]2 = \>\"", "<>", 
                  RowBox[{"ToString", "[", "sigma2", "]"}], "<>", 
                  "\"\<\[IndentingNewLine]% species 1 = \>\"", "<>", 
                  RowBox[{"ToString", "[", "rho", "]"}]}], 
                 "\[IndentingNewLine]", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"Right", ",", "Top"}], "}"}]}], "]"}]}], ",", 
             RowBox[{"FrameLabel", "->", 
              RowBox[{"{", " ", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"\"\<ACF (normalised)\>\"", ",", " ", "None"}], 
                 "}"}], ",", " ", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<Time (ms)\>\"", ",", 
                  "\"\<Bimodal lognormal model\>\""}], "}"}]}], "}"}]}], ",", 
             
             RowBox[{"LabelStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"12", ",", " ", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
                " ", "Black"}], "}"}]}]}], "]"}], "//", "Quiet"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"LogLinearPlot", "[", 
            RowBox[{
             RowBox[{"Evaluate", "[", 
              RowBox[{"fitBi", "[", "t", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", " ", 
               RowBox[{"time", "[", 
                RowBox[{"[", "start", "]"}], "]"}], ",", " ", 
               RowBox[{"time", "[", 
                RowBox[{"[", 
                 RowBox[{"-", "1"}], "]"}], "]"}]}], "}"}], ",", " ", 
             RowBox[{"PlotStyle", "->", 
              RowBox[{"{", 
               RowBox[{"Red", ",", 
                RowBox[{"Thickness", "->", "0.005"}]}], "}"}]}], ",", " ", 
             RowBox[{"PlotPoints", "->", "3"}], ",", " ", 
             RowBox[{"MaxRecursion", "->", "3"}]}], "]"}], "//", "Quiet"}]}], 
         "\[IndentingNewLine]", "]"}], "//", "Quiet"}]}], ";"}]}], 
    "\[IndentingNewLine]", "\n", "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"DateString", "[", 
      RowBox[{"DateObject", "[", "]"}], "]"}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<peak 1 (D) = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"d", "[", 
       RowBox[{"Exp", "[", "mu1", "]"}], "]"}], "]"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<peak 2 (D) = \>\"", "<>", 
     RowBox[{"ToString", "[", 
      RowBox[{"d", "[", 
       RowBox[{"Exp", "[", "mu2", "]"}], "]"}], "]"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "plotFitBi", 
   "\[IndentingNewLine]", "plotPmfBi", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</export/\>\"", "<>",
        "launch", "<>", "\"\</fitBi.mx\>\""}], ",", " ", "fitBi", ",", " ", 
      RowBox[{"OverwriteTarget", "->", "\"\<KeepBoth\>\""}]}], "]"}], ";"}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.880559426395584*^9, 3.880559458857769*^9}, {
   3.8805595601242743`*^9, 3.880559564720413*^9}, {3.880559680570365*^9, 
   3.8805596840206614`*^9}, {3.880559733413917*^9, 3.880559749857798*^9}, {
   3.880560570015729*^9, 3.880560571078814*^9}, {3.882260653932349*^9, 
   3.8822606594596643`*^9}, {3.88226165115924*^9, 3.882261683493895*^9}, {
   3.8822625793314257`*^9, 3.882262614919839*^9}, {3.882265145989744*^9, 
   3.882265219250605*^9}, 3.882265310150443*^9, {3.8822655528049517`*^9, 
   3.882265557335836*^9}, 3.882266246182499*^9, {3.8822678770562477`*^9, 
   3.882267911341453*^9}, {3.8822683320278473`*^9, 3.882268335420334*^9}, {
   3.882349111313114*^9, 3.882349120038539*^9}, {3.882349228442779*^9, 
   3.882349255965829*^9}, {3.882349569231271*^9, 3.882349600215426*^9}, {
   3.8823496839043083`*^9, 3.882349688132742*^9}, {3.8823502186737823`*^9, 
   3.8823502589453173`*^9}, 3.882350341715741*^9, {3.882350375934794*^9, 
   3.882350422930997*^9}, {3.882350541439286*^9, 3.882350555081381*^9}, {
   3.882351914991274*^9, 3.882351950092292*^9}, {3.8823519878157997`*^9, 
   3.882352059130848*^9}, {3.882353469556506*^9, 3.8823534697665462`*^9}, {
   3.882354919286654*^9, 3.882355019256679*^9}, {3.8823550605429173`*^9, 
   3.8823550620436993`*^9}, {3.8823551952719803`*^9, 3.882355213927846*^9}, {
   3.882355258676929*^9, 3.88235526860063*^9}, {3.8823555662417707`*^9, 
   3.882355573707123*^9}, {3.88235566522502*^9, 3.8823556701154118`*^9}, {
   3.882355722081698*^9, 3.8823557268162413`*^9}, {3.882355804326721*^9, 
   3.882355821267398*^9}, 3.8823571862889967`*^9, {3.882357463197028*^9, 
   3.8823574637212973`*^9}, 3.882358134885882*^9, {3.882358167229323*^9, 
   3.88235816739225*^9}, {3.882359232592852*^9, 3.8823592331457148`*^9}, 
   3.882359280947109*^9, {3.882359320282875*^9, 3.8823593206665373`*^9}, 
   3.882360095499134*^9, {3.8823627617288237`*^9, 3.882362772829747*^9}, 
   3.882363589284127*^9, {3.882363674024384*^9, 3.882363682338365*^9}, {
   3.8823640834593487`*^9, 3.88236411702676*^9}, 3.882382809887498*^9, {
   3.882382937716662*^9, 3.882382941654633*^9}, {3.882385507594536*^9, 
   3.882385508329549*^9}, {3.882422567769311*^9, 3.88242258161509*^9}, {
   3.882422633633088*^9, 3.882422633840917*^9}, 3.882422912862628*^9, {
   3.882423361698821*^9, 3.8824234103683767`*^9}, {3.8824236702470093`*^9, 
   3.882423691033979*^9}, {3.8826190963184958`*^9, 3.882619148558502*^9}, {
   3.8826191872513943`*^9, 3.882619208409985*^9}, {3.882802913709675*^9, 
   3.8828031248792257`*^9}, {3.8828031643185787`*^9, 3.882803270256268*^9}, {
   3.882803432489377*^9, 3.882803433103951*^9}, 3.8828035185534363`*^9, {
   3.88280365367915*^9, 3.882803675819195*^9}, {3.8828038344766493`*^9, 
   3.882803838225987*^9}, {3.8828040197332497`*^9, 3.882804024443467*^9}, 
   3.882870955574174*^9, {3.882871001730359*^9, 3.882871001889559*^9}, {
   3.88287328516346*^9, 3.882873362567581*^9}, {3.8828733943273478`*^9, 
   3.882873409912129*^9}, {3.882873451930723*^9, 3.882873452231638*^9}, {
   3.882876663566553*^9, 3.882876669693306*^9}, {3.882876722924242*^9, 
   3.8828767270813103`*^9}, {3.882876879148674*^9, 3.882876888092019*^9}, {
   3.8828771367669764`*^9, 3.8828771369373093`*^9}, {3.882878763118003*^9, 
   3.882878773465846*^9}, {3.882883614218121*^9, 3.882883614663056*^9}, {
   3.882937108060967*^9, 3.8829371165808773`*^9}, {3.882951331961863*^9, 
   3.882951335690515*^9}, {3.88295141215238*^9, 3.88295141706982*^9}, {
   3.88328293284137*^9, 3.883282942347348*^9}, {3.883282974377378*^9, 
   3.88328299916063*^9}, {3.883283033340085*^9, 3.88328308334278*^9}, {
   3.8832831248168993`*^9, 3.883283138385384*^9}, {3.883377341545961*^9, 
   3.883377343019014*^9}, {3.883378230881576*^9, 3.8833782376599092`*^9}, {
   3.883378393445643*^9, 3.883378397092931*^9}, {3.8835868722877483`*^9, 
   3.883586874391082*^9}, {3.8836290656125793`*^9, 3.883629065837928*^9}, {
   3.8836691834330873`*^9, 3.883669202587718*^9}, {3.883669251077038*^9, 
   3.883669251206739*^9}, 3.88486782852169*^9, 3.8848680014550943`*^9, {
   3.8849382174592524`*^9, 3.884938225009994*^9}, {3.884946033553212*^9, 
   3.884946107515991*^9}, {3.8849461665708237`*^9, 3.8849462059123917`*^9}, {
   3.8849618825343037`*^9, 3.884961885300536*^9}, {3.8852039113608103`*^9, 
   3.8852040218787746`*^9}, {3.8852040967096233`*^9, 3.885204098961853*^9}, 
   3.885299892372076*^9, 3.885299923584697*^9, {3.8858044383073177`*^9, 
   3.8858044385420237`*^9}, {3.886830088568388*^9, 3.8868302000722523`*^9}, {
   3.886830521932024*^9, 3.8868305228576202`*^9}, {3.886830787837657*^9, 
   3.8868308254619226`*^9}, {3.88683105124719*^9, 3.886831052445387*^9}, {
   3.886831260252612*^9, 3.886831291539645*^9}, {3.886831573299634*^9, 
   3.886831760529601*^9}, {3.8868320420352707`*^9, 3.8868320571687737`*^9}, {
   3.886832218052464*^9, 3.886832229383498*^9}, {3.88683229434051*^9, 
   3.886832341725295*^9}, {3.886832420682762*^9, 3.88683242859624*^9}, {
   3.886840562077586*^9, 3.886840609899289*^9}, {3.886840690336738*^9, 
   3.886840733289707*^9}, {3.8871072777827463`*^9, 3.8871073544382467`*^9}, {
   3.887107388228963*^9, 3.887107388964301*^9}, {3.887906620879958*^9, 
   3.8879066548196917`*^9}, {3.887906860498869*^9, 3.8879069000442266`*^9}, {
   3.8879069333777533`*^9, 3.88790713762654*^9}, {3.8879075422227573`*^9, 
   3.887907702954256*^9}, {3.887908761488426*^9, 3.887908761616334*^9}, 
   3.8879091419652557`*^9, 3.887909395960874*^9, {3.887952731333329*^9, 
   3.8879528215241756`*^9}, {3.887970634797289*^9, 3.887970640232126*^9}, {
   3.88797488977783*^9, 3.8879748912250834`*^9}, {3.887982593511903*^9, 
   3.887982654416111*^9}, {3.888041324682235*^9, 3.888041341005493*^9}, {
   3.8880413987938757`*^9, 3.88804143177246*^9}, {3.902639589010887*^9, 
   3.902639618665188*^9}, {3.9026401531916323`*^9, 3.90264019770228*^9}, {
   3.9026409019645643`*^9, 3.9026409546576557`*^9}, {3.902642716273244*^9, 
   3.902642886612925*^9}, {3.902643069134521*^9, 3.902643264780513*^9}, {
   3.902643344055943*^9, 3.90264348205273*^9}, {3.902644915761464*^9, 
   3.902645041262047*^9}, {3.902647407747691*^9, 3.9026474367137423`*^9}, {
   3.902647552345605*^9, 3.902647588492517*^9}, {3.902651360894794*^9, 
   3.902651455764172*^9}, {3.90265193687007*^9, 3.902651955596952*^9}, {
   3.9026519950496902`*^9, 3.90265211753447*^9}, {3.902652414010038*^9, 
   3.902652430094492*^9}, {3.902652666719245*^9, 3.902652674257104*^9}, {
   3.902653874098213*^9, 3.902653874458592*^9}, {3.902655085164905*^9, 
   3.90265509305025*^9}, 3.90265658501782*^9, {3.902656701174115*^9, 
   3.9026567397133293`*^9}},ExpressionUUID->"bf94f4dd-83fd-4f49-8904-\
df0f1b5e8b93"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</export/\>\"", "<>",
        "launch", "<>", "\"\</\>\"", "<>", "\"\<bimodal_PMF.jpg\>\""}], ",", 
      "plotPmfBi", ",", 
      RowBox[{"ImageResolution", "->", "500"}], ",", " ", 
      RowBox[{"OverwriteTarget", "->", "\"\<KeepBoth\>\""}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Export", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</export/\>\"", "<>",
        "launch", "<>", "\"\</\>\"", "<>", "\"\<bimodal_Fit.jpg\>\""}], ",", 
      "plotFitBi", ",", 
      RowBox[{"ImageResolution", "->", "500"}], ",", " ", 
      RowBox[{"OverwriteTarget", "->", "\"\<KeepBoth\>\""}]}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.8823637778499002`*^9, 3.88236395907382*^9}, {
   3.882363990050111*^9, 3.8823639928940163`*^9}, 3.882364230717732*^9, {
   3.882382882474758*^9, 3.8823829182256403`*^9}, {3.882871992149439*^9, 
   3.8828720447078657`*^9}, {3.8828723181059732`*^9, 3.882872332536852*^9}, {
   3.8828750491154203`*^9, 3.882875056092465*^9}, {3.882876760373493*^9, 
   3.882876779777061*^9}, {3.882876931861739*^9, 3.882876945683791*^9}, {
   3.882877942705402*^9, 3.882877943602785*^9}, 3.8829497789903393`*^9, {
   3.8829512561741056`*^9, 3.882951258764595*^9}, {3.8835890013579884`*^9, 
   3.883589003135281*^9}, {3.884926049114855*^9, 3.8849260492739363`*^9}, {
   3.885204105743791*^9, 3.885204106615088*^9}, {3.887974818680917*^9, 
   3.887974866404838*^9}, {3.902647509087368*^9, 
   3.902647540327765*^9}},ExpressionUUID->"4737278e-917a-4aab-8bd2-\
1978a844d7fb"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{Automatic, 277}, {Automatic, 31}},
ShowCellTags->True,
Magnification:>1.25 Inherited,
FrontEndVersion->"13.2 for Mac OS X x86 (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"bc9903ba-4cb1-4f1f-8e8e-dce5cfd171e9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 700, 13, 131, "Text",ExpressionUUID->"cf41266c-fe6c-4791-bdc8-ff892b344b12"],
Cell[1261, 35, 333, 8, 37, "Input",ExpressionUUID->"a0a97180-a7d2-449e-980d-0a64b43b1374"],
Cell[1597, 45, 5264, 98, 168, "Input",ExpressionUUID->"74c8ac51-d760-4c36-a9ed-28a896a2135e"],
Cell[6864, 145, 8755, 193, 589, "Input",ExpressionUUID->"837fdd6b-665f-4a70-a365-c9a110e8ea41"],
Cell[15622, 340, 1532, 41, 90, "Input",ExpressionUUID->"6336137a-c6e3-4eb2-9240-216ec84177b0"],
Cell[CellGroupData[{
Cell[17179, 385, 148, 3, 84, "Section",ExpressionUUID->"9fc84298-2069-45ed-8f94-4d52f8cd2d97"],
Cell[CellGroupData[{
Cell[17352, 392, 158, 3, 67, "Subsection",ExpressionUUID->"177ad1ca-52d0-46d0-a8ed-1e9e3480bdf2"],
Cell[17513, 397, 1376, 33, 113, "Input",ExpressionUUID->"945bc2ab-5859-4d77-a4cb-912845d21caa"],
Cell[18892, 432, 11174, 212, 540, "Input",ExpressionUUID->"03f05cf0-4156-4fb6-8b5e-3420f044f9bd"],
Cell[30069, 646, 1889, 39, 142, "Input",ExpressionUUID->"1f63ee48-e781-4802-ba99-a9d38602f239"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31995, 690, 276, 4, 67, "Subsection",ExpressionUUID->"2976eb84-80eb-41a0-ab17-3b4da478e36e"],
Cell[32274, 696, 298, 6, 44, "Text",ExpressionUUID->"ab53e59f-adb5-444c-88ec-c24086fe2d30"],
Cell[32575, 704, 2384, 69, 224, "Input",ExpressionUUID->"a8f9ca12-58b0-451e-bed4-d6ce46f9f65e"],
Cell[34962, 775, 594, 9, 37, "Input",ExpressionUUID->"0551396e-e01a-4918-8c14-24bc779064dd"],
Cell[35559, 786, 12757, 246, 644, "Input",ExpressionUUID->"e2260233-31fb-4cbd-a9e0-7c752c1e1193"],
Cell[48319, 1034, 1573, 32, 116, "Input",ExpressionUUID->"6841312a-675d-4dc8-b742-3ebc715df063"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49929, 1071, 410, 6, 67, "Subsection",ExpressionUUID->"1a6a0035-b322-4d32-803c-111dd1e913c2"],
Cell[CellGroupData[{
Cell[50364, 1081, 164, 3, 56, "Subsubsection",ExpressionUUID->"50ab4e87-9e3b-4cbb-ac24-82b6e29f0b12"],
Cell[50531, 1086, 253, 6, 44, "Text",ExpressionUUID->"21a7886a-f7e8-49a4-854b-751d9400548d"],
Cell[50787, 1094, 8151, 197, 436, "Input",ExpressionUUID->"153b627e-74f2-429b-8222-8de61f3107cf"],
Cell[58941, 1293, 18916, 388, 1508, "Input",ExpressionUUID->"195e1e7f-c876-4aaa-83c0-e5f50580745e"],
Cell[77860, 1683, 1904, 37, 168, "Input",ExpressionUUID->"1d4582f0-3cc9-41b6-84f5-533b7ca9392e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[79813, 1726, 311, 5, 67, "Subsection",ExpressionUUID->"0a374b17-c21c-4189-b6a3-fddfb8174010"],
Cell[80127, 1733, 294, 6, 44, "Text",ExpressionUUID->"6f128a85-3853-47f8-97b2-d4a5ce4a8789"],
Cell[80424, 1741, 24792, 503, 2093, "Input",ExpressionUUID->"bf94f4dd-83fd-4f49-8904-df0f1b5e8b93"],
Cell[105219, 2246, 1777, 35, 168, "Input",ExpressionUUID->"4737278e-917a-4aab-8bd2-1978a844d7fb"]
}, Open  ]]
}, Open  ]]
}
]
*)


(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    565123,      13310]
NotebookOptionsPosition[    538614,      12747]
NotebookOutlinePosition[    539827,      12784]
CellTagsIndexPosition[    539682,      12777]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[" "], "Input",
 CellChangeTimes->{
  3.877517936515574*^9},ExpressionUUID->"4fe4a2a3-ae81-4ad0-a74e-\
dcec2796e3d1"],

Cell["\<\
In  this script we import, downsample and plot a single-particle trajectory \
from LAMMPS. CSV file corresponding to X Y Z (one column each, no header)\
\>", "Text",
 CellChangeTimes->{{3.862571876488153*^9, 
  3.8625719200150127`*^9}},ExpressionUUID->"03adbc2d-a072-48b0-86ee-\
efc6951a1b40"],

Cell[CellGroupData[{

Cell["Import data ", "Section",
 CellChangeTimes->{{3.8656711125039177`*^9, 3.86567111845255*^9}, {
  3.902893279843253*^9, 
  3.902893281432551*^9}},ExpressionUUID->"30cb82fc-9e3a-4fb0-8586-\
6c89b6262d88"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"fileNames", "[", 
      RowBox[{"[", "filenum", "]"}], "]"}], ",", " ", "\"\<Elements\>\""}], 
    "]"}], "see", " ", "what", " ", "you", " ", "can", " ", "ask", " ", "to", 
   " ", 
   RowBox[{"this", " ", ".", "h5"}], " ", "file"}], "*)"}]], "Input",
 CellChangeTimes->{{3.866610557589225*^9, 3.866610582708919*^9}, {
  3.866610707285863*^9, 3.8666107711044273`*^9}, {3.8666110190546303`*^9, 
  3.8666110498077593`*^9}, {3.877528180775013*^9, 3.8775281818215437`*^9}},
 CellLabel->
  "In[338]:=",ExpressionUUID->"cf0d33eb-ca81-4eb9-b55e-f160825e6732"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"fileNames", "[", 
      RowBox[{"[", "filenum", "]"}], "]"}], ",", " ", "\"\<Datasets\>\""}], 
    "]"}], ";", " ", 
   RowBox[{
   "see", " ", "data", " ", "formatting", " ", "and", " ", "how", " ", "to", 
    " ", "extract", " ", "it"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.8666107775383244`*^9, 3.866610816753956*^9}, {
  3.866611018334955*^9, 3.866611030368298*^9}, {3.866702434905813*^9, 
  3.866702447290011*^9}, {3.8775281841169977`*^9, 3.8775281861745663`*^9}},
 CellLabel->
  "In[339]:=",ExpressionUUID->"66f48270-8831-431e-9173-cc0fd5bdb869"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"import", " ", "everything"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"set", " ", "working", " ", "directory"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.800593283259571*^9, 3.800593284410486*^9}, {
   3.800594653158855*^9, 3.8005946538911963`*^9}, {3.862571941776511*^9, 
   3.8625719645711203`*^9}, 3.8625719961837397`*^9, {3.890120070278957*^9, 
   3.8901200718022423`*^9}, {3.902893283517952*^9, 3.9028933077756567`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d2bd30ac-935d-40b9-a082-ec414d259944"],

Cell[BoxData[
 RowBox[{"\n", 
  RowBox[{
   RowBox[{
    RowBox[{"fileNames", " ", "=", 
     RowBox[{"FileNames", "[", "\"\<*.h5\>\"", "]"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"find", " ", 
     RowBox[{"all", " ", ".", "h5"}], " ", "files"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"fileNames", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"i", ",", " ", "1", ",", " ", 
        RowBox[{"Length", "@", "fileNames"}]}], "}"}]}], "]"}], "//", 
    "MatrixForm"}], " ", 
   RowBox[{"(*", 
    RowBox[{"list", " ", "all", " ", "files"}], "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.7106812669968996`*^9, 3.7106812682605076`*^9}, {
   3.7106815000137243`*^9, 3.7106815006689286`*^9}, {3.710827078312729*^9, 
   3.710827078421929*^9}, {3.7190443130990343`*^9, 3.7190443201814346`*^9}, {
   3.723280356658907*^9, 3.72328035738525*^9}, {3.753784476547172*^9, 
   3.7537844767536373`*^9}, 3.753784729226161*^9, 3.780807576095207*^9, 
   3.789471720401086*^9, {3.8216856897011642`*^9, 3.821685773963571*^9}, {
   3.8625720045140133`*^9, 3.862572004869896*^9}, {3.865652494808769*^9, 
   3.865652553874818*^9}, {3.8656711274302387`*^9, 3.8656711276059847`*^9}, {
   3.879389666805839*^9, 3.879389668943859*^9}, {3.902893311153449*^9, 
   3.90289332357474*^9}, {3.902893372459107*^9, 3.9028934055393133`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"c9933fd9-cd5e-4fd6-8356-a8542f1bb35b"],

Cell[TextData[{
 "Please note that the entire code is written to work with the files in this \
order:\n",
 Cell[BoxData[
  RowBox[{"\[IndentingNewLine]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"1", "\"\<4nm_1mol.h5\>\""},
       {"2", "\"\<4nm_24mol.h5\>\""},
       {"3", "\"\<4nm_48mol.h5\>\""},
       {"4", "\"\<6nm_1mol.h5\>\""},
       {"5", "\"\<6nm_40mol.h5\>\""},
       {"6", "\"\<6nm_80mol.h5\>\""},
       {"7", "\"\<9nm_001mol.h5\>\""},
       {"8", "\"\<9nm_050mol.h5\>\""},
       {"9", "\"\<9nm_100mol.h5\>\""},
       {"10", "\"\<ntf2_4nm_1mol.h5\>\""},
       {"11", "\"\<ntf2_4nm_250mol.h5\>\""},
       {"12", "\"\<ntf2_4nm_500mol.h5\>\""},
       {"13", "\"\<ntf2_6nm_1mol.h5\>\""},
       {"14", "\"\<ntf2_6nm_400mol.h5\>\""},
       {"15", "\"\<ntf2_6nm_800mol.h5\>\""},
       {"16", "\"\<ntf2_9nm_0001mol.h5\>\""},
       {"17", "\"\<ntf2_9nm_0500mol.h5\>\""},
       {"18", "\"\<ntf2_9nm_1000mol.h5\>\""},
       {"19", "\"\<z_nsp1_zvalues.h5\>\""},
       {"20", "\"\<zzz_ntf2_nsp1_zvalues.h5\>\""},
       {"21", "\"\<zzzz_nsp1_zvalues_noNTR.h5\>\""}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}]], "Input",
  CellChangeTimes->{{3.902921100766622*^9, 3.902921133321597*^9}},
  ExpressionUUID->"7d2169cc-69ac-49a0-8997-a2635f9d66ab"]
}], "Text",
 CellChangeTimes->{{3.902893407015267*^9, 3.902893424282606*^9}, {
  3.902921079427985*^9, 3.902921083912664*^9}, {3.902921151287039*^9, 
  3.902921165268635*^9}},ExpressionUUID->"ecb09c7d-f9f5-4191-87e5-\
88f7ef1e3dda"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"timeStepKap", " ", "=", " ", "8.535085350853508`*^-8"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timeStepNTF2", " ", "=", " ", "3.414042675533445`*^-8"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.890125171244832*^9, 3.890125193068643*^9}},
 CellLabel->
  "In[357]:=",ExpressionUUID->"e7eef984-1bcd-4805-964d-c1ded4b929ca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Definition",
 Cell[BoxData[
  PaneSelectorBox[{True->
   TemplateBox[{"Function", 
     Cell[
      BoxData[
       FrameBox[
        Cell[
        "Define your function using the name you gave in the Title line \
above. You can add input cells and extra code to define additional input \
cases or prerequisites. All definitions, including dependencies, will be \
included in the generated resource function.\n\nThis section should be \
evaluated before creating the Examples section below.", "MoreInfoText"], 
        Background -> GrayLevel[0.95], FrameMargins -> 20, FrameStyle -> 
        GrayLevel[0.9], RoundingRadius -> 5, ImageSize -> {
          Scaled[0.65], Automatic}]], "MoreInfoText", Deletable -> True, 
      CellTags -> {"SectionMoreInfoFunction"}, 
      CellMargins -> {{66, 66}, {15, 15}}]},
    "MoreInfoOpenerButtonTemplate"]}, Dynamic[
    CurrentValue[
     EvaluationNotebook[], {TaggingRules, "ResourceCreateNotebook"}]],
   ImageSize->Automatic]],ExpressionUUID->
  "07c9f851-a9c2-4e9c-90cb-0a1c5ea590f0"]
}], "Section",
 Editable->False,
 Deletable->False,
 TaggingRules->{"TemplateGroupName" -> "Function"},
 InitializationCell->True,
 DefaultNewCellStyle->"Input",
 CellTags->{"Definition", "Function", "TemplateCellGroup"},
 CellID->72845326,ExpressionUUID->"b0442a9c-2762-4c8a-a4c8-11fd400fa5a9"],

Cell[CellGroupData[{

Cell["General utilities", "Subsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7990547668504066`*^9, 3.7990547708670416`*^9}},
 CellLabel->"In[9]:=",
 CellID->152203748,ExpressionUUID->"c518af0f-915f-4520-90a0-63b217343949"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ListLookup", "[", 
   RowBox[{"expr_", ",", "pos_", ",", "def_", ",", 
    RowBox[{"h_", ":", "Identity"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"h", "@@", 
   RowBox[{"Quiet", "[", 
    RowBox[{"Check", "[", 
     RowBox[{
      RowBox[{"Extract", "[", 
       RowBox[{"expr", ",", "pos", ",", "HoldComplete"}], "]"}], ",", 
      RowBox[{"{", "def", "}"}]}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListLookup", "[", 
   RowBox[{"expr_", ",", 
    RowBox[{"pos", ":", 
     RowBox[{"{", "___List", "}"}]}], ",", "def_", ",", 
    RowBox[{"h_", ":", "Identity"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ListLookup", "[", 
     RowBox[{"expr", ",", "#", ",", "def", ",", "h"}], "]"}], "&"}], "/@", 
   "pos"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ListLookup", "[", 
    RowBox[{"pos_", ",", "def_"}], "]"}], "[", "expr_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"ListLookup", "[", 
   RowBox[{"expr", ",", "pos", ",", "def"}], "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.779965030588372*^9, 3.7799650418090286`*^9}, {
  3.7980307971230297`*^9, 3.798030797777028*^9}},
 CellLabel->"In[17]:=",
 CellID->289096428,ExpressionUUID->"24d7ed57-2698-4b39-9c01-494c217d342f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReverseY", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{"x", ",", 
    RowBox[{"Reverse", "@", "y"}]}], "}"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.779962844209722*^9, 3.779962895354743*^9}, {
   3.7799629326308765`*^9, 3.779962934195877*^9}, {3.7799629939173417`*^9, 
   3.779963106399609*^9}, 3.798030791106065*^9},
 CellLabel->"In[20]:=",
 CellID->306361106,ExpressionUUID->"10e2378d-159c-41bc-97cf-fdc7b088f89b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"AccumulateShifts", "[", 
   RowBox[{"vals_", ",", "shifts_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ReverseY", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FoldList", "[", 
      RowBox[{"Plus", ",", "0", ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Most", "/@", 
       RowBox[{"ReverseY", "@", "vals"}]}], "+", 
      RowBox[{"ReverseY", "@", "shifts"}]}], ")"}]}], "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.779962844209722*^9, 3.779962895354743*^9}, {
  3.7799629326308765`*^9, 3.779962934195877*^9}, {3.7799629939173417`*^9, 
  3.779963114483611*^9}},
 CellLabel->"In[21]:=",
 CellID->58823102,ExpressionUUID->"2287e16d-42db-4595-92f3-ed65300ea569"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"XYLookup", "[", 
    RowBox[{"{", 
     RowBox[{"i_", ",", "j_"}], "}"}], "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", "[", 
     RowBox[{"[", "j", "]"}], "]"}], ",", 
    RowBox[{"y", "[", 
     RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.779962844209722*^9, 3.779962895354743*^9}, {
   3.7799629326308765`*^9, 3.779962934195877*^9}, {3.7799629939173417`*^9, 
   3.7799631179235983`*^9}, 3.7980307938050275`*^9},
 CellLabel->"In[22]:=",
 CellID->923075236,ExpressionUUID->"9251221f-44a0-4cbf-bbe1-567e91cb0b40"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$SidePositions", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"Left", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"Right", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], ",", 
     RowBox[{"Bottom", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"2", ",", "1"}], "}"}]}], ",", 
     RowBox[{"Top", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"2", ",", "2"}], "}"}]}]}], "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$PositionSides", "=", 
   RowBox[{"First", "/@", 
    RowBox[{"PositionIndex", "@", "$SidePositions"}]}]}], ";"}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.779963385834807*^9, 3.7799633858483057`*^9}, {
  3.7980332570989656`*^9, 3.7980332614745913`*^9}},
 CellLabel->"In[23]:=",
 CellID->308709241,ExpressionUUID->"3bc027a0-7fe0-4f40-b837-32cbe8149dce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MapAtHead", "[", "f_", "]"}], "[", 
   RowBox[{"h_", "[", "args___", "]"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MapAtHead", "[", "f", "]"}], "[", "h", "]"}], "[", "args", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MapAtHead", "[", "f_", "]"}], "[", "h_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"f", "[", "h", "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.81436377638216*^9, 3.814363856544777*^9}, {
  3.814421342706485*^9, 3.814421354542801*^9}, {3.814421519381341*^9, 
  3.814421520143899*^9}},
 CellLabel->"In[25]:=",
 CellID->824826724,ExpressionUUID->"d9fad827-d900-448f-9479-d9f7232cfc37"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"HeadPattern", "[", 
   RowBox[{"p_", ",", "n_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Flatten", "[", 
   RowBox[{"p", "|", 
    RowBox[{"Through", "@", 
     RowBox[{
      RowBox[{"HeadPattern", "[", 
       RowBox[{"p", ",", 
        RowBox[{"n", "-", "1"}]}], "]"}], "[", "___", "]"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HeadPattern", "[", 
   RowBox[{"p_", ",", "0"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Alternatives", "[", "p", "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8143638773914146`*^9, 3.8143640052627335`*^9}},
 CellLabel->"In[27]:=",
 CellID->390680010,ExpressionUUID->"c1a6add3-8bed-4f71-9e89-c2c4c4619714"],

Cell[CellGroupData[{

Cell["ApplyStructure", "Subsubsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7990549708810945`*^9, 3.7990549742831593`*^9}},
 CellLabel->"In[13]:=",
 CellID->940642573,ExpressionUUID->"558bdba1-8d51-48ad-b39b-cb8931b05c0e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Attributes", "[", "ThreadOver", "]"}], "=", 
    RowBox[{"{", "HoldAll", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"f", ":", 
     RowBox[{"ThreadOver", "[", 
      RowBox[{"_", ",", "_", ",", "_", ",", "pat_"}], "]"}]}], ")"}], "[", 
   "struct_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"f", "/@", "struct"}], "/;", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"struct", ",", 
     RowBox[{"pat", "[", "___", "]"}]}], "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ThreadOver", "[", 
    RowBox[{"i_", ",", "_", ",", "src_", ",", "_"}], "]"}], "[", "_", "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"src", "[", 
    RowBox[{"[", 
     RowBox[{"++", "i"}], "]"}], "]"}], "/;", 
   RowBox[{"i", "<", 
    RowBox[{"Length", "@", "src"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ThreadOver", "[", 
    RowBox[{"_", ",", "miss_", ",", "_", ",", "_"}], "]"}], "[", "_", "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"miss", "++"}], ";", 
    RowBox[{"Missing", "[", "\"\<NotAvailable\>\"", "]"}]}], 
   ")"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.779963867865508*^9, 3.7799638913150606`*^9}},
 CellLabel->"In[29]:=",
 CellID->732001739,ExpressionUUID->"0eff8c2c-0a3c-408c-909d-aa24c7dfc735"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ApplyStructure", "::", "tooFew"}], "=", 
   "\"\<Missing `` elements while reshaping `` to the structure of ``.\>\""}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyStructure", "::", "tooMany"}], "=", 
    "\"\<`` elements discared while reshaping `` to the structure of \
``.\>\""}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyStructure", "[", "tmpl_", "]"}], "[", "list_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"ApplyStructure", "[", 
   RowBox[{"list", ",", "tmpl"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ApplyStructure", "[", 
   RowBox[{"list_", ",", "tmpl_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ApplyStructure", "[", 
   RowBox[{"list", ",", "tmpl", ",", 
    RowBox[{"Head", "@", "tmpl"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ApplyStructure", "[", 
   RowBox[{"list_", ",", "tmpl_", ",", "head_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"i", "=", "0"}], ",", 
      RowBox[{"miss", "=", "0"}], ",", "res"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"res", "=", 
      RowBox[{
       RowBox[{"ThreadOver", "[", 
        RowBox[{"i", ",", "miss", ",", "list", ",", "head"}], "]"}], "[", 
       "tmpl", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"miss", ">", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "ResourceFunction", "[", "\"\<ResourceFunctionMessage\>\"", "]"}], 
        "[", 
        RowBox[{
         RowBox[{"ApplyStructure", "::", "tooFew"}], ",", "miss", ",", "list",
          ",", "tmpl"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"i", "<", 
        RowBox[{"Length", "@", "list"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "ResourceFunction", "[", "\"\<ResourceFunctionMessage\>\"", "]"}], 
        "[", 
        RowBox[{
         RowBox[{"ApplyStructure", "::", "tooMany"}], ",", 
         RowBox[{
          RowBox[{"Length", "@", "list"}], "-", "i"}], ",", "list", ",", 
         "tmpl"}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "res"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.779963867865508*^9, 3.779963922756705*^9}, {
  3.797325192099761*^9, 3.7973251965897875`*^9}},
 CellLabel->"In[33]:=",
 CellID->301248954,ExpressionUUID->"6e95f046-0028-4960-9c53-14efffff5cf1"]
}, Closed]],

Cell[CellGroupData[{

Cell["GraphicsInfromation", "Subsubsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.799054961718302*^9, 3.7990549652173014`*^9}},
 CellLabel->"In[10]:=",
 CellID->260283402,ExpressionUUID->"88a058cd-0aa3-46bf-876c-2d3eaa228f60"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "GraphicsInformation", " ", "code", " ", "adapted", " ", "from", " ", 
     "Carl", " ", 
     RowBox[{"Woll", "'"}], "s", " ", "answer", " ", 
     RowBox[{"here", ":", " ", "https", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", "a"}], 
      "/", "138907"}], "/", "36508"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ToNotebook", "[", "gr_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Notebook", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"Cell", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"BoxData", "@", 
         RowBox[{"ToBoxes", "@", 
          RowBox[{"InstrumentGraphics", "[", 
           RowBox[{"ExtractGraphics", "/@", "gr"}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", "\"\<Output\>\"", ",", "\[IndentingNewLine]", 
        RowBox[{"ImageSizeMultipliers", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"WindowSize", "\[Rule]", 
      RowBox[{"AbsoluteCurrentValue", "[", 
       RowBox[{
        RowBox[{"EvaluationNotebook", "[", "]"}], ",", "WindowSize"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Evaluator", "\[Rule]", 
      RowBox[{"AbsoluteCurrentValue", "[", 
       RowBox[{
        RowBox[{"EvaluationNotebook", "[", "]"}], ",", "Evaluator"}], 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.779963656837566*^9, 3.7799638416173053`*^9}, {
   3.805270429424494*^9, 3.805270439993357*^9}, {3.813382396629856*^9, 
   3.8133824012174463`*^9}, {3.815417989362851*^9, 3.815417992039462*^9}, {
   3.815418134291247*^9, 3.81541813571274*^9}, {3.8154181907033234`*^9, 
   3.81541821497305*^9}, {3.815455507674116*^9, 3.815455543576297*^9}, {
   3.8619656458445745`*^9, 3.8619656657692046`*^9}, {3.861965739536959*^9, 
   3.86196581324636*^9}, {3.8619660028047047`*^9, 3.8619660288055415`*^9}, {
   3.8619660669725266`*^9, 3.8619660875461884`*^9}, {3.861966126095085*^9, 
   3.861966134538582*^9}, {3.861966168978659*^9, 3.861966187209152*^9}, {
   3.861966251386527*^9, 3.8619662521298895`*^9}, {3.861966654683442*^9, 
   3.8619666548435345`*^9}, {3.8619668670107803`*^9, 3.861966867397111*^9}, {
   3.862035336480254*^9, 3.86203539161086*^9}, {3.862036770528957*^9, 
   3.8620368103972845`*^9}, {3.8620544251561947`*^9, 
   3.8620544261731253`*^9}, {3.862054496737524*^9, 3.862054511697793*^9}, {
   3.8620546873865657`*^9, 3.8620547509334507`*^9}, {3.8620548970826197`*^9, 
   3.8620550026683207`*^9}, {3.862065928696139*^9, 3.8620659304792247`*^9}, {
   3.8621262524352818`*^9, 3.8621263397214556`*^9}, {3.8621266073545494`*^9, 
   3.8621266090720325`*^9}, {3.8621335606067977`*^9, 
   3.8621335625852585`*^9}, {3.862133624420472*^9, 3.8621336330007143`*^9}, 
   3.86213375651901*^9},
 CellLabel->"In[38]:=",
 CellID->690908896,ExpressionUUID->"5e1cb352-d274-4f9a-a758-27f6b59c6496"],

Cell[BoxData[
 RowBox[{"$NormalNotebookSession", ":=", 
  RowBox[{
   RowBox[{"$EvaluationEnvironment", "===", "\"\<Session\>\""}], "&&", 
   RowBox[{"MemberQ", "[", 
    RowBox[{"$CommandLine", ",", "\"\<-wstp\>\""}], "]"}], "&&", 
   RowBox[{"MemberQ", "[", 
    RowBox[{"$CommandLine", ",", "\"\<-linkname\>\""}], "]"}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.86215388881017*^9, 3.862153903600197*^9}, 
   3.8621541512879887`*^9},
 CellLabel->"In[39]:=",
 CellID->713837588,ExpressionUUID->"0290f93d-272f-4acd-9cd2-a278b2ce6390"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SowRange", "[", 
     RowBox[{"k_", ",", "dir_"}], "]"}], "/;", "$NormalNotebookSession"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sow", "[", 
       RowBox[{
        RowBox[{"dir", "\[Rule]", 
         RowBox[{"{", "##", "}"}]}], ",", "k"}], "]"}], ";", "None"}], ")"}], 
    "&"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "if", " ", "we", " ", "are", " ", "not", " ", "in", " ", "a", " ", 
     "normal", " ", "notebook", " ", "session"}], ",", " ", 
    RowBox[{
     RowBox[{"the", " ", "front"}], "-", 
     RowBox[{
     "end", " ", "will", " ", "launch", " ", "a", " ", "separate", " ", 
      "kernel", " ", "to", " ", "evaluate", " ", "the", " ", "GridLines", " ", 
      RowBox[{"specification", ".", " ", "We"}], " ", "thus", " ", "need", 
      " ", "to", " ", "store", " ", "the", " ", "sowed", " ", "data", " ", 
      "in", " ", "a", " ", "variable", " ", "that", " ", "we", " ", "extract",
       " ", "later", " ", "via", " ", "an", " ", "ExportPacket"}], "-", 
     "trick"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SowRange", "[", 
     RowBox[{"k_", ",", "dir_"}], "]"}], "/;", 
    RowBox[{"!", "$NormalNotebookSession"}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SowData", "[", 
        RowBox[{"k", ",", "dir"}], "]"}], "=", 
       RowBox[{"Hold", "@", 
        RowBox[{"Sow", "[", 
         RowBox[{
          RowBox[{"dir", "->", 
           RowBox[{"{", "##", "}"}]}], ",", "k"}], "]"}]}]}], ";", "None"}], 
     ")"}], "&"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InstrumentGraphics", "[", 
   RowBox[{"gr", ":", 
    RowBox[{"{", "__Graphics", "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{"#1", ",", "\[IndentingNewLine]", 
       RowBox[{"GridLines", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"SowRange", "[", 
           RowBox[{"#2", ",", "\"\<x\>\""}], "]"}], ",", 
          RowBox[{"SowRange", "[", 
           RowBox[{"#2", ",", "\"\<y\>\""}], "]"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Annotation", "[", 
           RowBox[{
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"Scaled", "@", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"Scaled", "@", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], ",", "#2", ",", 
            "\"\<pr\>\""}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Annotation", "[", 
           RowBox[{
            RowBox[{"Rectangle", "[", 
             RowBox[{
              RowBox[{"ImageScaled", "@", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"ImageScaled", "@", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], ",", "#2", ",", 
            "\"\<is\>\""}], "]"}]}], "\[IndentingNewLine]", "}"}]}]}], 
      "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", "gr"}],
    "\[IndentingNewLine]", "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBWIQHX5WKnGr5hvH7weMK0B0ydS1xr8i3zhOPfnfBESf
UJ8iX5z5xjHoq5oCiK6as1ogNPeNo5szoyCIfhp4UglEHzn3DUwvaLymCaKt
lO/rgOiYSaVJ6UCarfBTGog+yLY7U/bYG8fguRY5IPqoXmEpiNZ7tLwORKsc
iJwGov8fmzkTRH+Qi58HohOqPi4A87kOLwXRAjYXl4Fo3UD51WD5jWlrQXRe
XM5WEM2n0QKmD927+hxE2/y7BaYDIhKY5IC00tYcMG0Xx19oD6S1ej6Xg2jz
twEqDkC6b5uPJoju+a9y2AOkrssVTJ+ZKX4GRAeFfDsLovfHvXkMoq/cu/sa
RF9aovQPRD9KCuX2BPnPTSzRD0ifD/UH01fe9l7NBtknVv4ARFdEvGbMAdLi
fkpMIPpxlnB6PpAu2BUEpptKePNB9C1WhQIQvXv2hHoQHbVpUwOIXi0jU1AJ
pAWfW7WAaADoMvB9
  "],
 CellLabel->"In[40]:=",
 CellID->820700694,ExpressionUUID->"ece42cca-fc5e-425b-894d-e181b44e7da5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GraphicsObj", "=", 
   RowBox[{"_Graphics", "|", "_Legended"}]}], ";"}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAWIQHX5WKnGr5hvH7weMK0B0ydS1xr8i3zhOPfnfBESf
UJ8iX5z5xjHoq5oCiK6as1ogNPeNo5szoyCIfhp4UglEHzn3DUwvaLymCaKt
lO/rgOiYSaVJ6UCarfBTGog+yLY7U/bYG8fguRY5IPqoXmEpiNZ7tLwORKsc
iJwGov8fmzkTRH+Qi58HohOqPi4A87kOLwXRAjYXl4Fo3UD51WD5jWlrQXRe
XM5WEM2n0QKmD927+hxE2/y7BaYDIhKY5IC00tYcMG0Xx19oD6S1ej6Xg2jz
twEqDkC6b5uPJoju+a9y2AOkrssVTJ+ZKX4GRAeFfDsLovfHvXkMoq/cu/sa
RF9aovQPRD9KCuX2BPnPTSzRD0ifD/UH01fe9l7NBtknVv4ARFdEvGbMAdLi
fkpMIPpxlnB6PpAu2BUEpptKePNB9C1WhQIQvXv2hHoQHbVpUwOIBgAdheib

  "],
 CellLabel->"In[43]:=",
 CellID->916967185,ExpressionUUID->"27d158bb-8e08-472f-b2ce-ce481608afb5"],

Cell[BoxData[
 RowBox[{"$NullMarker", ";"}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAWIQHX5WKnGr5hvH7weMK0B0ydS1xr8i3zhOPfnfBESf
UJ8iX5z5xjHoq5oCiK6as1ogNPeNo5szoyCIfhp4UglEHzn3DUwvaLymCaKt
lO/rgOiYSaVJ6UCarfBTGog+yLY7U/bYG8fguRY5IPqoXmEpiNZ7tLwORKsc
iJwGov8fmzkTRH+Qi58HohOqPi4A87kOLwXRAjYXl4Fo3UD51WD5jWlrQXRe
XM5WEM2n0QKmD927+hxE2/y7BaYDIhKY5IC00tYcMG0Xx19oD6S1ej6Xg2jz
twEqDkC6b5uPJoju+a9y2AOkrssVTJ+ZKX4GRAeFfDsLovfHvXkMoq/cu/sa
RF9aovQPRD9KCuX2BPnPTSzRD0ifD/UH01fe9l7NBtknVv4ARFdEvGbMAdLi
fkpMIPpxlnB6PpAu2BUEpptKePNB9C1WhQIQvXv2hHoQHZD1sgFEAwAch+iA

  "],
 CellLabel->"In[44]:=",
 CellID->737885415,ExpressionUUID->"02de36dc-c868-4ae1-a83e-cad1f47902c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CustomTicksDefinitions", "[", "gr_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Language`ExtendedFullDefinition", "@", 
       RowBox[{"Evaluate", "[", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"$CustomTicks", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Options", "[", 
             RowBox[{
              RowBox[{"ExtractGraphics", "@", "#"}], ",", 
              RowBox[{"{", 
               RowBox[{"FrameTicks", ",", "Ticks", ",", "GridLines"}], 
               "}"}]}], "]"}], "&"}], "/@", "gr"}]}], "\[IndentingNewLine]", 
         "}"}], "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"_", "->", 
       RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "3", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"_", "->", 
     RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "1", "}"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.862156397447381*^9, 3.862156436109503*^9}, {
  3.862211702147539*^9, 3.862211712268488*^9}, {3.8622117693343973`*^9, 
  3.862211770587922*^9}},
 CellLabel->"In[45]:=",
 CellID->922123141,ExpressionUUID->"a8f8d46b-7c45-4793-b941-f4eebe491915"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Graphics", " ", "expression", " ", "to", " ", "inject", " ", "the", " ", 
     "definitions", " ", "of", " ", "custom", " ", "functions", " ", "used", 
     " ", "for", " ", "ticks", " ", "and", " ", "gridlines", " ", "into", " ",
      "the", " ", "graphics"}], "-", 
    RowBox[{
    "rendering", " ", "kernel", " ", "used", " ", "by", " ", "the", " ", 
     "front"}], "-", 
    RowBox[{
    "end", " ", "when", " ", "launched", " ", "from", " ", "a", " ", "script",
      " ", "or", " ", "the", " ", 
     RowBox[{"cloud", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"CustomTicksGraphics", "[", "gr_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"def", "=", 
       RowBox[{"CustomTicksDefinitions", "[", "gr", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Frame", "->", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameTicks", "->", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"None", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Language`ExtendedFullDefinition", "[", "]"}], "=", 
                "def"}], ";", 
               RowBox[{"CustomTicks", "[", "##", "]"}]}], ")"}], "&"}]}], 
           "}"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8621263577606983`*^9, 3.862126471543322*^9}, {
   3.862133576753962*^9, 3.8621335884412727`*^9}, {3.862133783079898*^9, 
   3.8621338090309477`*^9}, {3.8621339468389606`*^9, 
   3.8621339974735384`*^9}, {3.8621488325802083`*^9, 3.8621488355392404`*^9}, 
   3.8621494398080063`*^9, {3.8621564143505282`*^9, 3.862156443473661*^9}},
 CellLabel->"In[46]:=",
 CellID->229041047,ExpressionUUID->"484a5ef1-c80f-421a-b5ad-f5278bff65ac"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "if", " ", "we", " ", "are", " ", "in", " ", "version", " ", "13.0", " ", 
     "or", " ", "later"}], ",", " ", 
    RowBox[{
    "and", " ", "we", " ", "are", " ", "not", " ", "running", " ", "in", " ", 
     "a", " ", "traditional", " ", "notebook", " ", "session"}], ",", " ", 
    RowBox[{
    "use", " ", "AbsoluteOptions", " ", "as", " ", "a", " ", "fallback", " ", 
     "that", " ", "works", " ", "in", " ", "all", " ", "cases", " ", 
     RowBox[{"(", 
      RowBox[{
      "we", " ", "only", " ", "use", " ", "it", " ", "when", " ", "necessary",
        " ", "since", " ", "it", " ", "is", " ", "slower"}], ")"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"GraphicsInformation", "[", 
      RowBox[{"gr", ":", 
       RowBox[{"{", 
        RowBox[{"GraphicsObj", ".."}], "}"}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"$VersionNumber", ">=", "13"}], "&&", 
      RowBox[{"!", "$NormalNotebookSession"}]}]}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Query", "[", "Transpose", "]"}], "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"KeyDrop", "[", "PlotRangePadding", "]"}], "@", 
         RowBox[{"<|", "\[IndentingNewLine]", 
          RowBox[{"#", ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<PlotRangeSize\>\"", "->", 
            RowBox[{
             RowBox[{"#", "[", "ImageSize", "]"}], "-", 
             RowBox[{"Total", "/@", 
              RowBox[{"#", "[", "ImagePadding", "]"}]}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotRange", "->", 
            RowBox[{
             RowBox[{"#", "[", "PlotRange", "]"}], "+", 
             RowBox[{
              RowBox[{"#", "[", "PlotRangePadding", "]"}], 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}]}]}], 
          "\[IndentingNewLine]", "|>"}]}], ")"}], "&"}], "/@", 
      RowBox[{"Association", "/@", "\[IndentingNewLine]", 
       RowBox[{"Rest", "@", 
        RowBox[{"AbsoluteOptions", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Prepend", "[", 
            RowBox[{"CustomTicksGraphics", "[", "gr", "]"}], "]"}], "@", 
           "gr"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
           "ImagePadding", ",", "\[IndentingNewLine]", "ImageSize", ",", 
            "\[IndentingNewLine]", "PlotRange", ",", "\[IndentingNewLine]", 
            "PlotRangePadding"}], "\[IndentingNewLine]", "}"}]}], 
         "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"GraphicsInformation", "[", 
      RowBox[{"gr", ":", 
       RowBox[{"{", 
        RowBox[{"GraphicsObj", ".."}], "}"}]}], "]"}], "/;", "True"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Query", "[", "Transpose", "]"}], "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"Abs", "[", 
           RowBox[{"#is", "-", "#pr"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"Abs", "[", 
           RowBox[{"Subtract", "@@@", "#is"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<PlotRangeSize\>\"", "\[Rule]", 
          RowBox[{"Abs", "[", 
           RowBox[{"Subtract", "@@@", "#pr"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"#x", ",", "#y"}], "}"}]}]}], "\[IndentingNewLine]", 
        "|>"}], "&"}], "/@", "\[IndentingNewLine]", 
      RowBox[{"Values", "@", 
       RowBox[{"KeySort", "@", 
        RowBox[{"<|", "\[IndentingNewLine]", 
         RowBox[{"Last", "@", 
          RowBox[{"Reap", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"see", " ", "comment", " ", "below"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", "$NormalNotebookSession"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"With", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"def", "=", 
                   RowBox[{"CustomTicksDefinitions", "[", "gr", "]"}]}], 
                  "}"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"FrontEndExecute", "@", 
                  RowBox[{"FrontEnd`ExportPacket", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Cell", "@", 
                    RowBox[{"BoxData", "@", 
                    RowBox[{"DynamicBox", "@", 
                    RowBox[{"ToBoxes", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Language`ExtendedFullDefinition", "[", "]"}], 
                    "=", "def"}], ";", "\[IndentingNewLine]", 
                    RowBox[{"Clear", "@", "SowData"}]}], 
                    "\[IndentingNewLine]", "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", "\"\<PlainText\>\""}], 
                   "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
                "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Sow", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", "#2"}], ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "&"}], "@@@", 
              "\[IndentingNewLine]", 
              RowBox[{"Cases", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"\"\<Regions\>\"", "/.", 
                 RowBox[{"FrontEndExecute", "@", 
                  RowBox[{"ExportPacket", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"ToNotebook", "[", "gr", "]"}], ",", 
                    "\[IndentingNewLine]", "\"\<BoundingBox\>\"", ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Verbose", "\[Rule]", "True"}]}], 
                   "\[IndentingNewLine]", "]"}]}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"_", ",", 
                    RowBox[{"\"\<is\>\"", "|", "\"\<pr\>\""}]}], "}"}], ",", 
                  "_"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
                RowBox[{
                "in", " ", "case", " ", "the", " ", "session", " ", "is", " ",
                  "not", " ", "a", " ", "normal", " ", "front"}], "-", 
                RowBox[{"end", " ", "session"}]}], ",", " ", 
               RowBox[{
                RowBox[{
                "we", " ", "have", " ", "to", " ", "get", " ", "the", " ", 
                 "plot", " ", "ranges", " ", "from", " ", "the", " ", 
                 "helper", " ", "kernel", " ", "started", " ", "by", " ", 
                 "the", " ", "front"}], "-", 
                RowBox[{
                "end", " ", "to", " ", "evaluate", " ", "the", " ", 
                 "GridLines", " ", "specification"}]}]}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"!", "$NormalNotebookSession"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ReleaseHold", "@", 
                RowBox[{"Values", "@", 
                 RowBox[{"ToExpression", "@", "\[IndentingNewLine]", 
                  RowBox[{"First", "@", 
                   RowBox[{"FrontEndExecute", "@", 
                    RowBox[{
                    "FrontEnd`ExportPacket", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Cell", "@", 
                    RowBox[{"BoxData", "@", 
                    RowBox[{"DynamicBox", "@", 
                    RowBox[{"ToBoxes", "[", "\[IndentingNewLine]", 
                    RowBox[{"DownValues", "@", "SowData"}], 
                    "\[IndentingNewLine]", "]"}]}]}]}], ",", 
                    "\[IndentingNewLine]", "\"\<PlainText\>\""}], 
                    "\[IndentingNewLine]", "]"}]}]}]}]}]}]}], 
              "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", "_",
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"#", "\[Rule]", 
              RowBox[{"<|", "#2", "|>"}]}], "&"}]}], "\[IndentingNewLine]", 
           "]"}]}], "\[IndentingNewLine]", "|>"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\n", 
   RowBox[{
    RowBox[{"GraphicsInformation", "[", 
     RowBox[{"gr", ":", 
      RowBox[{"GraphicsObj", "|", "Null"}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"First", "/@", 
     RowBox[{"GraphicsInformation", "[", 
      RowBox[{"{", "gr", "}"}], "]"}]}]}], "\n", 
   RowBox[{
    RowBox[{"GraphicsInformation", "[", "gr_List", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"With", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"flat", "=", 
         RowBox[{
          RowBox[{"DeleteCases", "[", "Null", "]"}], "@", 
          RowBox[{"Flatten", "@", "gr"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"struct", "=", 
         RowBox[{"gr", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Null", "\[Rule]", 
             RowBox[{"$NullMarker", "[", "]"}]}], ",", "\[IndentingNewLine]", 
            
            RowBox[{"List", "\[Rule]", "List"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Except", "[", "_List", "]"}], "\[Rule]", "0"}]}], 
           "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ApplyStructure", "[", 
            RowBox[{"#", ",", "struct", ",", 
             RowBox[{"List", "|", "$NullMarker"}]}], "]"}], "/.", 
           RowBox[{
            RowBox[{"$NullMarker", "[", "]"}], "\[Rule]", "Null"}]}], 
          "\[IndentingNewLine]", ")"}], "&"}], "/@", 
        RowBox[{"GraphicsInformation", "[", "flat", "]"}]}], "/;", 
       "\[IndentingNewLine]", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"flat", ",", 
         RowBox[{"{", 
          RowBox[{"GraphicsObj", ".."}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdz1sog3EYBvBtRSGnFKWcPnOYkCIk4UsWJWYsRMPK1hizbA67mEPcLCQZ
LYdcOJVcuJgLLjCHKIfIKeUQSfKtHEJcmP/zv3j79fS+9fSGKbTSWgGPx2PI
wNKDwBqbiGO/1xPboN6ymPhbzrGWPWcS3I0aDmlWc6z0MzIUGscXfGQNHCvO
5vvCx6I9Bm4dflGnus5FMC38NhZWDhkUKqKr7l0JN1xX1UE7HFs8kaqB2/E6
A4y/nzNB4Xr5CHTuWK3wNbhqElYb36Zodt+cgT7px7Mwrihkge6XlIuwUa6x
Qa/oHqr95uwJpv9dUSVl1YJgImPTUDPk3rpMYkzfRytMcUiEWcSB5XwR7HMK
N3NxZ86h7lsD9qG05OsArsm5B3h6c/0CT6aZP3ivkHnk4T+xf00B8UhWSD11
9J/Vo8+/9Q62lb3wNcSAAkYAH+r8VFpi04qU2q331MIrl9AmuDo22AEldc+d
MEzFJrQQ1dG51NRLt9J24kXyfCNURYwZ4Eqvg8qXe5qMxEq7dwdVJjJDvUlM
nf1xs0BlhXkU/gNCsRlS
  "],
 CellLabel->"In[47]:=",
 CellID->292500001,ExpressionUUID->"b72271a1-7b76-42da-8e9c-b482427d21ee"]
}, Closed]],

Cell[CellGroupData[{

Cell["ApplyToWrapped", "Subsubsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.799054943550707*^9, 3.799054947644224*^9}},
 CellLabel->"In[14]:=",
 CellID->760998641,ExpressionUUID->"7a870c63-434f-453c-a835-9754eebf1f7f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ApplyToWrapped", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"Method", "\[Rule]", "Blank"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SyntaxInformation", "[", "ApplyToWrapped", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{"\"\<ArgumentsPattern\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_", ",", "_", ",", "_.", ",", 
        RowBox[{"OptionsPattern", "[", "]"}]}], "}"}]}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyToWrapped", "::", "noMatch"}], "=", 
    "\"\<Expression `` is not a wrapped expression matching ``.\>\""}], ";"}],
   "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyToWrapped", "[", 
    RowBox[{"func_", ",", "expr_", ",", "target_", ",", 
     RowBox[{"extract_", ":", "None"}], ",", 
     RowBox[{"Longest", "[", 
      RowBox[{"OptionsPattern", "[", "]"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"ReleaseHold", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Hold", "@", 
       RowBox[{"IApplyToWrapped", "[", 
        RowBox[{"expr", ",", "target", ",", "extract", ",", 
         RowBox[{"{", "}"}]}], "]"}]}], "//.", "\[IndentingNewLine]", 
      RowBox[{"DownValues", "@", "IApplyToWrapped"}]}], "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"IApplyToWrapped", "[", 
         RowBox[{"e_", ",", "c_"}], "]"}], "\[RuleDelayed]", 
        "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"r", "=", 
            RowBox[{"Which", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"extract", "===", "None"}], ",", "\[IndentingNewLine]", 
              
              RowBox[{"func", "@", "e"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"OptionValue", "@", "Method"}], "===", "Blank"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"func", "[", 
               RowBox[{"e", ",", "c"}], "]"}], ",", "\[IndentingNewLine]", 
              "True", ",", "\[IndentingNewLine]", 
              RowBox[{"With", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{"cf", "=", 
                  RowBox[{
                   RowBox[{"Unevaluated", "@", "c"}], "/.", 
                   RowBox[{
                    RowBox[{"w_", "[", 
                    RowBox[{
                    RowBox[{"Verbatim", "@", "_"}], ",", "rest___"}], "]"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"w", "[", 
                    RowBox[{"#", ",", "rest"}], "]"}], "&"}], ")"}]}]}]}], 
                 "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                RowBox[{"func", "[", 
                 RowBox[{"e", ",", "cf"}], "]"}]}], "\[IndentingNewLine]", 
               "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
            "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"r", "/;", "True"}]}], "\[IndentingNewLine]", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"_Hold", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{"#", ",", 
             RowBox[{"HoldPattern", "@", 
              RowBox[{"IApplyToWrapped", "[", 
               RowBox[{"_", ",", "_", ",", "_", ",", "_"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "\[Infinity]"}], "}"}]}], "]"}], "&"}], 
          ")"}]}], "\[RuleDelayed]", "\[IndentingNewLine]", 
        RowBox[{"Hold", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
           "ResourceFunction", "[", "\"\<ResourceFunctionMessage\>\"", "]"}], 
           "[", 
           RowBox[{
            RowBox[{"ApplyToWrapped", "::", "noMatch"}], ",", 
            RowBox[{"HoldForm", "@", "expr"}], ",", "target"}], "]"}], ";", 
          "\[IndentingNewLine]", "expr"}], "\[IndentingNewLine]", "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Attributes", "[", "IApplyToWrapped", "]"}], "=", 
    RowBox[{"{", "HoldFirst", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IApplyToWrapped", "[", 
    RowBox[{"expr_", ",", "target_", ",", "extract_", ",", "coll_"}], "]"}], "/;",
    "\[IndentingNewLine]", 
   RowBox[{"MatchQ", "[", 
    RowBox[{
     RowBox[{"Unevaluated", "@", "expr"}], ",", "target"}], "]"}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"IApplyToWrapped", "[", 
   RowBox[{"expr", ",", "coll"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"IApplyToWrapped", "[", 
    RowBox[{
     RowBox[{"expr", ":", 
      RowBox[{"w_", "[", 
       RowBox[{"wrapped_", ",", "args___"}], "]"}]}], ",", "target_", ",", 
     RowBox[{"extract", ":", 
      RowBox[{"Except", "[", "None", "]"}]}], ",", 
     RowBox[{"{", "coll___", "}"}]}], "]"}], "/;", "\[IndentingNewLine]", 
   RowBox[{"MatchQ", "[", 
    RowBox[{
     RowBox[{"Unevaluated", "@", "expr"}], ",", "extract"}], "]"}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"IApplyToWrapped", "[", 
   RowBox[{"wrapped", ",", "target", ",", "extract", ",", 
    RowBox[{"{", 
     RowBox[{"coll", ",", 
      RowBox[{"w", "[", 
       RowBox[{"_", ",", "args"}], "]"}]}], "}"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"IApplyToWrapped", "[", 
   RowBox[{
    RowBox[{"w_", "[", 
     RowBox[{"wrapped_", ",", "args___"}], "]"}], ",", "target_", ",", 
    "extract_", ",", "coll_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"w", "[", 
   RowBox[{
    RowBox[{"IApplyToWrapped", "[", 
     RowBox[{"wrapped", ",", "target", ",", "extract", ",", "coll"}], "]"}], 
    ",", "args"}], "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.779964619616859*^9, 3.779964715084844*^9}, {
  3.797325184934828*^9, 3.7973251857078457`*^9}},
 CellLabel->"In[51]:=",
 CellID->796316054,ExpressionUUID->"a81ba905-3353-449e-9c4c-d5d6d13776f0"]
}, Closed]],

Cell[CellGroupData[{

Cell["ThreadWrappers", "Subsubsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.808658069305932*^9, 3.8086580755458784`*^9}},
 CellLabel->"In[9]:=",
 CellID->441622855,ExpressionUUID->"a5d7b2e4-5bc4-485a-84c1-72492f6dfbfe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ThreadWrappers", "[", 
   RowBox[{"expr_", ",", "wrap_", ",", 
    RowBox[{"nmax_", ":", "Infinity"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  
  RowBox[{"iThreadWrappers", "[", 
   RowBox[{"expr", ",", "wrap", ",", "nmax"}], "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.808658184882515*^9, 3.8086581926004143`*^9}, {
  3.808660308381854*^9, 3.808660311008857*^9}, {3.808660420285782*^9, 
  3.8086604228253517`*^9}},
 CellLabel->"In[59]:=",
 CellID->368260565,ExpressionUUID->"2c697aa4-c0b8-4257-93ff-22d938f6f834"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"iThreadWrappers", "[", 
   RowBox[{"expr_", ",", "_", ",", "0"}], "]"}], ":=", "\[IndentingNewLine]", 
  "expr"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iThreadWrappers", "[", 
   RowBox[{"expr_List", ",", "wrap_", ",", "nmax_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"iThreadWrappers", "[", 
     RowBox[{"#", ",", "wrap", ",", 
      RowBox[{"nmax", "-", "1"}]}], "]"}], "&"}], "/@", 
   "expr"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"iThreadWrappers", "[", 
    RowBox[{
     RowBox[{"h_", "[", 
      RowBox[{"expr_List", ",", "args___"}], "]"}], ",", "wrap_", ",", 
     "nmax_"}], "]"}], "/;", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"h", ",", "wrap"}], "]"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"iThreadWrappers", "[", 
     RowBox[{
      RowBox[{"h", "[", 
       RowBox[{"#", ",", "args"}], "]"}], ",", "wrap", ",", 
      RowBox[{"nmax", "-", "1"}]}], "]"}], "&"}], "/@", 
   "expr"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"iThreadWrappers", "[", 
    RowBox[{
     RowBox[{"h_", "[", 
      RowBox[{"expr_", ",", "args___"}], "]"}], ",", "wrap_", ",", "nmax_"}], 
    "]"}], "/;", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"h", ",", "wrap"}], "]"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"proc", "=", 
      RowBox[{"iThreadWrappers", "[", 
       RowBox[{"expr", ",", "wrap", ",", "nmax"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"iThreadWrappers", "[", 
      RowBox[{
       RowBox[{"h", "[", 
        RowBox[{"proc", ",", "args"}], "]"}], ",", "wrap", ",", "nmax"}], 
      "]"}], "/;", 
     RowBox[{"proc", "=!=", "expr"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iThreadWrappers", "[", 
   RowBox[{"expr_", ",", "_", ",", "_"}], "]"}], ":=", "\[IndentingNewLine]", 
  "expr"}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8086580786959105`*^9, 3.8086583947166204`*^9}, {
  3.808660312677908*^9, 3.8086604151086864`*^9}},
 CellLabel->"In[60]:=",
 CellID->926230887,ExpressionUUID->"edeef76b-560e-4fad-b8f0-ac8cf61263ca"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Graphics & Option Utilities", "Subsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7990546942554073`*^9, 3.7990547093575306`*^9}},
 CellLabel->"In[7]:=",
 CellID->616778948,ExpressionUUID->"094c3c56-4c10-4e54-9505-9c20fc53625d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ValidGraphicsQ", "[", 
   RowBox[{"Legended", "[", 
    RowBox[{"expr_", ",", "__"}], "]"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ValidGraphicsQ", "[", "expr", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ValidGraphicsQ", "[", "_Graphics", "]"}], ":=", 
  "\[IndentingNewLine]", "True"}], "\n", 
 RowBox[{
  RowBox[{"ValidGraphicsQ", "[", "_", "]"}], ":=", "\[IndentingNewLine]", 
  "False"}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7799632194678955`*^9, 3.779963219477897*^9}, {
  3.798030801459029*^9, 3.7980308036807227`*^9}},
 CellLabel->"In[65]:=",
 CellID->377657318,ExpressionUUID->"78b231de-e05f-47cd-a007-8c3fe3137008"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExtractGraphics", "[", "gr_Graphics", "]"}], ":=", 
  "\[IndentingNewLine]", "gr"}], "\n", 
 RowBox[{
  RowBox[{"ExtractGraphics", "[", 
   RowBox[{"Legended", "[", 
    RowBox[{"expr_", ",", "__"}], "]"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ExtractGraphics", "[", "expr", "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7799634189587*^9, 3.7799634189661837`*^9}, {
  3.7980307365691147`*^9, 3.798030737599098*^9}, {3.8621490113924723`*^9, 
  3.862149014747757*^9}},
 CellLabel->"In[68]:=",
 CellID->563255732,ExpressionUUID->"9c760c82-0515-4f30-9591-3389ed35aeb1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GraphicsOpt", "[", 
   RowBox[{"g_Graphics", ",", "opt_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"GraphicsOpt", "[", 
   RowBox[{
    RowBox[{"Options", "@", "g"}], ",", "opt"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"GraphicsOpt", "[", 
   RowBox[{"l_Legended", ",", "opt_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"GraphicsOpt", "[", 
   RowBox[{
    RowBox[{"ExtractGraphics", "@", "l"}], ",", "opt"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"GraphicsOpt", "[", 
   RowBox[{"opts_", ",", "opt_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"OptionValue", "[", 
   RowBox[{"Graphics", ",", "opts", ",", "opt"}], "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.779962987291432*^9, 3.7799629873049307`*^9}, {
  3.798030736042097*^9, 3.798030739952098*^9}},
 CellLabel->"In[70]:=",
 CellID->930882098,ExpressionUUID->"5d273c4a-a075-46c8-abaa-afdb387d52f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NormalizeFrameSetting", "[", "val_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Replace", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
     RowBox[{"val", ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"None", "\[Rule]", "False"}], ",", 
        RowBox[{"Automatic", "\[Rule]", "True"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Except", "@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"True", "|", "False"}], ",", "2", ",", "2"}], "]"}]}], 
     "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{"False", ",", "2", ",", "2"}], "]"}]}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7799629441843777`*^9, 3.7799629657102733`*^9}, 
   3.7799634324519944`*^9},
 CellLabel->"In[73]:=",
 CellID->626549822,ExpressionUUID->"2b47f38c-b138-4cf2-a50f-e029acc326ac"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "_", "]"}], "[", 
   RowBox[{"s", ":", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", "s"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "FrameLabel", "]"}], "[", "b_", "]"}],
   ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"None", ",", "None"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "None"}], "}"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "FrameLabel", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"b_", ",", 
     RowBox[{"l_", ":", "None"}], ",", 
     RowBox[{"t_", ":", "None"}], ",", 
     RowBox[{"r_", ":", "None"}], ",", "___"}], "}"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l", ",", "r"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "t"}], "}"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "FrameTicks", "]"}], "[", "a_", "]"}],
   ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "a"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a"}], "}"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "FrameTicks", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"h_", ",", "v_"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", ",", "v"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"h", ",", "h"}], "}"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "FrameStyle", "]"}], "[", 
   RowBox[{"a", ":", 
    RowBox[{"Except", "[", "_List", "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "a"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a"}], "}"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "FrameStyle", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"v_", ",", "h_"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"v", ",", "v"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"h", ",", "h"}], "}"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "FrameStyle", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"b_", ",", "l_", ",", "t_", ",", "r_"}], "}"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"l", ",", "r"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"b", ",", "t"}], "}"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "FrameStyle", "]"}], "[", "_", "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "FrameStyle", "]"}], "[", "None", 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"NormalizeGraphicsOpt", "[", "FrameTicksStyle", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"NormalizeGraphicsOpt", "[", "FrameStyle", "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "Frame", "]"}], "[", "a_", "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"NormalizeFrameSetting", "@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "a"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"a", ",", "a"}], "}"}]}], "}"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "Frame", "]"}], "[", 
   RowBox[{"{", "a_", "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"NormalizeFrameSetting", "@", 
   RowBox[{
    RowBox[{"NormalizeGraphicsOpt", "[", "FrameStyle", "]"}], "[", "True", 
    "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "Frame", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"h_", ",", "v_"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"NormalizeFrameSetting", "@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"v", ",", "v"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"h", ",", "h"}], "}"}]}], "}"}]}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "Frame", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"b_", ",", "l_", ",", "t_", ",", 
     RowBox[{"r_", ":", "True"}]}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"NormalizeFrameSetting", "@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l", ",", "r"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", "t"}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "PlotRange", "]"}], "[", 
   RowBox[{"m_", "?", "NumericQ"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "m"}], ",", "m"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "m"}], ",", "m"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "PlotRange", "]"}], "[", "s_", "]"}], 
  ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s", ",", "s"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s", ",", "s"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "PlotRange", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"min_", ",", "max_"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"min", ",", "max"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Automatic", ",", "Automatic"}], "}"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "\"\<Custom\>\"", "]"}], "[", "a_", 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "a"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"a", ",", "a"}], "}"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "\"\<Custom\>\"", "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"h_", ",", "v_"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"h", ",", "h"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"v", ",", "v"}], "}"}]}], "}"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7799629441843777`*^9, 3.7799629657102733`*^9}, {
  3.7799634324519944`*^9, 3.7799634603269825`*^9}, {3.8070049505351424`*^9, 
  3.807005071398795*^9}, {3.807014092376956*^9, 3.807014113005125*^9}},
 CellLabel->"In[74]:=",
 CellID->534234148,ExpressionUUID->"3ea0a306-100d-41a1-be33-9bdcf2508239"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NormalizedOptionValue", "[", 
   RowBox[{"g_", ",", "opt_List"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"NormalizedOptionValue", "[", 
     RowBox[{"g", ",", "#"}], "]"}], "&"}], "/@", "opt"}]}], "\n", 
 RowBox[{
  RowBox[{"NormalizedOptionValue", "[", 
   RowBox[{"g_", ",", "opt_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NormalizeGraphicsOpt", "[", "opt", "]"}], "[", 
   RowBox[{"GraphicsOpt", "[", 
    RowBox[{"g", ",", "opt"}], "]"}], "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7799629441843777`*^9, 3.7799629657102733`*^9}, {
  3.7799634324519944`*^9, 3.779963465252315*^9}},
 CellLabel->"In[93]:=",
 CellID->721367411,ExpressionUUID->"8f6ab0be-bbad-429d-8fbb-a8ef0eacf5ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotateGraphicsOpt", "[", 
     RowBox[{"_", ",", "ang_"}], "]"}], "[", 
    RowBox[{"s", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"_", ",", "_"}], "}"}]}], "}"}]}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{"ang", ",", 
      RowBox[{"2", "\[Pi]"}]}], "]"}], "\[Equal]", "0"}]}], ":=", 
  "\[IndentingNewLine]", "s"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotateGraphicsOpt", "[", 
     RowBox[{"opt_", ",", "ang_"}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l_", ",", "r_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b_", ",", "t_"}], "}"}]}], "}"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{"ang", ",", 
      RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "\[Equal]", "0"}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RotateGraphicsOpt", "[", 
    RowBox[{"opt", ",", 
     RowBox[{"ang", "-", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "]"}], "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t", ",", "b"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "r"}], "}"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RotateGraphicsOpt", "[", 
     RowBox[{
      RowBox[{"opt", ":", "PlotRange"}], ",", "ang_"}], "]"}], "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"l_", ",", "r_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"b_", ",", "t_"}], "}"}]}], "}"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{"ang", ",", 
      RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "\[Equal]", "0"}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RotateGraphicsOpt", "[", 
    RowBox[{"opt", ",", 
     RowBox[{"ang", "-", 
      RowBox[{"\[Pi]", "/", "2"}]}]}], "]"}], "[", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"t", ",", "b"}], "}"}], ",", 
       RowBox[{
        RowBox[{"lim_", "?", "NumericQ"}], "\[RuleDelayed]", 
        RowBox[{"-", "lim"}]}], ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "r"}], "}"}]}], "}"}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8070053512204647`*^9, 3.807005384186892*^9}, {
  3.8070054175713773`*^9, 3.8070055255889654`*^9}, {3.8070056650042863`*^9, 
  3.8070057344708323`*^9}, {3.8070058155132117`*^9, 3.807005841838746*^9}, {
  3.807006354038785*^9, 3.807006366415668*^9}},
 CellLabel->"In[95]:=",
 CellID->108847668,ExpressionUUID->"2c15302b-0ecd-46d3-bc44-00d0335df4fc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Tick utilities", "Subsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.799054725991536*^9, 3.7990547302565393`*^9}},
 CellLabel->"In[34]:=",
 CellID->565806496,ExpressionUUID->"0d8ff6df-dcab-4ffc-8fda-901aa54ea82f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NormalizeTickSpec", "[", 
   RowBox[{"tick", ":", 
    RowBox[{"{", 
     RowBox[{"_", ",", "_", ",", 
      RowBox[{"{", 
       RowBox[{"_", ",", "_"}], "}"}], ",", "_"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", "tick"}], "\n", 
 RowBox[{
  RowBox[{"NormalizeTickSpec", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "lbl_", ",", "len_", ",", "sty_"}], "}"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{"x", ",", "lbl", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"len", ",", "len"}], "}"}], "/", "2"}], ",", "sty"}], 
   "}"}]}], "\n", 
 RowBox[{
  RowBox[{"NormalizeTickSpec", "[", 
   RowBox[{"{", 
    RowBox[{"x_", ",", "lbl_", ",", 
     RowBox[{"len_", ":", "0.00625"}]}], "}"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"NormalizeTickSpec", "@", 
   RowBox[{"{", 
    RowBox[{"x", ",", "lbl", ",", "len", ",", 
     RowBox[{"{", "}"}]}], "}"}]}]}], "\n", 
 RowBox[{
  RowBox[{"NormalizeTickSpec", "[", "x_", "]"}], ":=", "\[IndentingNewLine]", 
  
  RowBox[{"NormalizeTickSpec", "@", 
   RowBox[{"{", 
    RowBox[{"x", ",", "x"}], "}"}]}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.797752840431677*^9, 3.7977528761370068`*^9}},
 CellLabel->"In[98]:=",
 CellID->694794920,ExpressionUUID->"bee9791a-4218-42ec-8d8e-d9cba2ef404a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$BuiltinTickSpecs", "=", 
   RowBox[{
   "Automatic", "|", "None", "|", "False", "|", "True", "|", "All"}]}], 
  ";"}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7979222622706523`*^9, 3.7979222762747273`*^9}, {
  3.798544517616776*^9, 3.7985445194117756`*^9}},
 CellLabel->"In[102]:=",
 CellID->297140442,ExpressionUUID->"54860345-4ea1-43ff-98f3-c9b3ff9e78df"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"HideTickLabels", "[", 
   RowBox[{"t", ":", "$BuiltinTickSpecs"}], "]"}], ":=", 
  "\[IndentingNewLine]", "t"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HideTickLabels", "[", "ticks_List", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"#", ",", 
      RowBox[{"Spacer", "@", "0"}], ",", "##3"}], "}"}], "&"}], "@@@", 
   RowBox[{"NormalizeTickSpec", "/@", "ticks"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HideTickLabels", "[", "f_", "]"}], "[", "lims__", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"HideTickLabels", "[", 
   RowBox[{"f", "@", "lims"}], "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.79792194620383*^9, 3.7979220757196865`*^9}, {
   3.7979221117260766`*^9, 3.7979221315041275`*^9}, {3.797922192738658*^9, 
   3.797922202409917*^9}, 3.797922284142683*^9, {3.797922435158769*^9, 
   3.797922437681769*^9}, {3.7980307284230976`*^9, 3.798030731383127*^9}},
 CellLabel->"In[103]:=",
 CellID->940807826,ExpressionUUID->"23377df4-4951-4b36-9d1c-11825f259607"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ScaleFrameTicks", "[", "_", "]"}], "[", 
   RowBox[{"t", ":", "$BuiltinTickSpecs"}], "]"}], ":=", 
  "\[IndentingNewLine]", "t"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScaleFrameTicks", "[", "s_", "]"}], "[", "ticks_List", "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"#", ",", "#2", ",", 
      RowBox[{"s", "#3"}], ",", "#4"}], "}"}], "&"}], "@@@", 
   RowBox[{"NormalizeTickSpec", "/@", "ticks"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScaleFrameTicks", "[", "s_", "]"}], "[", "fun_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"ScaleFrameTicks", "[", 
   RowBox[{"s", ",", "fun"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScaleFrameTicks", "[", 
    RowBox[{"s_", ",", "fun_"}], "]"}], "[", "lims__", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ScaleFrameTicks", "[", "s", "]"}], "[", 
   RowBox[{"fun", "@", "lims"}], "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7977525218470755`*^9, 3.7977525862784643`*^9}, {
   3.7977526430478888`*^9, 3.797752677378771*^9}, {3.797752986643782*^9, 
   3.7977530027733717`*^9}, {3.797753086287736*^9, 3.79775310655532*^9}, {
   3.7977531517178736`*^9, 3.797753242414975*^9}, {3.797922310655596*^9, 
   3.797922312502621*^9}, {3.7980308522692747`*^9, 3.7980308555303316`*^9}, {
   3.8144225587237797`*^9, 3.814422573296615*^9}, {3.8621366746920633`*^9, 
   3.862136745129768*^9}, {3.862160244772989*^9, 3.862160247925277*^9}, {
   3.862160395859122*^9, 3.862160396055778*^9}, {3.867255701811925*^9, 
   3.867255729514927*^9}, {3.867255769762926*^9, 3.8672557717469263`*^9}, 
   3.8672560859749684`*^9},
 CellLabel->"In[106]:=",
 CellID->248472887,ExpressionUUID->"d6ade48e-643a-4e6f-a42e-3067040ff730"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "put", " ", "this", " ", "into", " ", "a", " ", "new", " ", "version", " ",
     "so", " ", "that", " ", "plots", " ", "created", " ", "with", " ", "the",
     " ", "old", " ", "version", " ", "still", " ", "work", " ", 
    RowBox[{"(", 
     RowBox[{
     "at", " ", "least", " ", "they", " ", "should", " ", "produce", " ", 
      "red", " ", "boxes"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ScaleFrameTicksV2", "[", 
      RowBox[{"_", ",", "_"}], "]"}], "[", 
     RowBox[{"t", ":", "$BuiltinTickSpecs"}], "]"}], ":=", 
    "\[IndentingNewLine]", "t"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ScaleFrameTicksV2", "[", 
      RowBox[{"s_", ",", "sp_"}], "]"}], "[", "ticks_List", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"#", ",", "#2", ",", 
        RowBox[{
         RowBox[{"s", " ", "/", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"$VersionNumber", "<", "13"}], ",", "sp", ",", "1"}], 
           "]"}]}], "#3"}], ",", "#4"}], "}"}], "&"}], "@@@", 
     RowBox[{"NormalizeTickSpec", "/@", "ticks"}]}]}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"ScaleFrameTicksV2", "[", 
      RowBox[{"s_", ",", "sp_"}], "]"}], "[", "fun_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"ScaleFrameTicksV2", "[", 
     RowBox[{"s", ",", "sp", ",", "fun"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ScaleFrameTicksV2", "[", 
      RowBox[{"s_", ",", "sp_", ",", "fun_"}], "]"}], "[", "lims__", "]"}], ":=",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ScaleFrameTicksV2", "[", 
      RowBox[{"s", ",", "sp"}], "]"}], "[", 
     RowBox[{"fun", "@", "lims"}], "]"}]}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8672558073156834`*^9, 3.8672558100746846`*^9}, {
  3.867256095012129*^9, 3.867256144758113*^9}},
 CellLabel->"In[110]:=",
 CellID->382795528,ExpressionUUID->"2a8a3a68-f7ac-4969-beb1-0d0b2bd4960c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LoadScaledTicks", "[", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Charting`ScaledTicks", "[", 
      RowBox[{"{", 
       RowBox[{"Identity", ",", "Identity"}], "}"}], "]"}], "[", 
     RowBox[{"0", ",", "1"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LoadScaledTicks", "[", "]"}], "=", "Null"}], ";"}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7990826522143483`*^9, 3.799082705954811*^9}},
 CellLabel->"In[114]:=",
 CellID->382204180,ExpressionUUID->"a397b754-136b-41ef-a41f-8fa72ad45d47"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CustomTicks", "[", "limits__", "]"}], ":=", "\[IndentingNewLine]", 
  
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"rLimits", "=", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"{", "limits", "}"}], ",", 
        RowBox[{"10.", "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Round", "@", 
            RowBox[{"Log10", "[", 
             RowBox[{"-", 
              RowBox[{"Subtract", "[", "limits", "]"}]}], "]"}]}], "-", "4"}],
           ")"}]}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"LoadScaledTicks", "[", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Internal`InheritedBlock", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "Charting`SimplePadding", ",", 
           "Charting`CommonDump`simplePadding"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Fix", " ", "for", " ", "0", " ", "tick", " ", "label", " ", "not", 
           " ", "having", " ", "same", " ", "number", " ", "of", " ", 
           "decimal", " ", "places", " ", "as", " ", "other", " ", "labels", 
           " ", "in", " ", "Charting`ScaledTicks"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Put", " ", "any", " ", "zeroes", " ", "from", " ", "the", " ", 
            "list", " ", "of", " ", "zeros", " ", "to", " ", "the", " ", 
            "list", " ", "of", " ", "medium", " ", "numbers", " ", "This", 
            " ", "causes", " ", "zeros", " ", "to", " ", "be", " ", "printed",
             " ", "with", " ", "the", " ", "same", " ", "number", " ", "of", 
            " ", "decimal", " ", "places", " ", "as", " ", "those", " ", 
            "numbers", " ", "simplePadding", " ", "is", " ", "patched", " ", 
            "below", " ", "to", " ", "properly", " ", "handle", " ", "zeros", 
            " ", "Since", " ", 
            RowBox[{"simplePadding", "[", 
             RowBox[{"\"\<Medium\>\"", ",", 
              RowBox[{"{", "0.", "}"}], ",", "..."}], "]"}], " ", "returns", 
            " ", 
            RowBox[{"{", "0", "}"}]}], ",", 
           RowBox[{"this", " ", 
            RowBox[{"doesn", "'"}], "t", " ", "break", " ", "the", " ", 
            "case", " ", "where", " ", "there", " ", "are", " ", "no", " ", 
            "medium", " ", "numbers"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Unprotect", "@", "Charting`SimplePadding"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DownValues", "[", "Charting`SimplePadding", "]"}], "=", 
           RowBox[{
            RowBox[{"DownValues", "[", "Charting`SimplePadding", "]"}], "/.", 
            
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"HoldPattern", "[", 
                RowBox[{
                 RowBox[{"z", ":", "Charting`CommonDump`zero"}], "=", "_"}], 
                "]"}], "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"z", "=", 
                 RowBox[{"{", "}"}]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{"HoldPattern", "[", 
                RowBox[{
                 RowBox[{"m", ":", "Charting`CommonDump`medium"}], "=", 
                 RowBox[{"Select", "[", 
                  RowBox[{"l_", ",", 
                   RowBox[{"c_", "&"}]}], "]"}]}], "]"}], "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"m", "=", 
                 RowBox[{"Select", "[", 
                  RowBox[{"l", ",", 
                   RowBox[{
                    RowBox[{"c", "||", 
                    RowBox[{"PossibleZeroQ", "@", "#"}]}], "&"}]}], "]"}]}], 
                ")"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Chop", " ", "0.", " ", "to", " ", "0", " ", "in", " ", 
            "MantissaExponent", " ", "calls", " ", "in", " ", 
            RowBox[{"simplePadding", "[", 
             RowBox[{"\"\<Medium\>\"", ",", "..."}], "]"}], " ", "to", " ", 
            "prevent", " ", 
            RowBox[{"errors", "/", "broken"}], " ", "formatting"}], "*)"}], 
          RowBox[{
           RowBox[{
           "DownValues", "[", "Charting`CommonDump`simplePadding", "]"}], "=", 
           RowBox[{
            RowBox[{
            "DownValues", "[", "Charting`CommonDump`simplePadding", "]"}], "/.", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"HoldPattern", "[", 
                RowBox[{"MantissaExponent", "[", 
                 RowBox[{"l_", ",", "10"}], "]"}], "]"}], "\[RuleDelayed]", 
               RowBox[{"MantissaExponent", "[", 
                RowBox[{
                 RowBox[{"Chop", "@", "l"}], ",", "10"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"HoldPattern", "@", 
                RowBox[{"NumberForm", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"{", 
                   RowBox[{"Infinity", ",", "d_"}], "}"}]}], "]"}]}], 
               "\[RuleDelayed]", 
               RowBox[{"NumberForm", "[", 
                RowBox[{
                 RowBox[{"N", "@", "#"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Infinity", ",", "d"}], "}"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Charting`ScaledTicks", "[", 
            RowBox[{"{", 
             RowBox[{"Identity", ",", "Identity"}], "}"}], "]"}], "@@", 
           "rLimits"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{"Not", "@*", 
              RowBox[{"Between", "[", 
               RowBox[{"{", "limits", "}"}], "]"}]}], ")"}]}], ",", "_Spacer",
            ",", "__"}], "}"}], "\[RuleDelayed]", "Nothing"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x_", ",", 
           RowBox[{"lbl", ":", 
            RowBox[{"Except", "@", "_Spacer"}]}], ",", "rest__"}], "}"}], 
         "\[RuleDelayed]", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Clip", "[", 
            RowBox[{"x", ",", 
             RowBox[{"Sort", "@", 
              RowBox[{"{", "limits", "}"}]}]}], "]"}], ",", 
           RowBox[{"ToString", "[", 
            RowBox[{"lbl", ",", "TraditionalForm"}], "]"}], ",", "rest"}], 
          "}"}]}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]",
       "1"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7980302951766977`*^9, 3.7980303014863567`*^9}, {
   3.7990818845376043`*^9, 3.799082005301536*^9}, {3.799082046785945*^9, 
   3.799082051595951*^9}, {3.799082155210552*^9, 3.7990821780280943`*^9}, {
   3.7990822222050233`*^9, 3.7990822231894026`*^9}, {3.7990822981660833`*^9, 
   3.7990823222328987`*^9}, 3.7990823836390357`*^9, {3.7990824163322706`*^9, 
   3.7990824183462334`*^9}, {3.7990824601963434`*^9, 
   3.7990824938113956`*^9}, {3.7990826051131277`*^9, 3.799082679659447*^9}, {
   3.7990829170599494`*^9, 3.7990829394934664`*^9}, {3.7990830617053385`*^9, 
   3.799083128178975*^9}, {3.7990832392575626`*^9, 3.7990832487038846`*^9}, {
   3.7990832838799925`*^9, 3.7990832842059927`*^9}, {3.807007949241151*^9, 
   3.8070079496682024`*^9}},
 CodeAssistOptions->{
 "CodeToolsOptions"-><|
  "CodeInspect" -> <|
    "Tags" -> <|"UnscopedObjectError" -> <|Enabled -> False|>|>|>|>},
 CellLabel->"In[115]:=",
 CellID->601058855,ExpressionUUID->"ee8996e0-25ee-47dd-b4a9-5a8d748eb716"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CustomTicksNoLabels", "[", "limits__", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"#", ",", 
      RowBox[{"Spacer", "@", "0"}], ",", "##3"}], "}"}], "&"}], "@@@", 
   RowBox[{"CustomTicks", "[", "limits", "]"}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7990711750980124`*^9, 3.799071205519923*^9}},
 CellLabel->"In[116]:=",
 CellID->450571210,ExpressionUUID->"777b740f-b4af-4f35-a2ad-2a79da91aaca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "replace", " ", "Scaled", " ", "with", " ", "\"\<Scaled\>\"", " ", "to", 
    " ", "prevent", " ", "issues", " ", "with", " ", "Graphics", " ", 
    "typesetting"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"\"\<Scaled\>\"", ";"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7987320948189945`*^9, 3.798732096408928*^9}, {
  3.798732147785406*^9, 3.798732162855428*^9}, {3.815455286433029*^9, 
  3.815455288030032*^9}},
 CellLabel->"In[117]:=",
 CellID->932096797,ExpressionUUID->"cb03ab3e-c562-447d-a949-0bf276eedbc2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"HideOuterLabels", "[", 
   RowBox[{"_", ",", "_", ",", "_", ",", 
    RowBox[{"None", "|", "False"}]}], "]"}], ":=", 
  "None"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HideOuterLabels", "[", 
   RowBox[{"_", ",", "_", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "\[Infinity]"}], ",", 
      RowBox[{"-", "\[Infinity]"}]}], "}"}], ",", "t_"}], "]"}], ":=", 
  "t"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HideOuterLabels", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"_", ",", "2"}], "}"}], ",", "size_", ",", "thres_", ",", 
    RowBox[{"t", ":", 
     RowBox[{"Automatic", "|", "True"}]}]}], "]"}], ":=", 
  "\[IndentingNewLine]", "t"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HideOuterLabels", "[", 
   RowBox[{"side_", ",", "size_", ",", "thres_", ",", 
    RowBox[{"Automatic", "|", "True", "|", "All"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"HideOuterLabels", "[", 
   RowBox[{"side", ",", "size", ",", "thres", ",", "CustomTicks"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HideOuterLabels", "[", 
    RowBox[{"side_", ",", "size_", ",", "thres_", ",", "ticks_List"}], "]"}], 
   "[", 
   RowBox[{"min_", ",", "max_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"t", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"max", "-", "min"}], ")"}], 
       RowBox[{"Replace", "[", "\[IndentingNewLine]", 
        RowBox[{"thres", ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"\"\<Scaled\>\"", "@", "thr_"}], "\[RuleDelayed]", 
            "thr"}], " ", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"thr_", "?", "NumericQ"}], "\[RuleDelayed]", 
            RowBox[{"thr", "/", 
             RowBox[{"size", "\[LeftDoubleBracket]", 
              RowBox[{"3", "-", 
               RowBox[{
               "side", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}]}]}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", "1"}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NormalizeTickSpec", "/@", "ticks"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x_", ",", "lbl_", ",", "rest__"}], "}"}], "/;", 
        RowBox[{"!", 
         RowBox[{
          RowBox[{"min", "+", 
           RowBox[{
           "t", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          "\[LessEqual]", "x", "\[LessEqual]", 
          RowBox[{"max", "-", 
           RowBox[{
           "t", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}]}]}]}]}], "\[RuleDelayed]", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"Spacer", "@", "0"}], ",", "rest"}], "}"}]}], ",", 
      "\[IndentingNewLine]", "1"}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HideOuterLabels", "[", 
    RowBox[{"side_", ",", "size_", ",", "thres_", ",", "f_"}], "]"}], "[", 
   "lims__", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"HideOuterLabels", "[", 
    RowBox[{"side", ",", "size", ",", "thres", ",", 
     RowBox[{"f", "@", "lims"}]}], "]"}], "[", "lims", "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7980297923570395`*^9, 3.7980298059156184`*^9}, {
   3.7980303579708166`*^9, 3.7980307537443037`*^9}, {3.7980308727002263`*^9, 
   3.7980311650664983`*^9}, {3.7980312322437162`*^9, 
   3.7980313043153872`*^9}, {3.798031649560438*^9, 3.798031661544106*^9}, {
   3.798032106863448*^9, 3.798032119017459*^9}, {3.798722960125349*^9, 
   3.7987229827705765`*^9}, {3.7987241362166204`*^9, 
   3.7987241546550837`*^9}, {3.798724368679387*^9, 3.798724368874379*^9}, {
   3.7987244134230766`*^9, 3.7987244188670874`*^9}, {3.7987305889570136`*^9, 
   3.7987305896190166`*^9}, {3.798730704476637*^9, 3.7987307126522665`*^9}, {
   3.798730934993772*^9, 3.7987309353937716`*^9}, {3.7987321683009257`*^9, 
   3.798732169267927*^9}, {3.7987322721017075`*^9, 3.7987322749477477`*^9}, {
   3.7987323188131723`*^9, 3.7987323192501693`*^9}, {3.798732568034522*^9, 
   3.7987325687475176`*^9}, {3.799081001155945*^9, 3.799081002132945*^9}, 
   3.8154552888840303`*^9, {3.815455332241846*^9, 3.8154553646130075`*^9}},
 CellLabel->"In[118]:=",
 CellID->740530040,ExpressionUUID->"1022629a-9a8f-44fc-acdc-5901f81434d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"EnsureCustomTicks", "[", 
   RowBox[{"_", ",", 
    RowBox[{"None", "|", "False"}]}], "]"}], ":=", 
  "None"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EnsureCustomTicks", "[", 
   RowBox[{"_", ",", "All"}], "]"}], ":=", 
  "CustomTicks"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EnsureCustomTicks", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"_", ",", "1"}], "}"}], ",", 
    RowBox[{"Automatic", "|", "True"}]}], "]"}], ":=", 
  "CustomTicks"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EnsureCustomTicks", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"_", ",", "2"}], "}"}], ",", 
    RowBox[{"Automatic", "|", "True"}]}], "]"}], ":=", 
  "CustomTicksNoLabels"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EnsureCustomTicks", "[", 
   RowBox[{"_", ",", "t_"}], "]"}], ":=", "t"}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.799071283583649*^9, 3.7990713909484057`*^9}, {
  3.7990717765464954`*^9, 3.7990717853477616`*^9}, {3.7990718528794765`*^9, 
  3.799071857276989*^9}, {3.8143541267789917`*^9, 3.8143541413440022`*^9}},
 CellLabel->"In[124]:=",
 CellID->54921205,ExpressionUUID->"23385f9f-850f-4ab5-994f-895067d2e23a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$ModifiedDefaultTickPattern", "=", 
   RowBox[{
    RowBox[{"Hold", "[", "EnsureCustomTicks", "]"}], "[", 
    RowBox[{"_", ",", 
     RowBox[{"HideOuterLabels", "[", 
      RowBox[{"_", ",", "_", ",", "_", ",", "CustomTicks"}], "]"}]}], "]"}]}],
   ";"}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7990727183883305`*^9, 3.7990727285455194`*^9}, {
  3.7990727592297945`*^9, 3.799072788671496*^9}},
 CellLabel->"In[129]:=",
 CellID->821709349,ExpressionUUID->"e9095644-efbc-422e-b9cc-9116e38a1131"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CustomTicks", "=", 
   RowBox[{
   "HideTickLabels", "|", "ScaleFrameTicks", "|", "ScaleFrameTicksV2", "|", 
    "CustomTicks", "|", "CustomTicksNoLabels", "|", "HideOuterLabels"}]}], 
  ";"}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.814354347558729*^9, 3.8143543515280933`*^9}, 
   3.8672558439316845`*^9, {3.8672578764027944`*^9, 3.867257879314795*^9}},
 CellLabel->"In[130]:=",
 CellID->904915662,ExpressionUUID->"d019e7dc-7688-41ad-8a94-82ff0dc902fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CustomTicksNames", "=", 
   RowBox[{"SymbolName", "/@", "$CustomTicks"}]}], ";"}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.814356527583092*^9, 3.8143565774293222`*^9}, {
  3.8143567039258375`*^9, 3.814356726188115*^9}, {3.81442892158393*^9, 
  3.8144289649905434`*^9}},
 CellLabel->"In[131]:=",
 CellID->940433468,ExpressionUUID->"3f9a98e7-9063-474e-930f-2b71b172e561"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$CustomTicksAssoc", "=", 
   RowBox[{"AssociationThread", "[", 
    RowBox[{
     RowBox[{"List", "@@", "$CustomTicksNames"}], "\[Rule]", 
     RowBox[{"List", "@@", "$CustomTicks"}]}], "]"}]}], ";"}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.814429080699253*^9, 3.8144291055544586`*^9}},
 CellLabel->"In[132]:=",
 CellID->720206912,ExpressionUUID->"ed5d81b8-0a91-41a9-b0c4-2de19fb1eb79"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TransformCustomTicksHeads", "[", 
    RowBox[{"f_", ",", "p_", ",", "t_"}], "]"}], "/;", 
   RowBox[{"MatchQ", "[", 
    RowBox[{"t", ",", "p"}], "]"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MapAtHead", "[", "f", "]"}], "@", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{"t", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"h_", "[", 
       RowBox[{"args___", ",", 
        RowBox[{"t2", ":", "p"}]}], "]"}], "\[RuleDelayed]", 
      "\[IndentingNewLine]", 
      RowBox[{"h", "[", 
       RowBox[{"args", ",", 
        RowBox[{"TransformCustomTicksHeads", "[", 
         RowBox[{"f", ",", "p", ",", "t2"}], "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.814422091235033*^9, 3.814422128642183*^9}, {
  3.814422188940997*^9, 3.8144223288322144`*^9}, {3.814422597967969*^9, 
  3.814422626276991*^9}, {3.8144226771660843`*^9, 3.814422684057086*^9}, {
  3.8144227960561924`*^9, 3.814422820669071*^9}, {3.8144228529720984`*^9, 
  3.814422857341468*^9}, {3.814428604260352*^9, 3.814428604508628*^9}, {
  3.8144286782060475`*^9, 3.8144287293997726`*^9}, {3.814428776973569*^9, 
  3.8144287837542276`*^9}, {3.81442900527166*^9, 3.814429048560129*^9}},
 CellLabel->"In[133]:=",
 CellID->142680264,ExpressionUUID->"55993401-a502-4cb3-b4fc-121dfa8b2f04"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "force", " ", "the", " ", "resource", " ", "function", " ", "to", " ", 
    "be", " ", "loaded", " ", "before", " ", "evaluating", " ", "ticks", " ", 
    "by", " ", "redirecting", " ", "ticks", " ", "functions", " ", "over", 
    " ", 
    RowBox[{"ResourceFunction", "[", "\"\<PlotGrid\>\"", "]"}]}], " ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"InjectCustomTicksLoading", "[", "expr_", "]"}], "/;", 
     "$NormalNotebookSession"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"expr", "/.", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"t", ":", 
       RowBox[{"HeadPattern", "[", 
        RowBox[{"$CustomTicks", ",", "1"}], "]"}]}], "\[RuleDelayed]", 
      "\[IndentingNewLine]", 
      RowBox[{"With", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "convert", " ", "tick", " ", "symbols", " ", "to", " ", "strings", 
         " ", "to", " ", "ensure", " ", "they", " ", "work", " ", "across", 
         " ", "different", " ", "versions", " ", "of", " ", "PlotGrid"}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"f", "=", 
          RowBox[{"TransformCustomTicksHeads", "[", 
           RowBox[{"SymbolName", ",", 
            RowBox[{"HeadPattern", "[", 
             RowBox[{"$CustomTicks", ",", "1"}], "]"}], ",", "t"}], "]"}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ResourceFunction", "[", "\"\<PlotGrid\>\"", "]"}], "[", 
           "f", "]"}], "[", "##", "]"}], "&"}]}], "\[IndentingNewLine]", 
       "]"}]}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Don", "'"}], "t", " ", "do", " ", "anything", " ", "in", " ", 
       "non"}], "-", 
      RowBox[{"standard", " ", "evaluation", " ", "environments"}]}], ",", 
     " ", 
     RowBox[{
     "as", " ", "the", " ", "kernels", " ", "started", " ", "in", " ", 
      "those", " ", "situations", " ", "tend", " ", "to", " ", "have", " ", 
      "issues", " ", "with", " ", "this", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"e", ".", "g", ".", " ", "rasterization"}], " ", "started", 
        " ", "from", " ", "the", " ", "commandline"}], ")"}]}]}], " ", "*)"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"InjectCustomTicksLoading", "[", "expr_", "]"}], "/;", 
     RowBox[{"!", "$NormalNotebookSession"}]}], ":=", "\[IndentingNewLine]", 
    "expr"}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.814354358570476*^9, 3.8143544124053855`*^9}, {
  3.8143544721038094`*^9, 3.8143545067739954`*^9}, {3.814356367060455*^9, 
  3.8143563729366755`*^9}, {3.8143564377755566`*^9, 3.814356438830722*^9}, {
  3.8143566109408646`*^9, 3.8143566904394445`*^9}, {3.814363627017702*^9, 
  3.8143636372403336`*^9}, {3.8143640407873755`*^9, 3.814364091161821*^9}, {
  3.8144212726325235`*^9, 3.8144212731851187`*^9}, {3.814422730157819*^9, 
  3.814422755662136*^9}, {3.8144290610102406`*^9, 3.814429066729218*^9}, {
  3.8144302072788196`*^9, 3.814430284940414*^9}, {3.8622084910207496`*^9, 
  3.8622085596527185`*^9}},
 CellLabel->"In[134]:=",
 CellID->107678237,ExpressionUUID->"b63c9304-f170-4d2a-a7ea-a5d26d6f3f52"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PlotGrid", "[", 
    RowBox[{"t", ":", 
     RowBox[{"HeadPattern", "[", 
      RowBox[{"$CustomTicksNames", ",", "1"}], "]"}]}], "]"}], "[", "args___",
    "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TransformCustomTicksHeads", "[", 
    RowBox[{"$CustomTicksAssoc", ",", 
     RowBox[{"HeadPattern", "[", 
      RowBox[{"$CustomTicksNames", ",", "1"}], "]"}], ",", "t"}], "]"}], "[", 
   "args", "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8143537349241915`*^9, 3.8143537705755033`*^9}, {
  3.8143538259792953`*^9, 3.814353857323845*^9}, {3.814353905728816*^9, 
  3.8143539480742273`*^9}, {3.81435433880501*^9, 3.814354355583289*^9}, {
  3.8143544351328597`*^9, 3.8143544620878735`*^9}, {3.814356742689748*^9, 
  3.8143567961014194`*^9}, {3.814356997899012*^9, 3.814357002845585*^9}, {
  3.8143635786254067`*^9, 3.8143636053927317`*^9}, {3.814364115777505*^9, 
  3.8143641432167034`*^9}, {3.814422732429985*^9, 3.814422762937402*^9}, {
  3.814428838606651*^9, 3.81442885166747*^9}, {3.8144289073028116`*^9, 
  3.8144289154190817`*^9}, {3.8144290711046877`*^9, 3.8144290779093914`*^9}, {
  3.8144291105280647`*^9, 3.814429112223098*^9}, {3.8144302054660187`*^9, 
  3.814430205794426*^9}},
 CellLabel->"In[136]:=",
 CellID->250187017,ExpressionUUID->"d3015dad-24b2-42c4-8f5a-3d3f350ef387"]
}, Closed]],

Cell[CellGroupData[{

Cell["Frame adjustment", "Subsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7990547524772153`*^9, 3.7990547559674935`*^9}},
 CellLabel->"In[40]:=",
 CellID->639419290,ExpressionUUID->"648574a0-2d04-489e-8c43-f927b0bcce78"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClipFrameLabels", "[", 
   RowBox[{
    RowBox[{"gr_", "?", "ValidGraphicsQ"}], ",", "sides_List"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"drop", "=", 
       RowBox[{
        RowBox[{"Complement", "[", 
         RowBox[{
          RowBox[{"Keys", "@", "$SidePositions"}], ",", "sides"}], "]"}], "/.",
         "$SidePositions"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"frame", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"NormalizedOptionValue", "[", 
          RowBox[{"gr", ",", "Frame"}], "]"}], ",", 
         RowBox[{"None", "\[Rule]", "False"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"frameTicks", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"NormalizedOptionValue", "[", 
          RowBox[{"gr", ",", "FrameTicks"}], "]"}], ",", 
         RowBox[{"None", "\[Rule]", "False"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{"gr", ",", "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{
         RowBox[{"NormalizedOptionValue", "[", 
          RowBox[{"gr", ",", "FrameLabel"}], "]"}], ",", 
         RowBox[{"drop", "\[Rule]", "None"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"MapAt", "[", 
        RowBox[{"HideTickLabels", ",", "frameTicks", ",", "drop"}], "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"FrameTicksStyle", "\[Rule]", 
       RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{
             "only", " ", "apply", " ", "styling", " ", "if", " ", "the", " ",
               "frame", " ", "is", " ", "shown"}], ",", " ", 
             RowBox[{
             "to", " ", "work", " ", "around", " ", "the", " ", "bug", " ", 
              "that", " ", "styles", " ", "from", " ", "hidden", " ", "frame",
               " ", "sides", " ", "are", " ", "inherited", " ", "by", " ", 
              "the", " ", "following", " ", "frame", " ", "sides"}]}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"TrueQ", "[", 
              RowBox[{"!", 
               RowBox[{"Extract", "[", 
                RowBox[{"frame", ",", "#2"}], "]"}]}], "]"}], "||", 
             RowBox[{"TrueQ", "[", 
              RowBox[{"!", 
               RowBox[{"Extract", "[", 
                RowBox[{"frameTicks", ",", "#2"}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", "None", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"MemberQ", "[", 
              RowBox[{"drop", ",", "#2"}], "]"}], "&&", 
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"frameTicks", ",", "#2"}], "]"}], ",", 
               "$BuiltinTickSpecs"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"FontSize", "\[Rule]", "$MachineEpsilon"}], 
              RowBox[{"(*", " ", 
               RowBox[{
               "putting", " ", "0", " ", "here", " ", "breaks", " ", "PDF", 
                " ", "exports"}], " ", "*)"}], ",", 
              RowBox[{"FontOpacity", "\[Rule]", "0"}], ",", "#"}], "]"}], ",",
             "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", "#"}],
            "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{"NormalizedOptionValue", "[", 
          RowBox[{"gr", ",", "FrameTicksStyle"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ClipFrameLabels", "[", 
   RowBox[{"expr_", ",", "_"}], "]"}], ":=", "expr"}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.779962844209722*^9, 3.779962895354743*^9}, {
   3.7799629326308765`*^9, 3.779962934195877*^9}, 3.7799629939173417`*^9, {
   3.797068876452917*^9, 3.797068878866754*^9}, {3.797068918922526*^9, 
   3.797068919592801*^9}, {3.7970689772458525`*^9, 3.7970690242596145`*^9}, {
   3.797069074397481*^9, 3.797069105383639*^9}, {3.7970698723396635`*^9, 
   3.7970698765876656`*^9}, {3.7970699280286627`*^9, 3.797069939892666*^9}, {
   3.7970699715047083`*^9, 3.7970701139947085`*^9}, {3.7970701635712967`*^9, 
   3.797070210244296*^9}, {3.7973248000720563`*^9, 3.797324848131609*^9}, {
   3.797918090957652*^9, 3.797918098748953*^9}, 3.797919307036933*^9, {
   3.7979218533847537`*^9, 3.797921887274495*^9}, {3.7979222291394887`*^9, 
   3.7979222515866365`*^9}, {3.7979222868616867`*^9, 
   3.7979224014402905`*^9}, {3.7979224731355295`*^9, 
   3.7979224802595563`*^9}, {3.7979225723545074`*^9, 3.7979225994666185`*^9}, 
   3.7980307576263027`*^9, {3.79803161744538*^9, 3.7980316183253937`*^9}, {
   3.7980330337241707`*^9, 3.798033080095378*^9}, {3.8069911017753124`*^9, 
   3.806991118453378*^9}, {3.8143539994176383`*^9, 3.814354005757551*^9}, 
   3.821273393432683*^9, {3.871816958086421*^9, 3.8718169901852255`*^9}, 
   3.871818065153635*^9},
 CellLabel->"In[137]:=",
 CellID->303179503,ExpressionUUID->"c167ae54-09f9-428d-af74-1fe34b55d8ad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LookupNeighbors", "[", 
   RowBox[{"grid_", ",", 
    RowBox[{"{", 
     RowBox[{"i_", ",", "j_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"h_", ",", "w_"}], "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Map", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ListLookup", "[", 
      RowBox[{"grid", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}], "+", "#"}], "&"}], "/@", 
         RowBox[{"Thread", "@", "#"}]}], "/.", 
        RowBox[{"(", 
         RowBox[{"0", "\[Rule]", "Null"}], ")"}]}], ",", "Null"}], "]"}], 
     "&"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "h"}], "]"}], ",", 
          RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "h"}], "]"}], ",", 
          RowBox[{"1", "+", "w"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], 
      ",", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"1", "+", "h"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "w"}], "]"}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "w"}], "]"}]}], "}"}]}], "\[IndentingNewLine]", 
       "}"}]}], "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.806950820066272*^9, 3.806950890036854*^9}},
 CellLabel->"In[139]:=",
 CellID->659952330,ExpressionUUID->"2cf2e5d9-112d-4bda-9de8-ddf586782053"],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotsPresent", "[", 
   RowBox[{"grid_", ",", "pos_", ",", "dim_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"neigh", "=", 
      RowBox[{"LookupNeighbors", "[", 
       RowBox[{"grid", ",", "pos", ",", "dim"}], "]"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"MemberQ", "[", 
       RowBox[{
        RowBox[{"Extract", "[", 
         RowBox[{"neigh", ",", "#"}], "]"}], ",", 
        RowBox[{"Except", "@", "Null"}]}], "]"}], "&"}], "/@", 
     "$SidePositions"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7980326608250475`*^9, 3.798032683479769*^9}, {
  3.7985501600020785`*^9, 3.798550177545062*^9}, {3.7985502262580605`*^9, 
  3.7985502282650824`*^9}, {3.798550316736061*^9, 3.7985503180570617`*^9}, {
  3.798550500568838*^9, 3.798550508999844*^9}, {3.798550539247822*^9, 
  3.7985505699358206`*^9}, {3.8069509053720865`*^9, 3.806950977298297*^9}, {
  3.8069945498924065`*^9, 3.806994551283657*^9}},
 CellLabel->"In[140]:=",
 CellID->877718539,ExpressionUUID->"07317893-8b67-4a96-8d93-593f2d6d08a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LookupSpacings", "[", 
   RowBox[{"spacings_", ",", 
    RowBox[{"{", 
     RowBox[{"i_", ",", "j_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"h_", ",", "w_"}], "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ListLookup", "[", 
     RowBox[{"spacings", ",", 
      RowBox[{"#", "/.", 
       RowBox[{"(", 
        RowBox[{"0", "\[Rule]", "Null"}], ")"}]}], ",", 
      RowBox[{"Missing", "[", "]"}]}], "]"}], "&"}], "/@", 
   "\[IndentingNewLine]", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Left", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"j", "-", "1"}]}], "}"}]}], ",", 
     RowBox[{"Right", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"j", "+", "w"}]}], "}"}]}], ",", 
     RowBox[{"Bottom", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"i", "+", "h"}]}], "}"}]}], ",", 
     RowBox[{"Top", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"i", "-", "1"}]}], "}"}]}]}], "\[IndentingNewLine]", 
    "|>"}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8069949704877453`*^9, 3.80699504074057*^9}},
 CellLabel->"In[141]:=",
 CellID->107703583,ExpressionUUID->"6e920734-d029-43e1-bbe6-b6584a865eb8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpacingsPresent", "[", 
   RowBox[{"spacings_", ",", "pos_", ",", "dim_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "=!=", "0"}], "&"}], "/@", 
   RowBox[{"LookupSpacings", "[", 
    RowBox[{"spacings", ",", "pos", ",", "dim"}], "]"}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7980326866587687`*^9, 3.7980327091573534`*^9}, {
  3.798032758292762*^9, 3.798032760866761*^9}, {3.7985501322490606`*^9, 
  3.798550133350062*^9}, {3.798550230553095*^9, 3.798550231745061*^9}, {
  3.798550319999078*^9, 3.7985503308150597`*^9}, {3.79855038906406*^9, 
  3.7985503961200686`*^9}, {3.7985504528558197`*^9, 3.7985504669918203`*^9}, {
  3.7985507816017714`*^9, 3.798550784111754*^9}, {3.806995048610965*^9, 
  3.8069950651726956`*^9}},
 CellLabel->"In[142]:=",
 CellID->147855450,ExpressionUUID->"ab80ba74-8736-4555-96db-53d51d5014a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ApplyFrameSettings", "[", 
   RowBox[{
    RowBox[{"pos", ":", 
     RowBox[{"{", 
      RowBox[{"i_", ",", "j_"}], "}"}]}], ",", "dims_", ",", 
    "showFrameLabels_", ",", "hideOuterLabels_", ",", "mergeAxes_", ",", 
    "effSize_", ",", "grid_", ",", "spacings_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"gr", "=", 
       RowBox[{"grid", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"plotsPresent", "=", 
       RowBox[{"PlotsPresent", "[", 
        RowBox[{"grid", ",", "pos", ",", "dims"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"spacingsPresent", "=", 
       RowBox[{"SpacingsPresent", "[", 
        RowBox[{"spacings", ",", "pos", ",", "dims"}], "]"}]}], ",", 
      "\[IndentingNewLine]", "autoValues", ",", "\[IndentingNewLine]", 
      "thresholds"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"autoValues", "=", 
        RowBox[{
         RowBox[{"<|", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Automatic", "\[Rule]", 
            RowBox[{"!", 
             RowBox[{"plotsPresent", "[", "#", "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Full", "\[Rule]", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"plotsPresent", "[", "#", "]"}]}], "||", 
             RowBox[{"spacingsPresent", "[", "#", "]"}]}]}]}], 
          "\[IndentingNewLine]", "|>"}], "&"}]}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"thresholds", "=", 
        RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "/.", 
                RowBox[{"Not", "/@", 
                 RowBox[{"autoValues", "@", 
                  RowBox[{"$PositionSides", "@", "#2"}]}]}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",",
              "\[IndentingNewLine]", 
             RowBox[{"-", "Infinity"}]}], "\[IndentingNewLine]", "]"}], "&"}],
           ",", "\[IndentingNewLine]", "hideOuterLabels", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"gr", "=", 
        RowBox[{"ClipFrameLabels", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Show", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"grid", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Frame", "\[Rule]", 
             RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"#2", "=!=", "False"}], ",", "False", ",", "#"}], 
                 "]"}], "&"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"NormalizedOptionValue", "[", 
                  RowBox[{"gr", ",", "Frame"}], "]"}], ",", 
                 "\[IndentingNewLine]", "mergeAxes"}], "\[IndentingNewLine]", 
                "}"}], ",", "\[IndentingNewLine]", "2"}], 
              "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"#2", "/.", 
               RowBox[{"autoValues", "@", "#"}]}], ",", "\[IndentingNewLine]",
               "#", ",", "\[IndentingNewLine]", "Nothing"}], 
             "\[IndentingNewLine]", "]"}], "&"}], "@@@", 
           "showFrameLabels"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{"gr", ",", "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Hold", "[", "EnsureCustomTicks", "]"}], "[", 
              "\[IndentingNewLine]", 
              RowBox[{"#2", ",", "\[IndentingNewLine]", 
               RowBox[{"HideOuterLabels", "[", 
                RowBox[{"#2", ",", "effSize", ",", 
                 RowBox[{"thresholds", "\[LeftDoubleBracket]", 
                  RowBox[{"3", "-", 
                   RowBox[{
                   "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "\[RightDoubleBracket]"}], 
                 ",", "#"}], "]"}]}], "\[IndentingNewLine]", "]"}], "&"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"NormalizedOptionValue", "[", 
             RowBox[{"gr", ",", "FrameTicks"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ")"}], "/;", 
     RowBox[{"ValidGraphicsQ", "@", "gr"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplyFrameSettings", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i_", ",", "j_"}], "}"}], ",", "_", ",", "_", ",", "_", ",", "_",
     ",", "_", ",", "grid_", ",", "_"}], "]"}], ":=", 
  RowBox[{"grid", "\[LeftDoubleBracket]", 
   RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.779962844209722*^9, 3.779962895354743*^9}, {
   3.7799629326308765`*^9, 3.779962934195877*^9}, {3.7799629939173417`*^9, 
   3.7799631909017515`*^9}, 3.7974457701701674`*^9, {3.797488749536581*^9, 
   3.797488781560475*^9}, {3.79748881532333*^9, 3.7974888203881702`*^9}, {
   3.797489081525084*^9, 3.7974891511249433`*^9}, {3.7974895731439657`*^9, 
   3.7974895870544415`*^9}, {3.7974974166768475`*^9, 
   3.7974974711832285`*^9}, {3.7974975156004686`*^9, 3.797497516348469*^9}, {
   3.797497722079187*^9, 3.7974977820490522`*^9}, {3.7974978428710732`*^9, 
   3.797497847057582*^9}, {3.797497962061117*^9, 3.7974979745892344`*^9}, {
   3.7974982959418187`*^9, 3.797498318734679*^9}, {3.7974984615563087`*^9, 
   3.797498497779001*^9}, {3.7980313194779515`*^9, 3.7980313366936245`*^9}, {
   3.7980313719615307`*^9, 3.798031374614967*^9}, {3.79803142183899*^9, 
   3.798031460760428*^9}, {3.7980322076725855`*^9, 3.7980322699385242`*^9}, {
   3.7980323344848986`*^9, 3.7980325212129345`*^9}, {3.7980325793747077`*^9, 
   3.7980325821827087`*^9}, {3.7980327190204535`*^9, 3.798032755382761*^9}, {
   3.7980327878793945`*^9, 3.798032817236377*^9}, {3.7985499467043295`*^9, 
   3.798549949297311*^9}, {3.79855010341106*^9, 3.798550105916092*^9}, {
   3.7985509010247755`*^9, 3.798550903935769*^9}, {3.798717278240364*^9, 
   3.7987173386488895`*^9}, {3.798717432977793*^9, 3.7987174586651745`*^9}, {
   3.798717506390126*^9, 3.7987176140114803`*^9}, {3.798717802939747*^9, 
   3.798717838782315*^9}, {3.7987179729276333`*^9, 3.7987180315037994`*^9}, 
   3.7987183073893127`*^9, {3.798718883656022*^9, 3.7987188854230537`*^9}, {
   3.7987226408515577`*^9, 3.7987226460515556`*^9}, {3.798722697277562*^9, 
   3.7987229259215684`*^9}, {3.798722994435831*^9, 3.7987230382541203`*^9}, {
   3.7987231615587845`*^9, 3.798723202196512*^9}, {3.799055066313695*^9, 
   3.7990551502364283`*^9}, {3.7990552005079794`*^9, 
   3.7990552897421436`*^9}, {3.7990553352984276`*^9, 
   3.7990553779458127`*^9}, {3.79905657597602*^9, 3.7990566090491*^9}, {
   3.79905976988939*^9, 3.799059854614216*^9}, {3.7990714096245756`*^9, 
   3.799071440502898*^9}, {3.806931072079687*^9, 3.806931181169937*^9}, {
   3.8069312324840555`*^9, 3.806931232899673*^9}, {3.806931266479476*^9, 
   3.806931267210495*^9}, {3.8069901415606623`*^9, 3.8069901767320175`*^9}, {
   3.8069902087676153`*^9, 3.8069902254331656`*^9}, {3.8069903193635006`*^9, 
   3.8069903842739267`*^9}, {3.806990468383256*^9, 3.8069904704474816`*^9}, {
   3.8069908457873554`*^9, 3.806990867707466*^9}, {3.8069911635550795`*^9, 
   3.806991166347505*^9}, {3.80699207432495*^9, 3.806992085930828*^9}, {
   3.8069922705125675`*^9, 3.806992271640933*^9}, {3.8069927842332892`*^9, 
   3.806992784389909*^9}, {3.8143542681328306`*^9, 3.8143542827920637`*^9}},
 CellLabel->"In[143]:=",
 CellID->299137681,ExpressionUUID->"d2375f80-d285-4b1a-ad4c-f70f0a8ba164"]
}, Closed]],

Cell[CellGroupData[{

Cell["Legend utilities", "Subsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.799054793051957*^9, 3.7990547978934164`*^9}},
 CellLabel->"In[9]:=",
 CellID->359909545,ExpressionUUID->"00f457db-8cc5-4a9f-89a1-33599a011ac1"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"based", " ", "on", " ", "Legending`LegendDump`placedHelper"}], 
   " ", "-", " ", 
   RowBox[{
   "used", " ", "to", " ", "determine", " ", "whether", " ", "legends", " ", 
    "will", " ", "be", " ", "placed", " ", "inside", " ", "or", " ", 
    "outside", " ", "the", " ", "plot"}]}], " ", "*)"}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7979384429602013`*^9, 3.7979384585423627`*^9}, {
  3.798031555541021*^9, 3.7980315572746077`*^9}},
 CellLabel->"In[145]:=",
 CellID->240991414,ExpressionUUID->"10f9b509-be45-4ec2-bd0b-719b39f031ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"iExplicitPosPat", "=", 
   RowBox[{
    RowBox[{"_", "?", "NumericQ"}], "|", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Scaled", "|", "ImageScaled"}], ")"}], "[", 
     RowBox[{"_", "?", "NumericQ"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"explicitPosPat", "=", 
   RowBox[{"iExplicitPosPat", "|", 
    RowBox[{"Offset", "[", 
     RowBox[{"_", "?", "NumericQ"}], "]"}], "|", 
    RowBox[{"Offset", "[", 
     RowBox[{
      RowBox[{"_", "?", "NumericQ"}], ",", "iExplicitPosPat"}], "]"}]}]}], 
  ";"}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.806306310501199*^9, 3.806306324487028*^9}, {
  3.8066530316722584`*^9, 3.806653084815772*^9}},
 CellLabel->"In[146]:=",
 CellID->583224903,ExpressionUUID->"7f82a039-d41e-4ded-8d95-d296fbceb2d7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"normalizeExplicitPos", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"t", ":", 
      RowBox[{"Scaled", "|", "ImageScaled"}]}], ")"}], "[", 
    RowBox[{"p_", "?", "NumericQ"}], "]"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{"t", ",", "0", ",", "p"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normalizeExplicitPos", "[", 
   RowBox[{"p_", "?", "NumericQ"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{"Scaled", ",", "0", ",", "p"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normalizeExplicitPos", "[", 
   RowBox[{"Offset", "[", 
    RowBox[{"o_", "?", "NumericQ"}], "]"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{"Scaled", ",", "o", ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"normalizeExplicitPos", "[", 
   RowBox[{"Offset", "[", 
    RowBox[{
     RowBox[{"o_", "?", "NumericQ"}], ",", 
     RowBox[{"p", ":", "iExplicitPosPat"}]}], "]"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"ReplacePart", "[", 
   RowBox[{
    RowBox[{"normalizeExplicitPos", "[", "p", "]"}], ",", 
    RowBox[{"2", "\[Rule]", "o"}]}], "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.806306327902066*^9, 3.8063063785799985`*^9}, {
  3.8066531038125076`*^9, 3.8066532185445147`*^9}},
 CellLabel->"In[148]:=",
 CellID->161918558,ExpressionUUID->"251f0c58-7573-470d-8385-dbfdc8382d7e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"posPat", "=", 
   RowBox[{
   "Left", "|", "Right", "|", "Top", "|", "Bottom", "|", "Center", "|", 
    "After", "|", "\"\<After\>\"", "|", "Before", "|", "\"\<Before\>\"", "|", 
    "Above", "|", "Below"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xposPat", "=", 
   RowBox[{
   "Before", "|", "Left", "|", "Center", "|", "Right", "|", "After", "|", 
    "\"\<Axis\>\"", "|", "explicitPosPat"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yposPat", "=", 
   RowBox[{
   "Below", "|", "Bottom", "|", "Center", "|", "Top", "|", "Above", "|", 
    "\"\<Axis\>\"", "|", "explicitPosPat"}]}], ";"}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.797533358147812*^9, 3.797533377525942*^9}, {
  3.797533468228016*^9, 3.797533547810711*^9}, {3.8063062701576242`*^9, 
  3.8063063201182365`*^9}, {3.8063064176592655`*^9, 3.8063064209736013`*^9}},
 CellLabel->"In[152]:=",
 CellID->820312788,ExpressionUUID->"c67cddaa-f241-469a-aacb-0b624aca687c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eposPat", "=", 
   RowBox[{"Left", "|", "Right", "|", "Top", "|", "Bottom", "|", "Center"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"exposPat", "=", 
   RowBox[{"Left", "|", "Center", "|", "Right", "|", 
    RowBox[{"_", "?", "NumericQ"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eyposPat", "=", 
   RowBox[{"Bottom", "|", "Center", "|", "Top", "|", 
    RowBox[{"_", "?", "NumericQ"}]}]}], ";"}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.797533398552619*^9, 3.7975334572381783`*^9}, {
  3.797533505365737*^9, 3.7975335102500167`*^9}, {3.797533554884716*^9, 
  3.7975335734909067`*^9}},
 CellLabel->"In[155]:=",
 CellID->377721146,ExpressionUUID->"f02f7477-a651-4267-b387-f956a3a95ac5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"placedHelper", "[", 
    RowBox[{"pos", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Scaled", "|", "ImageScaled"}], ")"}], "[", "_List", "]"}]}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"placedHelper", "@", 
    RowBox[{"Thread", "@", "pos"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"placedHelper", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Scaled", "|", "ImageScaled"}], ")"}], "[", "pos_", "]"}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"placedHelper", "@", "pos"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"placedHelper", "[", 
    RowBox[{"pos", ":", 
     RowBox[{"Offset", "[", 
      RowBox[{"_List", ",", 
       RowBox[{"_List", "|", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Scaled", "|", "ImageScaled"}], ")"}], "[", "_List", "]"}], 
        "|", 
        RowBox[{"PatternSequence", "[", "]"}]}]}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"placedHelper", "@", 
    RowBox[{"Thread", "@", 
     RowBox[{
      RowBox[{"MapAt", "[", 
       RowBox[{"Thread", ",", "2"}], "]"}], "@", "pos"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"placedHelper", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"xpos", ":", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Scaled", "|", "ImageScaled"}], ")"}], "[", "_List", "]"}]}],
       ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Scaled", "|", "ImageScaled"}], ")"}], "[", "ypos_", "]"}], 
       "|", "ypos_List"}]}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"placedHelper", "@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Thread", "@", "xpos"}], ",", "ypos"}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"placedHelper", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t1", ":", 
           RowBox[{"Scaled", "|", "ImageScaled"}]}], ")"}], "[", "xpos_", 
         "]"}], "|", "xpos_List"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t2", ":", 
           RowBox[{"Scaled", "|", "ImageScaled"}]}], ")"}], "[", "ypos_", 
         "]"}], "|", "ypos_List"}]}], "}"}], "]"}], "/;", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"t1", ",", "t2"}], "}"}], "=!=", 
     RowBox[{"{", "}"}]}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{"placedHelper", "@", 
    RowBox[{"{", 
     RowBox[{"xpos", ",", "ypos"}], "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"placedHelper", "[", 
    RowBox[{"pos", ":", "posPat"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"posHelper", "@", 
      RowBox[{"namedPlaceHelper", "@", "pos"}]}], ",", 
     RowBox[{"eposHelper", "@", 
      RowBox[{"namedPlaceHelper", "@", "pos"}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"placedHelper", "[", 
    RowBox[{"pos", ":", 
     RowBox[{"{", 
      RowBox[{"xposPat", ",", "yposPat"}], "}"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"posHelper", "@", "pos"}], ",", 
     RowBox[{"automaticEposHelper", "@", "pos"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"placedHelper", "[", 
    RowBox[{"{", 
     RowBox[{"pos", ":", 
      RowBox[{"{", 
       RowBox[{"xposPat", ",", "yposPat"}], "}"}]}], "}"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"posHelper", "@", "pos"}], ",", 
     RowBox[{"automaticEposHelper", "@", "pos"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"placedHelper", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pos", ":", "posPat"}], ",", 
      RowBox[{"epos", ":", "eposPat"}]}], "}"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"posHelper", "@", 
      RowBox[{"namedPlaceHelper", "@", "pos"}]}], ",", 
     RowBox[{"eposHelper", "@", 
      RowBox[{"namedPlaceHelper", "@", "epos"}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"placedHelper", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pos", ":", 
       RowBox[{"{", 
        RowBox[{"xposPat", ",", "yposPat"}], "}"}]}], ",", 
      RowBox[{"epos", ":", "eposPat"}]}], "}"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"posHelper", "@", "pos"}], ",", 
     RowBox[{"eposHelper", "@", 
      RowBox[{"namedPlaceHelper", "@", "epos"}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"placedHelper", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pos", ":", "posPat"}], ",", 
      RowBox[{"epos", ":", 
       RowBox[{"{", 
        RowBox[{"exposPat", ",", "eyposPat"}], "}"}]}]}], "}"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"posHelper", "@", 
      RowBox[{"namedPlaceHelper", "@", "pos"}]}], ",", 
     RowBox[{"eposHelper", "@", "epos"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"placedHelper", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pos", ":", 
       RowBox[{"{", 
        RowBox[{"xposPat", ",", "yposPat"}], "}"}]}], ",", 
      RowBox[{"epos", ":", 
       RowBox[{"{", 
        RowBox[{"exposPat", ",", "eyposPat"}], "}"}]}]}], "}"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"posHelper", "@", "pos"}], ",", 
     RowBox[{"eposHelper", "@", "epos"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"placedHelper", "[", "pos_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"posHelper", "@", 
      RowBox[{"namedPlaceHelper", "@", "After"}]}], ",", 
     RowBox[{"eposHelper", "@", 
      RowBox[{"namedPlaceHelper", "@", "Left"}]}]}], "}"}]}], ";"}]}], "Input",\

 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQLWD5StXC+42j0u+PxiDaLuCVOYj2M/S3ANFTXhcV
g+g0F60GEP3EzXAeiD5+yBFM/7hbvxlE37wmugNE73x68zSIXuqYfhZEq0iG
mmr7vHGc8PioOYiu2MJ/5HT0G0epLp0nINrF56voFyDNFB8gBqI1NRZLgeia
iGZ5EL3y7FOHuTFvHPUtZrmA6IaTml4geklBOZiuqfW5C6Jd3hXfA9FGjiYf
QbRu6X8wPe3Bix8gem+f3T8Q/WZ5veQ8IH1ww1kwPdf1vRmIrvXitAfRIQcN
3UH03om7fEF0wW6jXhDdo1/fB6I50rL3gehfC/eDaQAy76Hu
  "],
 CellLabel->"In[158]:=",
 CellID->180268058,ExpressionUUID->"bc5bb327-4bb1-4fd4-9056-809c06b1b288"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"namedPlaceHelper", "[", "pos_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Switch", "[", 
    RowBox[{"pos", ",", "\[IndentingNewLine]", 
     RowBox[{"Right", "|", "\"\<After\>\"", "|", "After"}], ",", 
     RowBox[{"{", 
      RowBox[{"After", ",", "Center"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Left", "|", "\"\<Before\>\"", "|", "Before"}], ",", 
     RowBox[{"{", 
      RowBox[{"Before", ",", "Center"}], "}"}], ",", "\[IndentingNewLine]", 
     "Center", ",", 
     RowBox[{"{", 
      RowBox[{"Center", ",", "Center"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Bottom", "|", "Below"}], ",", 
     RowBox[{"{", 
      RowBox[{"Center", ",", "Below"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Top", "|", "Above"}], ",", 
     RowBox[{"{", 
      RowBox[{"Center", ",", "Above"}], "}"}], ",", "\[IndentingNewLine]", 
     "_", ",", 
     RowBox[{"{", 
      RowBox[{"After", ",", "Center"}], "}"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7975331399537444`*^9, 3.797533214738242*^9}, 
   3.798030783509028*^9},
 CellLabel->"In[171]:=",
 CellID->884347754,ExpressionUUID->"532cea54-f147-4574-897f-f801f3beb5d9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$defOffset", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"posHelper", "[", 
    RowBox[{"{", 
     RowBox[{"xpos_", ",", "ypos_"}], "}"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"normalizeExplicitPos", "/@", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Switch", "[", 
       RowBox[{"xpos", ",", "\[IndentingNewLine]", "After", ",", 
        RowBox[{"Offset", "[", 
         RowBox[{"$defOffset", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
        "Right", ",", 
        RowBox[{"Offset", "[", 
         RowBox[{
          RowBox[{"-", "$defOffset"}], ",", "1"}], "]"}], ",", 
        "\[IndentingNewLine]", "Before", ",", 
        RowBox[{"Offset", "[", 
         RowBox[{
          RowBox[{"-", "$defOffset"}], ",", "0"}], "]"}], ",", 
        "\[IndentingNewLine]", "Left", ",", 
        RowBox[{"Offset", "[", 
         RowBox[{"$defOffset", ",", "0"}], "]"}], ",", "\[IndentingNewLine]", 
        "Center", ",", "0.5", ",", "\[IndentingNewLine]", "explicitPosPat", 
        ",", "xpos", ",", "\[IndentingNewLine]", "\"\<Axis\>\"", ",", "1", 
        ",", "\[IndentingNewLine]", "_", ",", 
        RowBox[{"Offset", "[", 
         RowBox[{"$defOffset", ",", "1"}], "]"}]}], "\[IndentingNewLine]", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Switch", "[", 
       RowBox[{"ypos", ",", "\[IndentingNewLine]", "Below", ",", 
        RowBox[{"Offset", "[", 
         RowBox[{
          RowBox[{"-", "$defOffset"}], ",", "0"}], "]"}], ",", 
        "\[IndentingNewLine]", "Bottom", ",", 
        RowBox[{"Offset", "[", 
         RowBox[{"$defOffset", ",", "0"}], "]"}], ",", "\[IndentingNewLine]", 
        "Top", ",", 
        RowBox[{"Offset", "[", 
         RowBox[{
          RowBox[{"-", "$defOffset"}], ",", "1"}], "]"}], ",", 
        "\[IndentingNewLine]", "Above", ",", 
        RowBox[{"Offset", "[", 
         RowBox[{"$defOffset", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
        "Center", ",", "0.5", ",", "\[IndentingNewLine]", "explicitPosPat", 
        ",", "ypos", ",", "\[IndentingNewLine]", "\"\<Axis\>\"", ",", "1", 
        ",", "\[IndentingNewLine]", "_", ",", "0.5"}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "}"}]}]}], ";"}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.797533234254699*^9, 3.7975333417778115`*^9}, {
   3.7975340387800503`*^9, 3.797534058770641*^9}, 3.7980307856030297`*^9, {
   3.8063066774211464`*^9, 3.8063068044290276`*^9}, {3.8063091323807116`*^9, 
   3.806309153411425*^9}, {3.806309198581295*^9, 3.8063091987786446`*^9}, {
   3.8063092644617414`*^9, 3.806309280780117*^9}, {3.806309456283924*^9, 
   3.8063094698035364`*^9}, {3.8063363220195465`*^9, 
   3.8063363226709776`*^9}, {3.8063363803333693`*^9, 3.8063363810735607`*^9}, 
   3.80633652084492*^9, {3.806655239126058*^9, 3.8066553217935524`*^9}, {
   3.806655356804824*^9, 3.806655361858788*^9}, {3.8070106621827755`*^9, 
   3.807010687247837*^9}},
 CellLabel->"In[172]:=",
 CellID->234189366,ExpressionUUID->"af27519f-ece2-48e9-9c6b-6bfa5ac1e06d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eposHelper", "[", 
    RowBox[{"{", 
     RowBox[{"expos_", ",", "eypos_"}], "}"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{
      "expos", ",", "\[IndentingNewLine]", "After", ",", "0", ",", 
       "\[IndentingNewLine]", "Right", ",", "1", ",", "\[IndentingNewLine]", 
       "Before", ",", "1", ",", "\[IndentingNewLine]", "Left", ",", "0", ",", 
       "\[IndentingNewLine]", "Center", ",", "0.5", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"_", "?", "NumericQ"}], ",", "expos", ",", 
       "\[IndentingNewLine]", "_", ",", "0.5"}], "\[IndentingNewLine]", "]"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "eypos", ",", "\[IndentingNewLine]", "Center", ",", "0.5", ",", 
       "\[IndentingNewLine]", "Below", ",", "1", ",", "\[IndentingNewLine]", 
       "Bottom", ",", "0", ",", "\[IndentingNewLine]", "Top", ",", "1", ",", 
       "\[IndentingNewLine]", "Above", ",", "0", ",", "\[IndentingNewLine]", 
       RowBox[{"_", "?", "NumericQ"}], ",", "eypos", ",", 
       "\[IndentingNewLine]", "_", ",", "0.5"}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8062241876326675`*^9, 3.80622424958025*^9}, 
   3.8062243030001726`*^9},
 CellLabel->"In[174]:=",
 CellID->975494157,ExpressionUUID->"b28e0d31-4edc-4f3d-b795-296a5dbd609b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"coordSign", "[", 
    RowBox[{
     RowBox[{"_", "|", 
      RowBox[{"PatternSequence", "[", "]"}]}], ",", "o_", ",", "x_"}], "]"}], 
   "/;", 
   RowBox[{"0", "<", "x", "<", "1"}]}], ":=", "\[IndentingNewLine]", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coordSign", "[", 
    RowBox[{
     RowBox[{"_", "|", 
      RowBox[{"PatternSequence", "[", "]"}]}], ",", "o_", ",", "x_"}], "]"}], 
   "/;", 
   RowBox[{
    RowBox[{"1", "<", "x"}], "||", 
    RowBox[{"x", "<", "0"}]}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Sign", "@", "x"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coordSign", "[", 
    RowBox[{
     RowBox[{"_", "|", 
      RowBox[{"PatternSequence", "[", "]"}]}], ",", "o_", ",", "x_"}], "]"}], 
   "/;", 
   RowBox[{"x", "\[Equal]", "0"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"o", ">", "0"}], ",", 
    RowBox[{"-", "0.5"}], ",", 
    RowBox[{"-", "1"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"coordSign", "[", 
    RowBox[{
     RowBox[{"_", "|", 
      RowBox[{"PatternSequence", "[", "]"}]}], ",", "o_", ",", "x_"}], "]"}], 
   "/;", 
   RowBox[{"x", "\[Equal]", "1"}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"o", "<", "0"}], ",", "0.5", ",", "1"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coordSign", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"_", "|", 
      RowBox[{"PatternSequence", "[", "]"}]}], ",", "o_", ",", "x_"}], "}"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"coordSign", "[", 
   RowBox[{"o", ",", "x"}], "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.806413431975382*^9, 3.806413459986077*^9}, {
   3.8064135960862865`*^9, 3.8064136087350397`*^9}, {3.8064136939657326`*^9, 
   3.806413816111658*^9}, 3.806413918742465*^9, {3.806414131027212*^9, 
   3.8064141542629843`*^9}, {3.8065907149536724`*^9, 3.806590730237997*^9}, {
   3.806655450503227*^9, 3.806655469269268*^9}},
 CellLabel->"In[175]:=",
 CellID->207196137,ExpressionUUID->"0e64cd65-2feb-4932-98af-8482c63f9aa2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"coordInsideQ", "[", 
   RowBox[{
    RowBox[{"_", "|", 
     RowBox[{"PatternSequence", "[", "]"}]}], ",", "o_", ",", "x_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"-", "0.5"}], "\[LessEqual]", 
   RowBox[{"coordSign", "[", 
    RowBox[{"o", ",", "x"}], "]"}], "\[LessEqual]", 
   "0.5"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coordInsideQ", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"_", "|", 
      RowBox[{"PatternSequence", "[", "]"}]}], ",", "o_", ",", "x_"}], "}"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"coordInsideQ", "[", 
   RowBox[{"o", ",", "x"}], "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.806414392177122*^9, 3.8064144139721947`*^9}, {
  3.8065906886619883`*^9, 3.8065907110659757`*^9}, {3.806655474909442*^9, 
  3.806655479776046*^9}},
 CellLabel->"In[180]:=",
 CellID->675298955,ExpressionUUID->"fab2864a-33fc-4c92-9ca0-410474a657d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"automaticEposHelper", "[", 
    RowBox[{"{", 
     RowBox[{"xpos_", ",", "ypos_"}], "}"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{
      "xpos", ",", "\[IndentingNewLine]", "After", ",", "0", ",", 
       "\[IndentingNewLine]", "Right", ",", "1", ",", "\[IndentingNewLine]", 
       "Before", ",", "1", ",", "\[IndentingNewLine]", "Left", ",", "0", ",", 
       "\[IndentingNewLine]", "Center", ",", "0.5", ",", 
       "\[IndentingNewLine]", "explicitPosPat", ",", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"coordSign", "@", 
          RowBox[{"normalizeExplicitPos", "[", "xpos", "]"}]}], ",", 
         "\[IndentingNewLine]", "0", ",", "0.5", ",", "\[IndentingNewLine]", 
         RowBox[{"1", "|", 
          RowBox[{"-", "0.5"}]}], ",", "0", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", "1"}], "|", "0.5"}], ",", "1"}], "\[IndentingNewLine]",
         "]"}], ",", "\[IndentingNewLine]", "_", ",", "0.5"}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Switch", "[", 
      RowBox[{
      "ypos", ",", "\[IndentingNewLine]", "Center", ",", "0.5", ",", 
       "\[IndentingNewLine]", "Below", ",", "1", ",", "\[IndentingNewLine]", 
       "Bottom", ",", "0", ",", "\[IndentingNewLine]", "Top", ",", "1", ",", 
       "\[IndentingNewLine]", "Above", ",", "0", ",", "\[IndentingNewLine]", 
       "explicitPosPat", ",", 
       RowBox[{"Switch", "[", 
        RowBox[{
         RowBox[{"coordSign", "@", 
          RowBox[{"normalizeExplicitPos", "[", "ypos", "]"}]}], ",", 
         "\[IndentingNewLine]", "0", ",", "0.5", ",", "\[IndentingNewLine]", 
         RowBox[{"1", "|", 
          RowBox[{"-", "0.5"}]}], ",", "0", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"-", "1"}], "|", "0.5"}], ",", "1"}], "\[IndentingNewLine]",
         "]"}], ",", "\[IndentingNewLine]", "_", ",", "0.5"}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8062242777023387`*^9, 3.806224369547445*^9}, {
  3.8063068729698515`*^9, 3.8063069117999277`*^9}, {3.806340902429764*^9, 
  3.8063409100158606`*^9}, {3.806340964998659*^9, 3.806341019527624*^9}, {
  3.8064135035812583`*^9, 3.8064135217309246`*^9}, {3.8064142506694403`*^9, 
  3.8064143441045012`*^9}, {3.806655437254679*^9, 3.8066554387438984`*^9}},
 CellLabel->"In[182]:=",
 CellID->900120093,ExpressionUUID->"ffb1776d-c968-44a3-b257-d439cffc2a6f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LegendInsideQ", "[", 
   RowBox[{"Placed", "[", "\[IndentingNewLine]", 
    RowBox[{
    "_", ",", "\[IndentingNewLine]", "pos_", ",", "\[IndentingNewLine]", 
     "___"}], "\[IndentingNewLine]", "]"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"AllTrue", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"First", "@", 
     RowBox[{"placedHelper", "@", "pos"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Apply", "[", "coordInsideQ", "]"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LegendInsideQ", "[", "_", "]"}], ":=", "\[IndentingNewLine]", 
  "False"}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.779962844209722*^9, 3.779962895354743*^9}, {
   3.7799629326308765`*^9, 3.779962934195877*^9}, {3.7799629939173417`*^9, 
   3.7799630898278737`*^9}, {3.7975315873833847`*^9, 3.797531613301205*^9}, {
   3.7975316900058107`*^9, 3.7975317375728745`*^9}, {3.79753193536493*^9, 
   3.7975319709660444`*^9}, {3.797532134164709*^9, 3.7975321532893786`*^9}, {
   3.7975321902399883`*^9, 3.7975321911239324`*^9}, {3.7975322464758415`*^9, 
   3.7975322512354317`*^9}, {3.7975322938928003`*^9, 3.797532321219944*^9}, {
   3.797532477491974*^9, 3.797532479676828*^9}, {3.7975337450528164`*^9, 
   3.797533781253725*^9}, {3.7975338299720993`*^9, 3.79753383698802*^9}, 
   3.797534346097329*^9, {3.7980307881370487`*^9, 3.798030789770029*^9}, {
   3.80630699513538*^9, 3.806307081986418*^9}, {3.8063071142505255`*^9, 
   3.80630711538053*^9}, {3.8063071997252235`*^9, 3.8063071998842278`*^9}, {
   3.80641388593423*^9, 3.8064139777340865`*^9}, {3.8064142006965356`*^9, 
   3.8064142387816477`*^9}, {3.806414421212536*^9, 3.806414428425022*^9}},
 CellLabel->"In[183]:=",
 CellID->763314989,ExpressionUUID->"a62347c1-634b-41a6-869d-3c2afbf5b1fe"],

Cell[CellGroupData[{

Cell["CoordinatesTool utilities", "Subsubsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7990548378438053`*^9, 3.799054845939848*^9}, {
  3.806249348200491*^9, 3.8062493494325085`*^9}},
 CellLabel->"In[41]:=",
 CellID->260816754,ExpressionUUID->"3948634d-5eca-4def-b5c9-0227fc705cda"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ResolveCoordinatesTool", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<CopiedValueFunction\>\"", "\[Rule]", "Identity"}], ",", 
      RowBox[{"\"\<DisplayFunction\>\"", "\[Rule]", "Automatic"}]}], "}"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ResolveCoordinatesTool", "[", "Automatic", "]"}], "[", "_", "]"}],
   ":=", "\[IndentingNewLine]", "Identity"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ResolveCoordinatesTool", "[", 
    RowBox[{"OptionsPattern", "[", "]"}], "]"}], "[", 
   RowBox[{"cvf", ":", "\"\<CopiedValueFunction\>\""}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Replace", "[", 
   RowBox[{
    RowBox[{"OptionValue", "@", "cvf"}], ",", 
    RowBox[{"Automatic", "\[Rule]", "Identity"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ResolveCoordinatesTool", "[", 
     RowBox[{"OptionsPattern", "[", "]"}], "]"}], "[", 
    RowBox[{"df", ":", "\"\<DisplayFunction\>\""}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Replace", "[", 
    RowBox[{
     RowBox[{"OptionValue", "@", "df"}], ",", 
     RowBox[{"Automatic", "\[Rule]", 
      RowBox[{"OptionValue", "@", "\"\<CopiedValueFunction\>\""}]}]}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "get", " ", "CoordinateToolOptions", " ", "from", " ", "a", " ", 
     "Graphics", " ", 
     RowBox[{"object", ".", " ", "Since"}], " ", "the", " ", "setting", " ", 
     "can", " ", "be", " ", "directly", " ", "inside", " ", "the", " ", 
     "Graphics", " ", "or", " ", "inside", " ", "Method"}], ",", 
    RowBox[{"we", " ", "need", " ", "to", " ", "combine", " ", "both", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
       "and", " ", "handle", " ", "Automatic", " ", "settings", " ", "for", 
        " ", "both", " ", "Method"}], ",", 
       RowBox[{
       "CoordinateToolOptions", " ", "and", " ", "DisplayFunction", " ", 
        "along", " ", "the", " ", "way"}]}]}]}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetCoordinatesToolOptions", "[", "gr_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"ResolveCoordinatesTool", "@", 
   RowBox[{"GraphicsOpt", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FilterRules", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"GraphicsOpt", "[", 
            RowBox[{"gr", ",", "Method"}], "]"}], ",", 
           RowBox[{"Automatic", "\[Rule]", 
            RowBox[{"{", "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
         "CoordinatesToolOptions"}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Options", "@", "gr"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", "CoordinatesToolOptions"}], "\[IndentingNewLine]",
     "]"}]}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.779963262219473*^9, 3.779963262227968*^9}, {
  3.779963483135195*^9, 3.7799634847521935`*^9}, {3.7799635766945276`*^9, 
  3.779963601940672*^9}, {3.798030805716728*^9, 3.798030810790824*^9}},
 CellLabel->"In[185]:=",
 CellID->190229175,ExpressionUUID->"2324a58c-4bf3-4a62-a520-e6ef2627b5ed"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Grid-Specification utilities", "Subsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7990548572272673`*^9, 3.799054864368679*^9}, {
  3.863450777731318*^9, 3.8634507786000953`*^9}},
 CellLabel->"In[6]:=",
 CellID->919750589,ExpressionUUID->"03326429-2404-44c3-b912-489e077ae9f0"],

Cell[BoxData[{
 RowBox[{"implicitAutomatic", ";"}], "\[IndentingNewLine]", 
 RowBox[{"unspecified", ";"}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.79862802820148*^9, 3.7986280384789267`*^9}, {
  3.7986396855324483`*^9, 3.798639690298009*^9}},
 CellLabel->"In[190]:=",
 CellID->900218393,ExpressionUUID->"917681e5-f024-4673-9392-3e36465536bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LastExplicit", "[", "specs_", "]"}], ":=", 
  RowBox[{"FirstCase", "[", 
   RowBox[{
    RowBox[{"Reverse", "@", "specs"}], ",", 
    RowBox[{"Except", "@", "implicitAutomatic"}], ",", "implicitAutomatic"}], 
   "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7986415949822383`*^9, 3.798641647591231*^9}},
 CellLabel->"In[192]:=",
 CellID->378427751,ExpressionUUID->"85379755-4147-431b-818e-d1fd8bea5f2a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExpandSeqSpec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"spec_", ",", 
      RowBox[{"rules", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"_Integer", "\[Rule]", "_"}], ")"}], ".."}], "}"}]}]}], 
     "}"}], ",", "n_", ",", "m_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"#2", "===", "unspecified"}], ",", "\[IndentingNewLine]", "#", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"m", "@", 
        RowBox[{"{", "##", "}"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ExpandSeqSpec", "[", 
       RowBox[{"spec", ",", "n", ",", "m"}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"unspecified", ",", "n"}], "]"}], ",", "rules"}], "]"}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ExpandSeqSpec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"spec_", ",", 
      RowBox[{"rule", ":", 
       RowBox[{"(", 
        RowBox[{"_Integer", "\[Rule]", "_"}], ")"}]}]}], "}"}], ",", "n_", 
    ",", "m_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ExpandSeqSpec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"spec", ",", 
      RowBox[{"{", "rule", "}"}]}], "}"}], ",", "n", ",", "m"}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ExpandSeqSpec", "[", 
   RowBox[{
    RowBox[{"rules", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_Integer", "\[Rule]", "_"}], ")"}], ".."}], "}"}]}], ",", 
    "n_", ",", "m_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ExpandSeqSpec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "rules"}], "}"}], ",", "n", ",", "m"}], 
   "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ExpandSeqSpec", "[", 
   RowBox[{
    RowBox[{"rule", ":", 
     RowBox[{"(", 
      RowBox[{"_Integer", "\[Rule]", "_"}], ")"}]}], ",", "n_", ",", "m_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ExpandSeqSpec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"{", "rule", "}"}]}], "}"}], ",", "n", ",", "m"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandSeqSpec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"start___", ",", 
      RowBox[{"cycle", ":", 
       RowBox[{"{", "__", "}"}]}], ",", "end___"}], "}"}], ",", "n_", ",", 
    "_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"rem", "=", 
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{"n", "-", 
         RowBox[{"Length", "@", 
          RowBox[{"{", "start", "}"}]}]}], ",", "0"}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Take", "[", 
       RowBox[{
        RowBox[{"{", "start", "}"}], ",", 
        RowBox[{"UpTo", "@", "n"}]}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PadRight", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"Max", "[", 
         RowBox[{
          RowBox[{"rem", "-", 
           RowBox[{"Length", "@", 
            RowBox[{"{", "end", "}"}]}]}], ",", "0"}], "]"}], ",", "cycle"}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Take", "[", 
       RowBox[{
        RowBox[{"{", "end", "}"}], ",", 
        RowBox[{"-", 
         RowBox[{"Min", "[", 
          RowBox[{
           RowBox[{"Length", "@", 
            RowBox[{"{", "end", "}"}]}], ",", "rem"}], "]"}]}]}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ExpandSeqSpec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"start___", ",", 
      RowBox[{"{", "}"}], ",", "end___"}], "}"}], ",", "n_", ",", "m_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ExpandSeqSpec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"start", ",", 
      RowBox[{"{", "implicitAutomatic", "}"}], ",", "end"}], "}"}], ",", "n", 
    ",", "m"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ExpandSeqSpec", "[", 
   RowBox[{
    RowBox[{"{", "start___", "}"}], ",", "n_", ",", "m_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"ExpandSeqSpec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"start", ",", 
      RowBox[{"{", "}"}]}], "}"}], ",", "n", ",", "m"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ExpandSeqSpec", "[", 
   RowBox[{"spec_", ",", "n_", ",", "m_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"ExpandSeqSpec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"{", "spec", "}"}], "}"}], ",", "n", ",", "m"}], 
   "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7799633588552055`*^9, 3.779963364842314*^9}, {
  3.77996348967093*^9, 3.7799635150322313`*^9}, {3.7979392772777777`*^9, 
  3.797939303071189*^9}, {3.7980075125543466`*^9, 3.7980075279557943`*^9}, {
  3.7980077258529177`*^9, 3.7980077381229877`*^9}, {3.798007794468914*^9, 
  3.798007840398009*^9}, {3.7986381945894527`*^9, 3.798638313626467*^9}, {
  3.7986396598000717`*^9, 3.7986397733715153`*^9}, {3.7986406545876255`*^9, 
  3.798640676575621*^9}, {3.7986407090130544`*^9, 3.7986407162375765`*^9}, {
  3.7986407749206724`*^9, 3.798640776113659*^9}, {3.798704132098526*^9, 
  3.7987041363823633`*^9}, {3.7987046442025995`*^9, 3.798704645038617*^9}, {
  3.798704833637868*^9, 3.798704865585907*^9}, {3.798705159074791*^9, 
  3.7987051788365235`*^9}},
 CellLabel->"In[193]:=",
 CellID->790853506,ExpressionUUID->"f23eddde-c58c-4fe0-994e-cec57548260f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Expand2DSpec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"wspec_", ":", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"hspec_", ":", 
       RowBox[{"{", "}"}]}], ",", "___"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}], ",", "merger_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ExpandSeqSpec", "[", 
     RowBox[{"wspec", ",", "m", ",", "merger"}], "]"}], ",", 
    RowBox[{"ExpandSeqSpec", "[", 
     RowBox[{"hspec", ",", "n", ",", "merger"}], "]"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"Expand2DSpec", "[", 
   RowBox[{"spec_", ",", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}], ",", "merger_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Expand2DSpec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"spec", ",", "spec"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", ",", "n"}], "}"}], ",", "merger"}], "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7799633588552055`*^9, 3.779963363541315*^9}, {
  3.7799635175997033`*^9, 3.779963519917706*^9}, {3.798639795222954*^9, 
  3.7986398112420225`*^9}, {3.798704709441111*^9, 3.7987047308287354`*^9}, {
  3.7987047822354984`*^9, 3.7987048176614943`*^9}, {3.7987406427264886`*^9, 
  3.7987406555554876`*^9}},
 CellLabel->"In[201]:=",
 CellID->486254629,ExpressionUUID->"2ee887ac-f70b-498a-9bee-14f9813106c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExpandGridSpec", "[", 
   RowBox[{"spec_", ",", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}], ",", "merger_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"wspec", ",", "hspec"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"wspec", ",", "hspec"}], "}"}], "=", 
      RowBox[{"Expand2DSpec", "[", 
       RowBox[{"spec", ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], ",", "merger"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"merger", "@*", "List"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Transpose", "@", 
          RowBox[{"Table", "[", 
           RowBox[{"hspec", ",", "m"}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"Table", "[", 
          RowBox[{"wspec", ",", "n"}], "]"}]}], "\[IndentingNewLine]", "}"}], 
       ",", "\[IndentingNewLine]", "2"}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ExpandGridSpec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"wspec_", ",", "hspec_", ",", "posRule_Rule"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}], ",", "merger_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"ExpandGridSpec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"wspec", ",", "hspec", ",", 
      RowBox[{"{", "posRule", "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m", ",", "n"}], "}"}], ",", "merger"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandGridSpec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"wspec_", ",", "hspec_", ",", 
      RowBox[{"posRules", ":", 
       RowBox[{"{", "__Rule", "}"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}], ",", "merger_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"grid", "=", 
      RowBox[{"ExpandGridSpec", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"wspec", ",", "hspec"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], ",", "merger"}], "]"}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"grid", "=", 
         RowBox[{"MapAt", "[", 
          RowBox[{
           RowBox[{"val", "\[Function]", 
            RowBox[{"merger", "@", 
             RowBox[{"{", 
              RowBox[{"val", ",", "#2"}], "}"}]}]}], ",", "grid", ",", 
           RowBox[{"Span", "@@@", "#"}]}], "]"}]}], ")"}], "&"}], "@@@", 
      "posRules"}], ";", "\[IndentingNewLine]", "grid"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7799633210117702`*^9, 3.77996332102777*^9}, {
   3.7799635239437046`*^9, 3.77996356520061*^9}, 3.77996365511705*^9, {
   3.7975079699268227`*^9, 3.797507982642593*^9}, {3.7985497200812044`*^9, 
   3.7985497208072004`*^9}, {3.7986398458120775`*^9, 
   3.7986398465680747`*^9}, {3.798639933496648*^9, 3.7986400113484063`*^9}, {
   3.798640126668967*^9, 3.7986401269109645`*^9}, 3.7986401620207605`*^9, {
   3.7986402421791*^9, 3.7986403642800646`*^9}, {3.798641018968279*^9, 
   3.7986411465584574`*^9}, {3.7987037181972065`*^9, 
   3.7987037209789453`*^9}, {3.798740598253488*^9, 3.798740610693488*^9}},
 CellLabel->"In[203]:=",
 CellID->906007813,ExpressionUUID->"218e669c-6c21-4a46-89f9-fae5d9766bc6"]
}, Closed]],

Cell[CellGroupData[{

Cell["PlotGrid Option utilities", "Subsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7990549005225782`*^9, 3.7990549104587326`*^9}},
 CellLabel->"In[17]:=",
 CellID->529696902,ExpressionUUID->"acee532d-e461-47c2-9fb8-89649906cb9f"],

Cell[CellGroupData[{

Cell["ShowFrameLabels", "Subsubsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8067323008370323`*^9, 3.806732304629363*^9}},
 CellLabel->"In[1]:=",
 CellID->569693012,ExpressionUUID->"325db50e-c57d-4bb5-876f-e8f028d4d7c9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ExpandFrameLabelSpec", "[", 
   RowBox[{"Directive", "[", "spec___", "]"}], "]"}], ":=", 
  RowBox[{"ExpandFrameLabelSpec", "[", 
   RowBox[{"{", "spec", "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ExpandFrameLabelSpec", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"def", ":", 
      RowBox[{"Except", "[", "_Rule", "]"}], ":", "implicitAutomatic"}], ",", 
     "rules___Rule"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"#", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Lookup", "[", 
        RowBox[{
         RowBox[{"<|", "rules", "|>"}], ",", "#", ",", "def"}], "]"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"All", "\[Rule]", "True"}], ",", 
         RowBox[{"None", "\[Rule]", "False"}]}], "}"}]}], ")"}]}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"Left", ",", "Right", ",", "Bottom", ",", "Top"}], 
    "}"}]}]}], "\n", 
 RowBox[{
  RowBox[{"ExpandFrameLabelSpec", "[", 
   RowBox[{"s", ":", 
    RowBox[{
    "Automatic", "|", "Full", "|", "True", "|", "False", "|", "All", "|", 
     "None", "|", "implicitAutomatic"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"ExpandFrameLabelSpec", "[", 
   RowBox[{"{", "s", "}"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"ExpandFrameLabelSpec", "[", 
   RowBox[{"{", 
    RowBox[{"h_", ",", "v_"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Left", "\[Rule]", "v"}], ",", 
    RowBox[{"Right", "\[Rule]", "v"}], ",", 
    RowBox[{"Bottom", "\[Rule]", "h"}], ",", 
    RowBox[{"Top", "\[Rule]", "h"}]}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"ExpandFrameLabelSpec", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"l_", ",", "r_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b_", ",", "t_"}], "}"}]}], "}"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Left", "\[Rule]", "l"}], ",", 
    RowBox[{"Right", "\[Rule]", "r"}], ",", 
    RowBox[{"Bottom", "\[Rule]", "b"}], ",", 
    RowBox[{"Top", "\[Rule]", "t"}]}], "}"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.779962844209722*^9, 3.779962895354743*^9}, {
  3.7799629326308765`*^9, 3.779962934195877*^9}, {3.7799629939173417`*^9, 
  3.779963103589327*^9}, {3.798641453126975*^9, 3.798641455269467*^9}, {
  3.7987050884237366`*^9, 3.7987050903637342`*^9}, {3.7987404348234873`*^9, 
  3.7987404520534873`*^9}, {3.7990568735078773`*^9, 3.799056887187546*^9}},
 CellLabel->"In[206]:=",
 CellID->558972006,ExpressionUUID->"378f005d-fcfa-49b6-8813-0bb50ad9906f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$FrameLabelMerger", "=", 
   RowBox[{
    RowBox[{"Map", "[", "ExpandFrameLabelSpec", "]"}], "/*", 
    RowBox[{"Merge", "[", "LastExplicit", "]"}], "/*", "Normal"}]}], 
  ";"}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.805286923959558*^9, 3.805286930736269*^9}},
 CellLabel->"In[211]:=",
 CellID->975237799,ExpressionUUID->"f89dc21f-6015-4cac-aa86-88bdc93d11c8"]
}, Closed]],

Cell[CellGroupData[{

Cell["ApplyStructureToOption", "Subsubsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.806946722533886*^9, 3.8069467272306056`*^9}, {
  3.806947320003011*^9, 3.8069473311290164`*^9}},
 CellLabel->"In[7]:=",
 CellID->106977048,ExpressionUUID->"94633074-2ade-44be-83ff-d79475fd2640"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SidedFrameOptionFromWrappers", "[", 
   RowBox[{"wrappers_", ",", "opt_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Map", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cases", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Frame", "[", 
       RowBox[{"_", ",", "opts__"}], "]"}], "\[RuleDelayed]", 
      "\[IndentingNewLine]", 
      RowBox[{"Replace", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"opt", "/.", 
         RowBox[{"{", "opts", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"opt", "\[Rule]", "Nothing"}], ",", "\[IndentingNewLine]", 
          RowBox[{"val_", "\[RuleDelayed]", 
           RowBox[{
            RowBox[{"NormalizeGraphicsOpt", "[", "\"\<Custom\>\"", "]"}], "@",
             "val"}]}]}], "\[IndentingNewLine]", "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", "wrappers", ",", "\[IndentingNewLine]", 
    RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8069545953112803`*^9, 3.8069546233552437`*^9}, {
  3.806992657231373*^9, 3.806992677481101*^9}, {3.8069928784540367`*^9, 
  3.806992896739628*^9}, {3.806993453221394*^9, 3.806993453842805*^9}, {
  3.8070141249392543`*^9, 3.8070141278313627`*^9}},
 CellLabel->"In[212]:=",
 CellID->187238631,ExpressionUUID->"cfcb3ad9-66b2-4921-8137-1e4156a397a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FillInStructure", "[", 
   RowBox[{"structure_", ",", "fromWrap_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"grid", "=", "fromWrap"}], ",", "h"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"grid", "\[LeftDoubleBracket]", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"Span", "@@@", 
            RowBox[{"Transpose", "@", 
             RowBox[{"Accumulate", "@", 
              RowBox[{"{", "##", "}"}]}]}]}]}], "\[RightDoubleBracket]"}], 
         "=", 
         RowBox[{"h", "[", 
          RowBox[{"Extract", "[", 
           RowBox[{"fromWrap", ",", "#"}], "]"}], "]"}]}], ")"}], "&"}], "@@@",
       "structure"}], ";", "\[IndentingNewLine]", 
     RowBox[{"grid", "/.", 
      RowBox[{"h", "\[Rule]", "Identity"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8069505810917683`*^9, 3.8069506382832623`*^9}, {
  3.806951723729892*^9, 3.806951739089794*^9}},
 CellLabel->"In[213]:=",
 CellID->102496335,ExpressionUUID->"f5f59878-6fea-4db7-88eb-3d76f08fed3e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ListToPerSideLists", "[", 
   RowBox[{"{", "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "2", ",", "2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListToPerSideLists", "[", "l_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Transpose", "[", 
   RowBox[{"l", ",", 
    RowBox[{"{", 
     RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8069521883098564`*^9, 3.80695223784076*^9}},
 CellLabel->"In[214]:=",
 CellID->57346187,ExpressionUUID->"173fa9ec-c27a-4589-aa94-2dfde032fc43"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ApplyStructureToOption", "::", "usage"}], "=", 
   "\"\<ApplyStructureToOption[structure,opt,fromWrap,m] merges the relevant \
settings for a sided property based on the structure of the grid, where \
settings come from a Spacings-like option and per-side wrappers\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplyStructureToOption", "[", 
   RowBox[{"structure_", ",", "opt_", ",", "fromWrap_", ",", "m_"}], "]"}], ":=",
   "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"h", ",", "\[IndentingNewLine]", 
      RowBox[{"filledFromWrap", "=", 
       RowBox[{"FillInStructure", "[", "\[IndentingNewLine]", 
        RowBox[{"structure", ",", "\[IndentingNewLine]", 
         RowBox[{"Map", "[", "\[IndentingNewLine]", 
          RowBox[{
          "ListToPerSideLists", ",", "\[IndentingNewLine]", "fromWrap", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"m", "@*", "Prepend"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Extract", "[", 
                   RowBox[{"filledFromWrap", ",", "#"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"Prepend", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#2", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "+", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "3"}], "}"}]}], ",", "All"}], "]"}]}], 
                    "]"}], "&"}], ",", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "get", " ", "settings", " ", "for", " ", "opposite", " ", 
                    "sides", " ", "of", " ", "neighbors"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"LookupNeighbors", "[", 
                    RowBox[{"filledFromWrap", ",", "##"}], "]"}], ",", 
                    RowBox[{"Null", "\[Rule]", "Nothing"}], ",", 
                    RowBox[{"{", "3", "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}],
                  "\[IndentingNewLine]", "}"}], "//", 
                RowBox[{"MapAt", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Map", "[", 
                    RowBox[{"h", ",", "#", ",", 
                    RowBox[{"{", "3", "}"}]}], "]"}], "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "All"}], "}"}]}], "}"}]}], "]"}]}], ",",
                "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], 
              "\[IndentingNewLine]", "]"}], "//", "\[IndentingNewLine]", 
             RowBox[{"MapAt", "[", 
              RowBox[{"Reverse", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "1"}], "}"}]}], "}"}]}], "]"}]}], "//", 
            "\[IndentingNewLine]", 
            RowBox[{"Map", "@", 
             RowBox[{"Map", "@", "Flatten"}]}]}], "//", 
           RowBox[{"ReplaceAll", "[", 
            RowBox[{"h", "\[Rule]", "Identity"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"opt", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{
                  RowBox[{
                  "#2", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "+", "1"}]}], "}"}]}]}], 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"opt", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "+", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "#2", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "+", "1"}], ",", "0"}], 
                "}"}]}]}], "\[RightDoubleBracket]"}]}], "}"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", "2"}], 
       "\[IndentingNewLine]", "]"}], "&"}], "@@@", "structure"}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8069467322395587`*^9, 3.806946806755721*^9}, {
   3.8069468664124975`*^9, 3.8069469183644514`*^9}, {3.8069469688252096`*^9, 
   3.8069471592559586`*^9}, {3.8069473375724955`*^9, 
   3.8069473457440486`*^9}, {3.806948158113969*^9, 3.806948183280465*^9}, {
   3.8069510005760736`*^9, 3.8069510980419903`*^9}, {3.806951132631529*^9, 
   3.806951241553994*^9}, {3.8069512794614973`*^9, 3.806951284358388*^9}, {
   3.8069513193065014`*^9, 3.806951345932453*^9}, {3.806951542280517*^9, 
   3.806951579490591*^9}, {3.8069518388977003`*^9, 3.80695183965737*^9}, {
   3.8069519213641677`*^9, 3.8069519221194053`*^9}, {3.8069519738991547`*^9, 
   3.806952102509557*^9}, {3.806952145160909*^9, 3.8069521479753094`*^9}, {
   3.806952244577512*^9, 3.806952341629689*^9}, {3.8069525596744537`*^9, 
   3.806952612030199*^9}, {3.8069526703229356`*^9, 3.8069526784001875`*^9}, {
   3.8069527333223495`*^9, 3.8069527493434753`*^9}, {3.8069529129874077`*^9, 
   3.8069529149431496`*^9}, {3.806953004953852*^9, 3.806953127767511*^9}, 
   3.8070139783725243`*^9, {3.8070258671138306`*^9, 3.8070258678525076`*^9}, {
   3.8070259103196845`*^9, 3.8070259410815396`*^9}, {3.807026063406537*^9, 
   3.807026067071908*^9}, {3.807026134466938*^9, 3.8070261649714975`*^9}, {
   3.80702621054038*^9, 3.807026216184755*^9}, {3.807028123629163*^9, 
   3.8070281418008184`*^9}, {3.8070282742429056`*^9, 
   3.8070283627567773`*^9}, {3.8070284285769577`*^9, 
   3.8070284355562057`*^9}, {3.807028506253207*^9, 3.8070285292642546`*^9}, {
   3.8070285633900003`*^9, 3.8070285648258066`*^9}, {3.807028604279742*^9, 
   3.807028636943739*^9}},
 CellLabel->"In[216]:=",
 CellID->179999806,ExpressionUUID->"d0eb8f25-d061-4c36-8a38-d2ea80367664"]
}, Closed]],

Cell[CellGroupData[{

Cell["HideOuterTickLabels", "Subsubsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.806732313991931*^9, 3.806732318362837*^9}},
 CellLabel->"In[7]:=",
 CellID->697357334,ExpressionUUID->"f8cdf53c-92dd-4786-b36e-0448b5f4fea0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$OuterLabelModeSpec", "=", 
   RowBox[{
   "Automatic", "|", "Full", "|", "False", "|", "True", "|", "All", "|", 
    "None"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$OuterLabelSideSpec", "=", 
   RowBox[{
   "Automatic", "|", "Left", "|", "Right", "|", "Bottom", "|", "Top", "|", 
    "First", "|", "Last", "|", "All", "|", "None"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$OuterLabelMarginSpec", "=", 
   RowBox[{
    RowBox[{"_", "?", "NumericQ"}], "|", 
    RowBox[{"Scaled", "@", 
     RowBox[{"_", "?", "NumericQ"}]}]}]}], ";"}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.797939004316248*^9, 3.797939038262279*^9}, {
  3.7979395549587736`*^9, 3.7979395728388815`*^9}, {3.797940030377258*^9, 
  3.7979400368482704`*^9}, {3.798006606240053*^9, 3.7980066291938133`*^9}, {
  3.7986278598354387`*^9, 3.798627861624469*^9}},
 CellLabel->"In[218]:=",
 CellID->334662486,ExpressionUUID->"5e0198bb-eacd-48d5-b0c2-0929efcbcf2b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"iExpandOuterLabelSpec", "[", 
   RowBox[{"Directive", "[", "spec___", "]"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"iExpandOuterLabelSpec", "[", 
   RowBox[{"{", "spec", "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iExpandOuterLabelSpec", "[", "implicitAutomatic", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
   "implicitAutomatic", ",", "implicitAutomatic", ",", "implicitAutomatic"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iExpandOuterLabelSpec", "[", 
   RowBox[{"spec", ":", 
    RowBox[{"Except", "@", "_List"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"iExpandOuterLabelSpec", "[", 
   RowBox[{"{", "spec", "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iExpandOuterLabelSpec", "[", 
   RowBox[{"spec", ":", 
    RowBox[{"{", 
     RowBox[{"_", ",", "_", ",", "_"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", "spec"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iExpandOuterLabelSpec", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"s", ":", "$OuterLabelSideSpec", ":", "implicitAutomatic"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"Longest", "[", 
      RowBox[{"m", ":", "$OuterLabelModeSpec", ":", "implicitAutomatic"}], 
      "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
     "mar", ":", "$OuterLabelMarginSpec", ":", "implicitAutomatic"}]}], 
    "\[IndentingNewLine]", "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{"s", ",", "m", ",", "mar"}], "}"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7986278653586607`*^9, 3.798627961965623*^9}, {
  3.7986280514561696`*^9, 3.7986280858717175`*^9}, {3.798693411845703*^9, 
  3.798693482091202*^9}, {3.7986935880810394`*^9, 3.7986936021081963`*^9}, {
  3.7987042113427105`*^9, 3.79870421369471*^9}, {3.7987045158995647`*^9, 
  3.7987045689821367`*^9}, {3.798705103676568*^9, 3.798705122028708*^9}, {
  3.798740459645507*^9, 3.798740471476487*^9}, {3.8067315473986015`*^9, 
  3.806731555135108*^9}, {3.8067316150891514`*^9, 3.8067316861903296`*^9}, {
  3.8067317670631876`*^9, 3.806731783095539*^9}, {3.8067321779010906`*^9, 
  3.8067321894761243`*^9}},
 CellLabel->"In[221]:=",
 CellID->652936861,ExpressionUUID->"0d6befdb-a623-4ead-9aae-84f462bd4319"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"postProcessOuterLabelSpec", "[", 
    RowBox[{"hor_", ",", "speed_"}], "]"}], "[", 
   RowBox[{"{", 
    RowBox[{"s_", ",", "m_", ",", "mar_"}], "}"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Replace", "[", 
     RowBox[{"s", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Automatic", "\[Rule]", 
         RowBox[{"If", "[", 
          RowBox[{"hor", ",", "First", ",", "Last"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"Left", "|", "Top"}], "\[Rule]", "First"}], ",", 
        RowBox[{
         RowBox[{"Right", "|", "Bottom"}], "\[Rule]", "Last"}], ",", 
        RowBox[{"All", "\[Rule]", "True"}], ",", 
        RowBox[{"None", "\[Rule]", "False"}]}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Replace", "[", 
     RowBox[{"m", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"All", "\[Rule]", "True"}], ",", 
        RowBox[{"None", "\[Rule]", "False"}]}], "}"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"mar", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Automatic", "\[Rule]", 
        RowBox[{"If", "[", 
         RowBox[{"speed", ",", 
          RowBox[{"-", "\[Infinity]"}], ",", "10"}], "]"}]}], ",", 
       RowBox[{"Scaled", "\[Rule]", "\"\<Scaled\>\""}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "}"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7986947629447*^9, 3.7986948453793187`*^9}, 
   3.79870345541363*^9, {3.798705568474016*^9, 3.798705573391139*^9}, {
   3.7987072919182997`*^9, 3.798707301817972*^9}, {3.7987320793311157`*^9, 
   3.798732086866091*^9}, {3.7990612135396214`*^9, 3.799061228618767*^9}, {
   3.807008413686846*^9, 3.807008424092625*^9}, 3.8154552897389817`*^9},
 CellLabel->"In[226]:=",
 CellID->435925896,ExpressionUUID->"e0cf4751-4f09-404a-8bd0-0312d5176073"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandOuterLabelSpec", "[", 
   RowBox[{"structure_", ",", "spec_", ",", "fromWrap_", ",", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}], ",", "speed_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ApplyStructureToOption", "[", "\[IndentingNewLine]", 
      RowBox[{"structure", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Expand2DSpec", "[", "\[IndentingNewLine]", 
         RowBox[{"spec", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"m", ",", "n"}], "}"}], "-", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Map", "[", "iExpandOuterLabelSpec", "]"}], "/*", 
           RowBox[{"MapThread", "[", 
            RowBox[{"LastExplicit", "@*", "List"}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], "//", "\[IndentingNewLine]", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{"ArrayPad", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"1", ",", "1"}], "}"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"False", ",", "False", ",", "0"}], "}"}], "}"}]}], 
           "]"}], "&"}], "]"}]}], 
       RowBox[{"(*", " ", 
        RowBox[{
        "add", " ", "settings", " ", "for", " ", "outer", " ", "edges"}], " ",
         "*)"}], ",", "\[IndentingNewLine]", "fromWrap", ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Map", "[", "iExpandOuterLabelSpec", "]"}], "/*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{"LastExplicit", "@*", "List"}], ",", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "Full", ",", "Automatic"}], "}"}], 
              "]"}], "@", "#"}]}], "]"}], "&"}], ")"}]}]}], 
      "\[IndentingNewLine]", "]"}], "//", "\[IndentingNewLine]", 
     RowBox[{"Query", "[", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"resolve", " ", "Automatic", " ", "side", " ", "spec"}], " ",
          "&"}], " ", 
        RowBox[{"None", "/", "All"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"All", ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"1", "\[Rule]", 
          RowBox[{"Map", "@", 
           RowBox[{"postProcessOuterLabelSpec", "[", 
            RowBox[{"True", ",", "speed"}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"2", "\[Rule]", 
          RowBox[{"Map", "@", 
           RowBox[{"postProcessOuterLabelSpec", "[", 
            RowBox[{"False", ",", "speed"}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], "//", 
    "\[IndentingNewLine]", 
    RowBox[{"MapAt", "[", 
     RowBox[{
      RowBox[{"Replace", "@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"First", "\[Rule]", "False"}], ",", 
         RowBox[{"Last", "\[Rule]", "True"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"All", ",", "1", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"All", ",", "2", ",", "2", ",", "1"}], "}"}]}], "}"}]}], 
     "]"}]}], "//", 
   RowBox[{"(*", " ", 
    RowBox[{"resolve", " ", 
     RowBox[{"First", "/", "Last"}], " ", "specs"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MapAt", "[", 
    RowBox[{
     RowBox[{"Replace", "@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"First", "\[Rule]", "True"}], ",", 
        RowBox[{"Last", "\[Rule]", "False"}]}], "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"All", ",", "1", ",", "2", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"All", ",", "2", ",", "1", ",", "1"}], "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.797939677540217*^9, 3.797939787288453*^9}, {
   3.7979398647063103`*^9, 3.7979398727130737`*^9}, {3.797939936006235*^9, 
   3.7979399427312436`*^9}, 3.7979400412507772`*^9, {3.7979401917010765`*^9, 
   3.79794021192636*^9}, {3.798006696406845*^9, 3.7980067390190086`*^9}, {
   3.798006930874071*^9, 3.798007003341826*^9}, {3.798007040541437*^9, 
   3.7980071062561817`*^9}, {3.7980071409717493`*^9, 
   3.7980072900368977`*^9}, {3.7980074078109756`*^9, 3.798007435761608*^9}, {
   3.798008169691399*^9, 3.7980081902343545`*^9}, {3.798008245223855*^9, 
   3.7980082454368544`*^9}, 3.7980308352778597`*^9, {3.798694119984521*^9, 
   3.798694157437854*^9}, {3.79869419829655*^9, 3.7986942318825145`*^9}, {
   3.798694297635391*^9, 3.7986943351056376`*^9}, {3.7986943725844727`*^9, 
   3.7986944236049843`*^9}, {3.798694456555959*^9, 3.798694591956923*^9}, {
   3.7986948559231234`*^9, 3.798694941531139*^9}, {3.798703798356041*^9, 
   3.7987037998454084`*^9}, {3.798704081497507*^9, 3.7987041077373786`*^9}, {
   3.7987048720384827`*^9, 3.79870487521154*^9}, {3.798705431482314*^9, 
   3.7987054978427258`*^9}, {3.7987056910500765`*^9, 3.798705691149078*^9}, {
   3.798705769725284*^9, 3.7987058015454454`*^9}, {3.798705857757301*^9, 
   3.7987058590876913`*^9}, {3.7987059047599583`*^9, 3.79870590834347*^9}, {
   3.7987059419473248`*^9, 3.798705964561874*^9}, {3.7987060773085394`*^9, 
   3.79870608510848*^9}, {3.7987062888722324`*^9, 3.7987063351538696`*^9}, {
   3.7987066418546724`*^9, 3.798706672060274*^9}, {3.7987067341144776`*^9, 
   3.798706773935502*^9}, {3.7987068095851517`*^9, 3.798706835907076*^9}, {
   3.798706868982983*^9, 3.798706874431564*^9}, {3.798707013174937*^9, 
   3.7987070148019495`*^9}, {3.798707103688902*^9, 3.798707110954342*^9}, {
   3.7987071707700405`*^9, 3.7987071841981487`*^9}, {3.7987073052236643`*^9, 
   3.7987075272389517`*^9}, {3.798716981678065*^9, 3.7987171302758956`*^9}, {
   3.798717162625531*^9, 3.7987171647985306`*^9}, 3.7987404096704874`*^9, {
   3.798740579860488*^9, 3.7987405815724893`*^9}, {3.798740666997488*^9, 
   3.79874070303852*^9}, {3.798740841079487*^9, 3.7987408657484875`*^9}, {
   3.8067318120002527`*^9, 3.806731817110119*^9}, {3.806731854984691*^9, 
   3.8067318805915885`*^9}, {3.806731987009469*^9, 3.8067320336937876`*^9}, {
   3.806732270534011*^9, 3.806732271019575*^9}, {3.8067693197326174`*^9, 
   3.8067693971447086`*^9}, {3.8067696958059855`*^9, 3.806769716384287*^9}, {
   3.806769765063324*^9, 3.806769770033046*^9}, 3.806769864444846*^9, {
   3.80694726952781*^9, 3.8069472758876567`*^9}, {3.8069477588504467`*^9, 
   3.8069477752265015`*^9}, {3.806947910580477*^9, 3.8069479261659403`*^9}, {
   3.8069480239003043`*^9, 3.806948104588691*^9}, {3.806953202405655*^9, 
   3.806953242416474*^9}, {3.80695333418626*^9, 3.80695336311119*^9}, {
   3.806953461140057*^9, 3.8069534624910774`*^9}, {3.8069535337103386`*^9, 
   3.8069535917170258`*^9}, {3.8069536534687743`*^9, 
   3.8069537054032483`*^9}, {3.8069542278874598`*^9, 3.806954229504492*^9}, {
   3.806954274935895*^9, 3.8069543077741113`*^9}, {3.806992369787755*^9, 
   3.8069923711122646`*^9}, {3.8069924175994244`*^9, 3.806992431897917*^9}, {
   3.8069924868679895`*^9, 3.806992487949341*^9}, {3.80699256374908*^9, 
   3.806992564568991*^9}, {3.806992772916074*^9, 3.8069927899382625`*^9}, {
   3.806992845341583*^9, 3.806992866136368*^9}, {3.8070081670714893`*^9, 
   3.8070081939792037`*^9}, {3.8070083903380423`*^9, 3.8070084049663553`*^9}},
 
 CellLabel->"In[227]:=",
 CellID->721795260,ExpressionUUID->"f9fef2e2-b5dd-423c-848d-27598c2eab1e"]
}, Closed]],

Cell[CellGroupData[{

Cell["MergeAxes", "Subsubsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.806732327619173*^9, 3.8067323359933453`*^9}},
 CellLabel->"In[11]:=",
 CellID->408637084,ExpressionUUID->"c6745fbb-a2dd-4252-ad35-9969cdd4662a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$NamedAxesMergeIcons", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<ZigZag\>\"", "\[Rule]", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CapForm", "[", "\"\<Square\>\"", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Style", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Line", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], ",", 
                 RowBox[{"Offset", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "#"}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Antialiasing", "\[Rule]", "False"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Line", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Offset", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "#"}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", 
               RowBox[{"Offset", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "#"}], "/", "2"}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"1.2", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Cut\>\"", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CapForm", "[", "\"\<Square\>\"", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Style", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Line", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], ",", 
                 RowBox[{"Offset", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "#"}], "/", "2"}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Antialiasing", "\[Rule]", "False"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Line", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Offset", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "#"}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"1.2", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Wave\>\"", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CapForm", "[", "\"\<Square\>\"", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Style", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Line", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], ",", 
                 RowBox[{"Offset", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "#"}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Antialiasing", "\[Rule]", "False"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Circle", "[", 
              RowBox[{
               RowBox[{"Offset", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "#"}], "/", "2"}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", 
               RowBox[{"Offset", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"#", "/", "2"}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "\[Pi]"}], ",", "0"}], "}"}]}], "]"}], "*)"}], 
            RowBox[{"BezierCurve", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Offset", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "#"}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", 
               RowBox[{"Offset", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "#"}], "/", "2"}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", 
               RowBox[{"Offset", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "#"}], " ", 
                    RowBox[{"3", "/", "5"}]}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"Offset", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "#"}], " ", "/", "3"}], ",", "0"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"Offset", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "#"}], " ", "/", "6"}], ",", "0"}], "}"}], 
                 ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"1.2", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Dotted\>\"", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CapForm", "[", "\"\<Square\>\"", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Style", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Line", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], ",", 
                 RowBox[{"Offset", "[", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "#"}], ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}]}], "]"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Antialiasing", "\[Rule]", "False"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"AbsoluteDashing", "@", 
             RowBox[{"{", 
              RowBox[{"1", ",", "3"}], "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"Line", "@", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Offset", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "#"}], ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"1.2", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Line\>\"", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"CapForm", "[", "\"\<Square\>\"", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Style", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Line", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}], "}"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Antialiasing", "\[Rule]", "False"}]}], 
             "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"AspectRatio", "\[Rule]", "Full"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}], ",", 
             RowBox[{"1.2", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "1"}], ",", "1"}], "}"}]}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}], "&"}], ")"}]}]}], 
    "\[IndentingNewLine]", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"#", "@", "40"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"80", ",", "40"}], "}"}]}]}], "]"}], "&"}], "/@", 
  "$NamedAxesMergeIcons"}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdxVkogwEAB/AlmdwRWxRbrrZaiHgxjMnSQlOSRlmprVwr5UpJX5oV2QMe
mLmvSW0kxYOpZa5Fjq2F0kyuZs41It9/D79+TEmTqM6HQqEwSFi6lVxlFj/z
hnMJKY418FtxguWsE1/NSboxN6V9BA+kFY5i1qfGe6UwfQJbCZkWGzPi9bg3
rtaA05Wht5iq2H7COQrd1DF5YnjYAl521roTqp95J/Pqb/wZuUTLI3/7odOx
TaFj4I/YfQ5mKsOLceNRcRn+26npwa8lVBXmCsuH8GFDvhqzZrULODtAt4JN
eyFrmOFxrGOrSW3E5/TkUzwwTrFgYtXf+8Ui7xqvWCQvWK4bduNLe4QHi7TB
v9h1J6fyyFtktiAsZ/NpOGa6IB4fmF1JuNTZnIrHZlTe3zMEmXhtMzAL61VM
LhaU3xdhopdTijfaKrz3RL1rCsgVXx1T2Ec5eIHZfWYLJirr7djXr8uBbf25
Dzhq9OYRq0fYE0Xk4ujdSfwPYX7+0g==
  "],
 CellLabel->"In[228]:=",
 CellID->787997724,ExpressionUUID->"ee41bf09-28c3-4d97-92e4-22edcb0b0296"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NormalizeMergePrimitive", "[", 
   RowBox[{"False", "|", "implicitAutomatic"}], "]"}], ":=", 
  "\[IndentingNewLine]", "False"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NormalizeMergePrimitive", "[", "None", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"None", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"None", ",", "0"}], "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NormalizeMergePrimitive", "[", 
   RowBox[{"Directive", "[", "spec__", "]"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"NormalizeMergePrimitive", "[", 
   RowBox[{"{", "spec", "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NormalizeMergePrimitive", "[", 
   RowBox[{"spec", ":", 
    RowBox[{"Except", "[", 
     RowBox[{"{", 
      RowBox[{"_", ",", 
       RowBox[{"_", "?", "NumericQ"}]}], "}"}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"NormalizeMergePrimitive", "[", 
   RowBox[{"{", 
    RowBox[{"spec", ",", "10"}], "}"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeMergePrimitive", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"name_String", "|", 
       RowBox[{"(", 
        RowBox[{"name_String", "\[Rule]", "size_"}], ")"}]}], ",", 
      RowBox[{"width_", "?", "NumericQ"}]}], "}"}], "]"}], "/;", 
   RowBox[{"KeyMemberQ", "[", 
    RowBox[{"$NamedAxesMergeIcons", ",", "name"}], "]"}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"ConstantArray", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"$NamedAxesMergeIcons", "[", "name", "]"}], "[", 
       RowBox[{
        RowBox[{"First", "@", 
         RowBox[{"{", 
          RowBox[{"size", ",", "10"}], "}"}]}], "/", "2"}], "]"}], ",", 
      "width"}], "}"}], ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NormalizeMergePrimitive", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"left_", ",", "right_"}], "}"}], ",", 
     RowBox[{"width_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"left", ",", "width"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{"right", ",", 
        RowBox[{"Automatic", "\[Rule]", "left"}]}], "]"}], ",", "width"}], 
     "}"}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NormalizeMergePrimitive", "[", 
   RowBox[{"{", 
    RowBox[{"prim_", ",", 
     RowBox[{"width_", "?", "NumericQ"}]}], "}"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"prim", ",", "width"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"implicitAutomatic", ",", "0"}], "}"}]}], "}"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8067548368242016`*^9, 3.806754998973421*^9}, {
  3.8067550405411797`*^9, 3.80675512426311*^9}, {3.80675515778819*^9, 
  3.8067551908763723`*^9}, {3.8067552221580143`*^9, 3.806755366129528*^9}, {
  3.8067554824868355`*^9, 3.8067555002008142`*^9}, {3.806755570248929*^9, 
  3.806755613960391*^9}, {3.8067584905109296`*^9, 3.806758522592267*^9}, {
  3.806773574729971*^9, 3.8067735932293444`*^9}, {3.8069543674648614`*^9, 
  3.8069543691322584`*^9}, {3.8069549364721165`*^9, 3.806954941833387*^9}, {
  3.8069956666164737`*^9, 3.8069956679843626`*^9}, {3.8069957098700714`*^9, 
  3.806995723078436*^9}, {3.8070074634127035`*^9, 3.8070074704441195`*^9}, {
  3.8070213561299706`*^9, 3.807021388170739*^9}, {3.8070222121863813`*^9, 
  3.807022224812987*^9}, {3.807022776746209*^9, 3.807022780045678*^9}},
 CellLabel->"In[230]:=",
 CellID->787433824,ExpressionUUID->"a3cc7e5f-be5f-4586-ad9c-80f04a9b5e38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ComputeCorners", "::", "usage"}], "=", 
   "\"\<ComputeCorners[item] computers the indices of the four corners of an \
element of the structure specification\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ComputeCorners", "[", 
   RowBox[{"{", 
    RowBox[{"pos_", ",", "size_"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pos", "+", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], 
      RowBox[{"(", 
       RowBox[{"size", "+", "1"}], ")"}]}], "-", "1"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", "1"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.825233558163843*^9, 3.825233638784239*^9}, {
   3.825233691396549*^9, 3.825233691776504*^9}, {3.8252340113114147`*^9, 
   3.825234037775473*^9}, 3.825234115743376*^9},
 CellLabel->"In[237]:=",
 CellID->815931685,ExpressionUUID->"5acca74d-076b-4809-af92-19e1b3a6d41a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ComputeCorners", "::", "usage"}], "=", 
   "\"\<ComputeCorners[structure,{m,n}] finds all points in the where four \
corners join, and returns the indices of the participating items and the \
relevant corner\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetCornerMembers", "[", 
   RowBox[{"structure_", ",", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"cor", "=", 
      RowBox[{"ComputeCorners", "/@", "structure"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Catenate", "@", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"pos", "=", 
           RowBox[{"Position", "[", 
            RowBox[{"cor", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}]}], "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "@", "pos"}], "\[NotEqual]", "4"}], ",", 
           "\[IndentingNewLine]", "Nothing", ",", "\[IndentingNewLine]", 
           "pos"}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"m", "-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"n", "-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}]}],
    "\[IndentingNewLine]", "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8252333598946424`*^9, 3.8252333950593753`*^9}, {
  3.8252334619116135`*^9, 3.8252334835373*^9}, {3.825233743473493*^9, 
  3.8252338281113462`*^9}, {3.825233885089035*^9, 3.825233956077571*^9}, {
  3.825234045063274*^9, 3.825234117660511*^9}},
 CellLabel->"In[239]:=",
 CellID->76340959,ExpressionUUID->"63ad67ae-d225-49e3-b7d3-d4be448c38fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FindMergeLoops", "::", "usage"}], "=", 
   "\"\<FindMergeLoops[structure,spec,{m,n}] finds points where four corners \
meet and all relevant axes are merged, which leads to a tiny floating ring of \
merge indicators\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindMergeLoops", "[", 
   RowBox[{"structure_", ",", "spec_", ",", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Map", "[", "First", "]"}], "/@", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"Rest", "/@", "#"}], ",", "False", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}], "\[Equal]", 
       RowBox[{"{", "}"}]}], "&"}], "]"}], "@", 
    RowBox[{"Apply", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "##", "}"}], ",", 
         RowBox[{"spec", "\[LeftDoubleBracket]", 
          RowBox[{"#", ",", "1", ",", "#3"}], "\[RightDoubleBracket]"}], ",", 
         
         RowBox[{"spec", "\[LeftDoubleBracket]", 
          RowBox[{"#", ",", "2", ",", 
           RowBox[{"3", "-", "#2"}]}], "\[RightDoubleBracket]"}]}], "}"}], 
       "&"}], ",", "\[IndentingNewLine]", 
      RowBox[{"GetCornerMembers", "[", 
       RowBox[{"structure", ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}]}]}]}], "Input",\

 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.825234163556632*^9, 3.825234250247628*^9}, {
  3.825234872789781*^9, 3.825234920194163*^9}, {3.825234974977329*^9, 
  3.8252350913636527`*^9}, {3.8252351647069983`*^9, 3.8252352249710984`*^9}, {
  3.825235294146166*^9, 3.825235381980584*^9}, {3.8252354230530796`*^9, 
  3.8252355371691217`*^9}, {3.8252355681876016`*^9, 3.825235645427499*^9}, {
  3.825237092244151*^9, 3.8252370946859455`*^9}, {3.8252371262733994`*^9, 
  3.825237127084988*^9}, {3.8252371662012663`*^9, 3.8252371840206604`*^9}, {
  3.825237223750594*^9, 3.8252372358364253`*^9}, {3.825237293567109*^9, 
  3.8252373484900703`*^9}},
 CellLabel->"In[241]:=",
 CellID->76494887,ExpressionUUID->"684aa5eb-c05b-4654-b4ba-a9d5940828b8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandMergeAxesSpec", "[", 
   RowBox[{"grid_", ",", "structure_", ",", "spec_", ",", "fromWrap_", ",", 
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{"(*", " ", 
      RowBox[{
      "remove", " ", "floating", " ", "loops", " ", "of", " ", "merge", " ", 
       "indicators"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"loops", "=", 
        RowBox[{
         RowBox[{"GroupBy", "[", 
          RowBox[{"First", "\[Rule]", "Rest"}], "]"}], "@", 
         RowBox[{"Catenate", "@", 
          RowBox[{"FindMergeLoops", "[", 
           RowBox[{"structure", ",", "#", ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "n"}], "}"}]}], "]"}]}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{"#", ",", 
             RowBox[{
              RowBox[{"s", ":", 
               RowBox[{"Except", "[", "False", "]"}]}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"s", ",", "s"}], "}"}]}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Catenate", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"3", "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "}"}], "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"None", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"None", ",", "0"}], "}"}]}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"3", "-", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{"None", ",", "0"}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"None", ",", "0"}], "}"}]}], "}"}]}]}], 
               "\[IndentingNewLine]", "}"}], "&"}], "/@", "#2"}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
         "&"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"#", ",", "\[IndentingNewLine]", 
          RowBox[{"Lookup", "[", 
           RowBox[{"loops", ",", 
            RowBox[{"Range", "@", 
             RowBox[{"Length", "@", "structure"}]}], ",", 
            RowBox[{"{", "}"}]}], "]"}]}], "\[IndentingNewLine]", "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], "&"}], 
   "@", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"##", ",", "False"}], "]"}], "&"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"SparseArray", "@", 
           RowBox[{"Normal", "@", 
            RowBox[{
             RowBox[{"KeyMap", "[", "$SidePositions", "]"}], "@", 
             RowBox[{"PlotsPresent", "[", 
              RowBox[{"grid", ",", 
               RowBox[{"Sequence", "@@", "#"}]}], "]"}]}]}]}], ",", 
          "\[IndentingNewLine]", "#2"}], "\[IndentingNewLine]", "}"}], ",", 
        "\[IndentingNewLine]", "2"}], "\[IndentingNewLine]", "]"}], "&"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"structure", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ApplyStructureToOption", "[", "\[IndentingNewLine]", 
         RowBox[{"structure", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Expand2DSpec", "[", "\[IndentingNewLine]", 
            RowBox[{"spec", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"m", ",", "n"}], "}"}], "-", "1"}], ",", 
             "\[IndentingNewLine]", "LastExplicit"}], "\[IndentingNewLine]", 
            "]"}], "//", "\[IndentingNewLine]", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{"ArrayPad", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "1"}], "}"}], ",", "False"}], "]"}], "&"}], 
            "]"}]}], ",", 
          RowBox[{"(*", " ", 
           RowBox[{
           "add", " ", "settings", " ", "for", " ", "outer", " ", "edges"}], 
           " ", "*)"}], "\[IndentingNewLine]", "fromWrap", ",", 
          "\[IndentingNewLine]", "LastExplicit"}], "\[IndentingNewLine]", 
         "]"}], "//", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"NormalizeMergePrimitive", ",", "#", ",", 
           RowBox[{"{", "3", "}"}]}], "]"}], "&"}]}]}], "\[IndentingNewLine]",
       "}"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdxVkow3EAB/B/jklzH5FEjIRyhTU0/uVJSvtbuWZpEbMHmxhtc0yivaEo
cryQlCO5CSM8ORZthGh4s/DgKiy/7+/h0ydK0cDVuDAME0Xg+nPlj1XmYNmu
Zrr4hmVs5AR7mwue2zB54CJTGh8n2hQKPGL3V2Fd8YwaWy9vG3H6A68F911m
6PD3mSnxiqxuXqBflUldYysd7Givhi4Ou1OlkEvbX+kTqXo1durtBqzd6jbi
CqdbF9YPqobx3ekevT7dYsa7Iht9fjpnXULmNu+38LgXd4LV8ft02fuhAz/w
hTyOHCDd4+OnOLkv5h5nQ3BTviwMiy2PJTjyiJFjizmyGr9VxtCDQw2pxeT1
wKA0LMwyZGL58xC9Y0W4KiWHd5ys4dro/hrvTgf767OjxMPZglcfcm+t6xsu
T5J84KDWok+sy1ss9yULeMEyzGgilvDy3yB9++tgDfd4um/iKo8pkR+5QFmX
hS/OBnLx5NhLNW51apT42HhhxNclWoE/udCpS8b/y5r+Yw==
  "],
 CellLabel->"In[243]:=",
 CellID->645166440,ExpressionUUID->"4ff60b06-b7e0-4bcd-a558-2a4964976415"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ApplyStyles", "[", 
   RowBox[{"prim_", ",", "style_", ",", "ang_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"iApplyStyles", "[", 
   RowBox[{"prim", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<Graphics\>\"", ",", "\"\<GraphicsFrame\>\"", ",", 
      RowBox[{"Replace", "[", 
       RowBox[{"style", ",", 
        RowBox[{"None", "\[Rule]", "Nothing"}]}], "]"}]}], "}"}], ",", 
    "ang"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iApplyStyles", "[", 
   RowBox[{
    RowBox[{"gr", ":", 
     RowBox[{"Graphics", "[", 
      RowBox[{"prim_", ",", "opts___"}], "]"}]}], ",", "style_", ",", 
    "ang_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Rotate", "[", 
     RowBox[{"prim", ",", "ang", ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{
      RowBox[{"RotateGraphicsOpt", "[", 
       RowBox[{"PlotRange", ",", "ang"}], "]"}], "@", "\[IndentingNewLine]", 
      RowBox[{"NormalizedOptionValue", "[", 
       RowBox[{"gr", ",", "PlotRange"}], "]"}]}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{"ang", ",", "\[Pi]"}], "]"}], "\[Equal]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AspectRatio", "\[Rule]", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"GraphicsOpt", "[", 
            RowBox[{"gr", ",", "AspectRatio"}], "]"}], ",", 
           RowBox[{
            RowBox[{"o_", "?", "NumericQ"}], "\[RuleDelayed]", 
            RowBox[{"1", "/", "o"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"GraphicsOpt", "[", 
            RowBox[{"gr", ",", "ImageSize"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"h_", ",", "v_"}], "}"}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"v", ",", "h"}], "}"}]}], ",", 
             RowBox[{
              RowBox[{"s", ":", 
               RowBox[{
                RowBox[{"Except", "@", "_UpTo"}], "|", "Automatic"}]}], 
              "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"Automatic", ",", "s"}], "}"}]}]}], "}"}]}], "]"}]}]}],
        "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
    "\[IndentingNewLine]", "opts", ",", "\[IndentingNewLine]", 
    RowBox[{"BaseStyle", "\[Rule]", "style"}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iApplyStyles", "[", 
   RowBox[{"prim_", ",", "style_", ",", "ang_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Style", "[", 
   RowBox[{"prim", ",", "style"}], "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8067556317531424`*^9, 3.806755679222468*^9}, {
  3.806755832517627*^9, 3.806755847516259*^9}, {3.806757481322771*^9, 
  3.806757511210116*^9}, {3.806757660212947*^9, 3.80675766602114*^9}, {
  3.807001565039909*^9, 3.807001680669842*^9}, {3.8070017310586987`*^9, 
  3.807001759094658*^9}, {3.8070018332284174`*^9, 3.807001849221532*^9}, {
  3.807004867193503*^9, 3.8070049314655895`*^9}, {3.807005092973405*^9, 
  3.8070051452362347`*^9}, {3.807005563128291*^9, 3.8070055891711187`*^9}, {
  3.8070056349130716`*^9, 3.8070056436510677`*^9}, {3.8070058504726133`*^9, 
  3.807006128163535*^9}, {3.8070061584423614`*^9, 3.807006195867405*^9}, {
  3.8070063060681705`*^9, 3.8070063118754063`*^9}, {3.807006407103092*^9, 
  3.8070064073623037`*^9}, {3.8070072457207675`*^9, 3.8070072469047213`*^9}},
 CellLabel->"In[244]:=",
 CellID->845029217,ExpressionUUID->"f8f2b0b0-89a9-4eb0-b492-2df6921b3c05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$SideAngles", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"Left", "\[Rule]", "\[Pi]"}], ",", 
     RowBox[{"Right", "\[Rule]", "0"}], ",", 
     RowBox[{"Top", "\[Rule]", 
      RowBox[{"\[Pi]", "/", "2"}]}], ",", 
     RowBox[{"Bottom", "\[Rule]", 
      RowBox[{"3", 
       RowBox[{"\[Pi]", "/", "2"}]}]}]}], "|>"}]}], ";"}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.806757625862252*^9, 3.806757646431493*^9}},
 CellLabel->"In[247]:=",
 CellID->772201501,ExpressionUUID->"f9b3c71a-c746-4254-8697-f9b29260589b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ConstructMergeInset", "[", 
   RowBox[{
   "_", ",", "_", ",", "_", ",", "_", ",", "_", ",", "False", ",", "_", ",", 
    "_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ConstructMergeInset", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "_", ",", "_", ",", "pos_", ",", "posOff_", ",", "size_", ",", 
      "sizeOff_"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"spacing_", ",", "spacingOff_"}], "}"}], ",", "frame_", ",", 
    "padding_", ",", "dir_", ",", "spec_", ",", "styles_", ",", "fullSpec_"}],
    "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"off", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"#", "-", "1"}], ",", 
           RowBox[{"2", "-", "#"}]}], "}"}], "&"}], "@", 
        RowBox[{
         RowBox[{"$SidePositions", "[", "dir", "]"}], "\[LeftDoubleBracket]", 
         "1", "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"posDelta", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#2", "-", "1"}], ")"}], 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "-", "#"}], ",", 
            RowBox[{"#", "-", "1"}]}], "}"}]}], "&"}], "@@", 
        RowBox[{"$SidePositions", "[", "dir", "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"effSizeOff", "=", "sizeOff"}], ",", "\[IndentingNewLine]", 
      RowBox[{"scale", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "\[LeftDoubleBracket]", 
             RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "===", 
            "implicitAutomatic"}], ",", "1", ",", 
           RowBox[{"1", "/", "2"}]}], "]"}], "&"}], "/@", "spec"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"With", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"effSpec", "=", 
           RowBox[{"spec", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"#2", "+", "1"}], ",", 
             RowBox[{"3", "-", 
              RowBox[{
               RowBox[{"$SidePositions", "[", "dir", "]"}], 
               "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
            "\[RightDoubleBracket]"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
            "effSpec", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
             "===", "None"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"spacing", ",", "spacingOff"}], "}"}], "==", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], ",", 
              RowBox[{"Sow", "[", 
               RowBox[{"\"\<ZeroSize\>\"", ",", "ConstructMergeInset"}], 
               "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"frame", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"3", "-", 
                  RowBox[{
                   RowBox[{"$SidePositions", "[", "dir", "]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                 ",", 
                 RowBox[{"#2", "+", "1"}]}], "\[RightDoubleBracket]"}], "||", 
               
               RowBox[{
                RowBox[{"fullSpec", "\[LeftDoubleBracket]", 
                 RowBox[{
                  RowBox[{"3", "-", 
                   RowBox[{
                    RowBox[{"$SidePositions", "[", "dir", "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                  ",", 
                  RowBox[{"#2", "+", "1"}]}], "\[RightDoubleBracket]"}], "=!=",
                 "False"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Inset", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"ApplyStyles", "[", 
                 RowBox[{
                  RowBox[{
                  "effSpec", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], ",", "#", ",", 
                  RowBox[{"$SideAngles", "[", "dir", "]"}]}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Offset", "[", 
                 RowBox[{
                  RowBox[{"posOff", "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"off", "#2"}], "+", "posDelta"}], ")"}], 
                    "effSizeOff"}]}], ",", 
                  RowBox[{"Scaled", "[", 
                   RowBox[{"pos", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"off", " ", "#2"}], "+", "posDelta"}], ")"}], 
                    "size"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Head", "@", 
                    RowBox[{
                    "effSpec", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "===", "Graphics"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "0"}], "}"}], ",", 
                  RowBox[{"ImageScaled", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.5"}], "}"}], "-", 
                    RowBox[{"0.5", 
                    RowBox[{"AngleVector", "@", 
                    RowBox[{"$SideAngles", "[", "dir", "]"}]}]}]}], "]"}]}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Offset", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"off", " ", 
                    RowBox[{
                    "effSpec", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "off"}], ")"}], "spacingOff", " ", 
                    "scale"}]}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "off"}], ")"}], "spacing", " ", 
                   "scale"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], "&"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"styles", "\[LeftDoubleBracket]", 
         RowBox[{"3", "-", 
          RowBox[{
           RowBox[{"$SidePositions", "[", "dir", "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.806755894704808*^9, 3.806756079598881*^9}, {
   3.8067561409511013`*^9, 3.806756160821864*^9}, {3.806756208855935*^9, 
   3.8067562481136103`*^9}, {3.8067562928357716`*^9, 3.806756520314253*^9}, {
   3.8067565653504815`*^9, 3.8067565670820107`*^9}, {3.8067566026621933`*^9, 
   3.806756684219434*^9}, {3.806756754324134*^9, 3.806756758310841*^9}, {
   3.806757650962595*^9, 3.806757726748172*^9}, {3.806757772466121*^9, 
   3.8067577928929796`*^9}, {3.8067578625307655`*^9, 
   3.8067579178172464`*^9}, {3.8067580020870185`*^9, 
   3.8067580067857275`*^9}, {3.8067581449710846`*^9, 3.806758145863453*^9}, {
   3.806758233639927*^9, 3.8067583473927145`*^9}, 3.80675843328788*^9, {
   3.806758625246029*^9, 3.8067587887145257`*^9}, 3.806762426701006*^9, {
   3.806764121604164*^9, 3.8067641461850195`*^9}, {3.806764321933029*^9, 
   3.806764410594556*^9}, {3.80693204682699*^9, 3.806932065620307*^9}, {
   3.8069321864223127`*^9, 3.8069322105486784`*^9}, {3.806932250646633*^9, 
   3.806932250810651*^9}, {3.8069554237610917`*^9, 3.8069554370263405`*^9}, {
   3.806986182273465*^9, 3.806986205854373*^9}, {3.806986718400067*^9, 
   3.8069867192581935`*^9}, {3.8069875269000783`*^9, 3.806987543725464*^9}, {
   3.806995552961113*^9, 3.8069955537233524`*^9}, {3.806995842338476*^9, 
   3.8069958601047487`*^9}, {3.806995895051944*^9, 3.8069958960313272`*^9}, {
   3.8069959885722284`*^9, 3.806995991267664*^9}, {3.8069960504067893`*^9, 
   3.806996051758794*^9}, {3.806997453299821*^9, 3.8069974590801406`*^9}, {
   3.806998773527365*^9, 3.806998815880575*^9}, {3.8069988536155987`*^9, 
   3.80699885440854*^9}, {3.8069990104938674`*^9, 3.8069990411724663`*^9}, {
   3.806999087759492*^9, 3.8069992396631627`*^9}, {3.8069992888258123`*^9, 
   3.8069992917695312`*^9}, {3.8070004388598957`*^9, 
   3.8070004483491793`*^9}, {3.8070009070878854`*^9, 3.807000989691748*^9}, {
   3.8070010240021515`*^9, 3.807001038459264*^9}, {3.807001150766491*^9, 
   3.807001191372059*^9}, {3.807001235031347*^9, 3.807001295970075*^9}, {
   3.80700136865113*^9, 3.8070014034785247`*^9}, {3.807001440413483*^9, 
   3.807001480269804*^9}, {3.8070015313774996`*^9, 3.807001553492275*^9}, {
   3.8070064567479973`*^9, 3.807006458753951*^9}, {3.807006861898656*^9, 
   3.8070068704648647`*^9}, {3.8070069780975018`*^9, 3.807007003599728*^9}, {
   3.8070071423623877`*^9, 3.807007146920898*^9}, {3.8070072855689516`*^9, 
   3.8070073008160715`*^9}, {3.8070074837875953`*^9, 3.807007506476388*^9}, {
   3.8070235649260025`*^9, 3.8070235670361996`*^9}, {3.807023648520523*^9, 
   3.807023664802246*^9}, {3.8070237329606686`*^9, 3.807023785567397*^9}, {
   3.80702386777003*^9, 3.8070238680542693`*^9}, {3.807024035700265*^9, 
   3.807024035815419*^9}, {3.80707344258888*^9, 3.8070735030707617`*^9}, {
   3.807073568187874*^9, 3.8070736287535553`*^9}, {3.8070736709051285`*^9, 
   3.8070736729171124`*^9}, {3.807073708150625*^9, 3.807073727333357*^9}, {
   3.825235981367527*^9, 3.8252359843648033`*^9}, {3.8252360151212234`*^9, 
   3.825236162935788*^9}, {3.825236295055422*^9, 3.825236301767192*^9}, {
   3.825236444121441*^9, 3.825236463855068*^9}, {3.8252365402557344`*^9, 
   3.825236594514846*^9}, {3.8252367412792306`*^9, 3.8252367601330924`*^9}, {
   3.8252443646643953`*^9, 3.8252444004058375`*^9}, {3.825244477148043*^9, 
   3.825244494541222*^9}, {3.879063056643531*^9, 3.879063057420659*^9}, {
   3.8790633656440725`*^9, 3.8790634173924537`*^9}, {3.8790659283626175`*^9, 
   3.8790659321392508`*^9}},
 CellLabel->"In[248]:=",
 CellID->500707295,ExpressionUUID->"afeae381-3c99-49bc-9099-5da657ef3c27"]
}, Closed]],

Cell[CellGroupData[{

Cell["PlotRange", "Subsubsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8151363791470633`*^9, 3.8151363819490747`*^9}},
 CellLabel->"In[23]:=",
 CellID->15425267,ExpressionUUID->"c0e41f41-2a15-41e8-888d-f7712a97ae7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ComputeRangeMinMax", "[", "ranges_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Reverse", "@", 
       RowBox[{"MinMax", "@", "#"}]}], ",", 
      RowBox[{"MinMax", "@", "#2"}]}], "}"}], "&"}], "@@", 
   RowBox[{"Transpose", "@", "ranges"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ComputeRangeMinMax", "[", 
   RowBox[{"{", "}"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Infinity]", ",", 
      RowBox[{"-", "\[Infinity]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "\[Infinity]"}], ",", "\[Infinity]"}], "}"}]}], 
   "}"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.815199566889783*^9, 3.815199611982851*^9}, {
  3.8157645896843243`*^9, 3.8157646088021812`*^9}, {3.8157647614917717`*^9, 
  3.8157647885978165`*^9}, {3.8157648275649385`*^9, 3.815764848643193*^9}},
 CellLabel->"In[250]:=",
 CellID->80216683,ExpressionUUID->"7fd21c8c-7499-40a1-b5b8-e31d4c6d569c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComputePlotRangeMinMax", "[", "plotRanges_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Map", "[", "\[IndentingNewLine]", 
   RowBox[{"ComputeRangeMinMax", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ReplaceAll", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"None", ",", "None"}], "}"}], "\[Rule]", "Nothing"}], "]"}], 
     "@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"plotRanges", "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", "All", ",", "1"}], "\[RightDoubleBracket]"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"plotRanges", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "All", ",", "2"}], "\[RightDoubleBracket]"}]}], 
      "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.815136614786049*^9, 3.815136669313012*^9}, {
   3.8151368888565674`*^9, 3.815137082172042*^9}, {3.815198176784062*^9, 
   3.8151981954025774`*^9}, 3.8151983368890295`*^9, {3.815198824710752*^9, 
   3.815198825663847*^9}, {3.815198900545625*^9, 3.815198903437393*^9}, {
   3.815199127618134*^9, 3.8151991350813494`*^9}, {3.81519963099541*^9, 
   3.815199702312937*^9}, {3.815199741357999*^9, 3.8151997480435762`*^9}, {
   3.815199792562209*^9, 3.8151997959021935`*^9}, {3.8151999191884413`*^9, 
   3.8151999215362654`*^9}, {3.8157646574268045`*^9, 
   3.8157646596956005`*^9}, {3.815764723897252*^9, 3.815764738086255*^9}},
 CellLabel->"In[252]:=",
 CellID->730056147,ExpressionUUID->"d3fdec20-e737-4c1e-85ab-b596a859e29a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComputeEffectivePlotRanges", "[", 
   RowBox[{"plotRanges_", ",", "expandedSpec_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"iComputeEffectivePlotRanges", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"plotRanges", "/.", 
       RowBox[{"Null", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"None", ",", "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}]}], ",", 
      "\[IndentingNewLine]", "expandedSpec"}], "\[IndentingNewLine]", "]"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Position", "[", 
      RowBox[{"plotRanges", ",", "Null", ",", 
       RowBox[{"{", "2", "}"}]}], "]"}], "\[Rule]", "Null"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.815198342556615*^9, 3.8151983773336563`*^9}, {
  3.815764993168107*^9, 3.815765008274107*^9}, {3.8790640413291063`*^9, 
  3.8790640509538236`*^9}, {3.879066123815751*^9, 3.8790661334477596`*^9}, {
  3.879066201737833*^9, 3.879066211200224*^9}, {3.879066262897784*^9, 
  3.879066274672365*^9}},
 CellLabel->"In[253]:=",
 CellID->800540372,ExpressionUUID->"da845074-f0bd-4dda-b82c-3be8a70bb05b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandXYPlotRanges", "[", 
   RowBox[{"{", 
    RowBox[{"xranges_", ",", "yranges_"}], "}"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Outer", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"#2", ",", "#"}], "}"}], "&"}], ",", "\[IndentingNewLine]", 
    "yranges", ",", "\[IndentingNewLine]", "xranges", ",", 
    "\[IndentingNewLine]", "1"}], "\[IndentingNewLine]", "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.81520053696437*^9, 3.8152006080487432`*^9}},
 CellLabel->"In[254]:=",
 CellID->283922630,ExpressionUUID->"1d4ae347-75d7-4ec2-8824-d622f8a00fcc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ExpandPlotRangeSpec", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m_", ",", "n_"}], "}"}], ",", "spec_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"ExpandXYPlotRanges", "@", 
   RowBox[{"Replace", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Expand2DSpec", "[", 
       RowBox[{"spec", ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "n"}], "}"}], ",", "LastExplicit"}], "]"}], "/.", 
      RowBox[{"Directive", "\[Rule]", "List"}]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"a_", "?", "NumericQ"}], "\[RuleDelayed]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "a"}], ",", "a"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"s", ":", 
         RowBox[{"Except", "@", "_List"}]}], "\[RuleDelayed]", 
        RowBox[{"{", 
         RowBox[{"s", ",", "s"}], "}"}]}]}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.87906389376702*^9, 3.8790639063655276`*^9}, {
  3.87906608784979*^9, 3.8790660994723372`*^9}},
 CellLabel->"In[255]:=",
 CellID->646114537,ExpressionUUID->"c06edf69-1525-4ea7-96df-740d96fcb96c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"iComputeEffectivePlotRanges", "[", 
   RowBox[{"plotRanges_", ",", "expandedSpec_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{
      "#", ",", "\[IndentingNewLine]", "Inherited", ",", 
       "\[IndentingNewLine]", "#2", ",", "\[IndentingNewLine]", "Min", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"#3", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", "\[IndentingNewLine]", "Max", ",", "\[IndentingNewLine]", 
       RowBox[{"#3", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ",", "\[IndentingNewLine]", "_", ",", "\[IndentingNewLine]", "#"}], 
      "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
     "expandedSpec", ",", "\[IndentingNewLine]", "plotRanges", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ExpandXYPlotRanges", "@", 
       RowBox[{"ComputePlotRangeMinMax", "[", "plotRanges", "]"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", "4"}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8151364358888607`*^9, 3.815136528404113*^9}, {
   3.8151366298566256`*^9, 3.8151366567925825`*^9}, {3.815137260774265*^9, 
   3.815137272329505*^9}, {3.8151972928904915`*^9, 3.815197298421065*^9}, {
   3.815197423811857*^9, 3.8151974255588694`*^9}, {3.8151979453553877`*^9, 
   3.815198031069413*^9}, {3.815198077935855*^9, 3.815198126717506*^9}, {
   3.8151982368155107`*^9, 3.8151983038060875`*^9}, 3.8151983403705435`*^9, {
   3.8151987507057123`*^9, 3.815198789545599*^9}, {3.815198909139635*^9, 
   3.8151989099968605`*^9}, {3.8151999379049473`*^9, 
   3.8151999393397007`*^9}, {3.8151999986155405`*^9, 3.81520006015633*^9}, {
   3.8152001024937353`*^9, 3.8152001062963676`*^9}, {3.815200238944768*^9, 
   3.8152002391636224`*^9}, {3.815200417300757*^9, 3.815200481465602*^9}, {
   3.8152005936497736`*^9, 3.8152006704883757`*^9}, {3.815200754954541*^9, 
   3.8152007552041845`*^9}, {3.815763935564871*^9, 3.8157639375066776`*^9}, {
   3.8157639719478254`*^9, 3.8157639726891212`*^9}, {3.815764014834877*^9, 
   3.815764031284134*^9}, {3.815764164986915*^9, 3.8157641670669107`*^9}, {
   3.815764956056074*^9, 3.8157649663371725`*^9}, {3.879063878956908*^9, 
   3.8790639083149223`*^9}, {3.879066177905529*^9, 3.8790661976268225`*^9}},
 CellLabel->"In[256]:=",
 CellID->472923146,ExpressionUUID->"8b1b832a-7864-4f42-80e8-8e0e7233e415"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CoordinateMap & Prolog/Epilog processing", "Subsubsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.863435354165612*^9, 3.8634353682379656`*^9}},
 CellLabel->"In[8]:=",
 CellID->257574721,ExpressionUUID->"1eb6c217-0fb2-42d4-bab3-381e690f8c94"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateMap", "[", "f_", "]"}], "[", "prims_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"CoordinateMap", "[", 
   RowBox[{"f", ",", "prims"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateMap", "[", 
    RowBox[{"f_", ",", "prims_List"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CoordinateMap", "[", "f", "]"}], "/@", "prims"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateMap", "[", 
    RowBox[{"f_", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"w", ":", 
        RowBox[{
        "GraphicsGroup", "|", "Translate", "|", "Scale", "|", "Rotate", "|", 
         "GeometricTransformation", "|", "Annotation", "|", "Button", "|", 
         "Deploy", "|", "DynamicWrapper", "|", "EventHandler", "|", 
         "GestureHandler", "|", "Defer", "|", "FlipView", "|", 
         "Interpretation", "|", "Invisible", "|", "Hyperlink", "|", 
         "MouseAppearance", "|", "Mouseover", "|", "StatusArea", "|", "Style",
          "|", "Tooltip"}]}], ")"}], "[", 
      RowBox[{"prims_", ",", "rest___"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"w", "[", 
    RowBox[{
     RowBox[{"CoordinateMap", "[", 
      RowBox[{"f", ",", "prims"}], "]"}], ",", "rest"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateMap", "[", 
    RowBox[{"f_", ",", 
     RowBox[{"DynamicModule", "[", 
      RowBox[{"vars_", ",", "prims_", ",", "rest___"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"DynamicModule", "[", 
    RowBox[{"vars", ",", 
     RowBox[{"CoordinateMap", "[", 
      RowBox[{"f", ",", "prims"}], "]"}], ",", "rest"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateMap", "[", 
    RowBox[{"f_", ",", "gc_GraphicsComplex"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CoordinateMap", "[", "f", "]"}], "@", 
    RowBox[{"Normal", "@", "gc"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoordinateMap", "[", 
   RowBox[{"f_", ",", 
    RowBox[{"AxisObject", "[", 
     RowBox[{
      RowBox[{"pts", ":", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Except", "[", 
          RowBox[{"\"\<Horizontal\>\"", "|", "\"\<Vertical\>\""}], "]"}], ",",
          "_"}], "}"}]}], ",", "rest___"}], "]"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"AxisObject", "[", 
   RowBox[{
    RowBox[{"f", "/@", "pts"}], ",", "rest"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateMap", "[", 
    RowBox[{"f_", ",", 
     RowBox[{"AxisObject", "[", 
      RowBox[{
       RowBox[{"path", ":", 
        RowBox[{
         RowBox[{"Except", "[", "List", "]"}], "[", "___", "]"}]}], ",", 
       "rest___"}], "]"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"AxisObject", "[", 
    RowBox[{
     RowBox[{"CoordinateMap", "[", 
      RowBox[{"f", ",", "path"}], "]"}], ",", "rest"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateMap", "[", 
    RowBox[{"f_", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p", ":", 
        RowBox[{
        "BezierCurve", "|", "BSplineCurve", "|", "Line", "|", "Arrow", "|", 
         "Point", "|", "Annulus", "|", "Triangle", "|", "Simplex", "|", 
         "RegularPolygon", "|", "StadiumShape", "|", "MeshRegion", "|", 
         "BoundaryMeshRegion"}]}], ")"}], "[", 
      RowBox[{"pts_", ",", "rest___"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"p", "[", 
    RowBox[{
     RowBox[{"iCoordinateMap", "[", 
      RowBox[{"f", ",", "pts"}], "]"}], ",", "rest"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateMap", "[", 
    RowBox[{"f_", ",", 
     RowBox[{"Polygon", "[", 
      RowBox[{"spec_", ",", "rest___"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Polygon", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Replace", "[", "\[IndentingNewLine]", 
      RowBox[{"spec", ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", ":", 
             RowBox[{"Except", "[", 
              RowBox[{"{", 
               RowBox[{"_Integer", ",", "_Integer"}], "}"}], "]"}]}], "->", 
            "h_"}], ")"}], ":>", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"iCoordinateMap", "[", 
             RowBox[{"f", ",", "p"}], "]"}], "->", 
            RowBox[{"iCoordinateMap", "[", 
             RowBox[{"f", ",", "h"}], "]"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"p_", ":>", 
          RowBox[{"iCoordinateMap", "[", 
           RowBox[{"f", ",", "p"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Boole", "[", 
         RowBox[{
          RowBox[{"Head", "@", "spec"}], "===", "List"}], "]"}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "rest"}], 
    "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateMap", "[", 
    RowBox[{"f_", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p", ":", 
        RowBox[{
        "Rectangle", "|", "HalfPlane", "|", "InfiniteLine", "|", "HalfLine", 
         "|", "Parallelepiped", "|", "Hyperplane", "|", "AffineSpace"}]}], 
       ")"}], "[", 
      RowBox[{"p1_", ",", 
       RowBox[{"p2_", "|", 
        RowBox[{"PatternSequence", "[", "]"}]}], ",", 
       RowBox[{"rest", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"p", "[", 
    RowBox[{
     RowBox[{"Sequence", "@@", 
      RowBox[{"iCoordinateMap", "[", 
       RowBox[{"f", ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2"}], "}"}]}], "]"}]}], ",", "rest"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateMap", "[", 
    RowBox[{"f_", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p", ":", 
        RowBox[{"Hyperplane", "|", "HalfSpace"}]}], ")"}], "[", 
      RowBox[{"n_", ",", 
       RowBox[{"c", ":", 
        RowBox[{"Except", "[", 
         RowBox[{"_", "?", "NumericQ"}], "]"}]}], ",", "rest___"}], "]"}]}], 
    "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"p", "[", 
    RowBox[{
     RowBox[{"iCoordinateMap", "[", 
      RowBox[{"f", ",", "n"}], "]"}], ",", "c", ",", "rest"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateMap", "[", 
    RowBox[{"f_", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p", ":", 
        RowBox[{"ConicHullRegion", "|", "AffineHalfSpace"}]}], ")"}], "[", 
      RowBox[{"p1_", ",", 
       RowBox[{"p2_", "|", 
        RowBox[{"PatternSequence", "[", "]"}]}], ",", 
       RowBox[{"p3_", "|", 
        RowBox[{"PatternSequence", "[", "]"}]}], ",", 
       RowBox[{"rest", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"p", "[", 
    RowBox[{
     RowBox[{"Sequence", "@@", 
      RowBox[{"iCoordinateMap", "[", 
       RowBox[{"f", ",", 
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2", ",", "p3"}], "}"}]}], "]"}]}], ",", 
     "rest"}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateMap", "[", 
    RowBox[{"f_", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p", ":", 
        RowBox[{
        "Circle", "|", "Disk", "|", "DiskSegment", "|", "Sphere", "|", "Ball",
          "|", "Ellipsoid"}]}], ")"}], "[", 
      RowBox[{"pt_", ",", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Longest", "[", 
          RowBox[{"rxy_", "|", 
           RowBox[{"PatternSequence", "[", "]"}]}], "]"}], ","}], "*)"}], 
       "rest___"}], "]"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Replace", "[", 
     RowBox[{"p", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sphere", "->", "Circle"}], ",", 
        RowBox[{"Ball", "->", "Disk"}]}], "}"}]}], "]"}], "[", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f", "@", "pt"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Sequence", "@@", 
        RowBox[{"f", "/@", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"{", "rxy", "}"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"idx_", "->", 
              RowBox[{"pos_", "/;", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"pos", ",", "_List"}], "]"}]}]}], "}"}], ":>", 
            RowBox[{"{", 
             RowBox[{"idx", "->", 
              RowBox[{"{", 
               RowBox[{"pos", ",", "pos"}], "}"}]}], "}"}]}]}], "]"}]}]}], 
       ","}], "*)"}], "\[IndentingNewLine]", "rest"}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateMap", "[", 
    RowBox[{"f_", ",", 
     RowBox[{"Cuboid", "[", "pts__", "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"f", "/@", 
    RowBox[{"Cuboid", "[", "pts", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateMap", "[", 
    RowBox[{"f_", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p", ":", 
        RowBox[{"FilledCurve", "|", "JoinedCurve"}]}], ")"}], "[", 
      RowBox[{"segs_", ",", "rest___"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"p", "[", 
    RowBox[{
     RowBox[{"CoordinateMap", "[", 
      RowBox[{"f", ",", "segs"}], "]"}], ",", "rest"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateMap", "[", 
    RowBox[{"f_", ",", 
     RowBox[{"Raster", "[", 
      RowBox[{"d_", ",", "lims_", ",", "rest___"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Raster", "[", 
    RowBox[{"d", ",", 
     RowBox[{"iCoordinateMap", "[", 
      RowBox[{"f", ",", "lims"}], "]"}], ",", "rest"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinateMap", "[", 
    RowBox[{"f_", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"p", ":", 
        RowBox[{"Text", "|", "Inset"}]}], ")"}], "[", 
      RowBox[{"t_", ",", "pos_", ",", "rest___"}], "]"}]}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"p", "[", 
    RowBox[{"t", ",", 
     RowBox[{"iCoordinateMap", "[", 
      RowBox[{"f", ",", "pos"}], "]"}], ",", "rest"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CoordinateMap", "[", 
   RowBox[{"_", ",", "prims_"}], "]"}], ":=", "\[IndentingNewLine]", 
  "prims"}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzF9IEwEAx/E1KoiCgh5aRVgrYoEZkn8WW4OLtS1adcyQZtMN2RXpbP2h
GRWpMJos5rBNbFrDJhKeerjlMoaznJk6fVi4Fs31krRa7EEXLTKw7ncPXz5v
3321Zg3F5/F4RWwwrxJYvs1kiVVxcSNnqNCRYdWol11w9w17N6Rdj/qhWNIW
gPkhZgyuLqpMP1il8uhV2PGctMNyJtcOGV2VB6YWcl0wu3PxGdxb4OiDa+Nn
adhsbfXDx25xGL7Q7H8Dl48cXYArH71xeOW4NAnJ9nWfud8WlXAFttWJ4OSv
4SJIdpYUw229cRkUXZQp4Kbw5tPQPqknYZ0lo4WXDIeNcL2aMMG/FGOD3oaQ
Ax6YCDthtNfeCQf2JDmVI1NeqN6+1APLaKof6koP0lBzzMLAmkqTH/45MR6E
tvwMp+7c0w9QaKtOQbmu5QscrJj/DVO7JIIc6+3ue0Loa4odgtdihkL4jzJI
4MgnpwzuSFw+CSPvPQo4SrtJ+CBdqoUiYaIa9uUa9bCgYpiC/HS5GZqSHTeh
Uzp4FybHXn4XzGaJ89NznG5XptIfzRJD1nojdL1eq4d0ZOt1eOtV7R2o529o
ghsnyjwB1gt2qw/OlShD0Ns1zUm8TQeCrM33g6PwYeRUa4S15Yz2CWSUgR4o
V4gGYKxhKQilqdkQTP00TkGrOf4O+mrcaTj/NcH5Hy3vx/4=
  "],
 CellLabel->"In[257]:=",
 CellID->290611100,ExpressionUUID->"148acea2-a2c1-4f50-9f5f-d7bf75ceb578"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"iCoordinateMap", "[", "f_", "]"}], "[", "pts_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"iCoordinateMap", "[", 
   RowBox[{"f", ",", "pts"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iCoordinateMap", "[", 
   RowBox[{"f_", ",", 
    RowBox[{"pt", ":", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Except", "[", 
         RowBox[{"_List", "|", "_Rule"}], "]"}], ",", 
        RowBox[{"Except", "[", 
         RowBox[{"_List", "|", "_Rule"}], "]"}]}], "}"}], "|", 
      RowBox[{"Except", "[", "_List", "]"}]}]}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"f", "@", "pt"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iCoordinateMap", "[", 
   RowBox[{"f_", ",", "pts_List"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"iCoordinateMap", "[", "f", "]"}], "/@", 
   "pts"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iCoordinateMap", "[", 
   RowBox[{"_", ",", "pts_"}], "]"}], ":=", "\[IndentingNewLine]", 
  "pts"}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8634325808977866`*^9, 3.8634325835318975`*^9}, {
  3.8634341637934313`*^9, 3.8634341670948734`*^9}, {3.8634341992145815`*^9, 
  3.863434261593017*^9}, {3.8634343348478785`*^9, 3.8634343370378275`*^9}, {
  3.863449740935382*^9, 3.8634497452319317`*^9}, {3.863529518160035*^9, 
  3.8635295242293825`*^9}, {3.864365108762467*^9, 3.8643651352870965`*^9}},
 CellLabel->"In[275]:=",
 CellID->611926726,ExpressionUUID->"c56a4a04-0f29-437a-bd70-ce7afe18efca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"transformCoord", "[", 
   RowBox[{"spec_", ",", 
    RowBox[{"Optional", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cur_", ",", "curOff_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"ref", ":", 
     RowBox[{"{", 
      RowBox[{
      "pos_", ",", "posOff_", ",", "size_", ",", "sizeOff_", ",", "pad_", ",",
        "pr0_", ",", "pr_"}], "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Replace", "[", 
   RowBox[{"spec", ",", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Offset", "[", 
        RowBox[{"o_", ",", 
         RowBox[{"p_", ":", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ":>", 
       RowBox[{"transformCoord", "[", 
        RowBox[{"p", ",", 
         RowBox[{"{", 
          RowBox[{"cur", ",", 
           RowBox[{"curOff", "+", "o"}]}], "}"}], ",", "ref"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Scaled", "[", 
        RowBox[{"s_", ",", 
         RowBox[{"p_", ":", "pr0"}]}], "]"}], ":>", 
       RowBox[{"transformCoord", "[", 
        RowBox[{"p", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cur", "+", 
            RowBox[{"size", "*", "s"}]}], ",", 
           RowBox[{"curOff", "+", 
            RowBox[{"sizeOff", "*", "s"}]}]}], "}"}], ",", "ref"}], "]"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ImageScaled", "[", 
        RowBox[{"s_", ",", 
         RowBox[{"p_", ":", 
          RowBox[{"Offset", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"pad", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", "pr0"}], 
           "]"}]}]}], "]"}], ":>", 
       RowBox[{"transformCoord", "[", 
        RowBox[{"p", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cur", "+", 
            RowBox[{"size", "*", "s"}]}], ",", 
           RowBox[{"curOff", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"sizeOff", "+", 
               RowBox[{"Total", "[", 
                RowBox[{"pad", ",", 
                 RowBox[{"{", "2", "}"}]}], "]"}]}], ")"}], "*", "s"}]}]}], 
          "}"}], ",", "ref"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"p_", ":>", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"p", "-", "pr0"}], ")"}], "/", "pr"}]}], "}"}], ",", 
         RowBox[{"Offset", "[", 
          RowBox[{
           RowBox[{"posOff", "+", "curOff", "+", 
            RowBox[{"sizeOff", "*", "s"}]}], ",", 
           RowBox[{"pos", "+", "cur", "+", 
            RowBox[{"size", "*", "s"}]}]}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8634527825809937`*^9, 3.8634528208383055`*^9}, {
   3.8634528511781797`*^9, 3.863452851490719*^9}, {3.8634529785017014`*^9, 
   3.8634530030011683`*^9}, {3.863453042826187*^9, 3.8634530443734665`*^9}, {
   3.8634531660326815`*^9, 3.863453169964139*^9}, {3.8634994811459827`*^9, 
   3.8634995033946657`*^9}, {3.863499701089922*^9, 3.8634997703485174`*^9}, {
   3.8634998238568907`*^9, 3.863499917636263*^9}, {3.8634999564915757`*^9, 
   3.8634999566762986`*^9}, {3.863499987010507*^9, 3.863500076052796*^9}, 
   3.8635019492343597`*^9, {3.8635030095738935`*^9, 3.8635030441729774`*^9}, {
   3.8635032883924837`*^9, 3.863503297210569*^9}, {3.863503338631385*^9, 
   3.8635033402425876`*^9}, {3.8635033841388087`*^9, 
   3.8635034195308156`*^9}, {3.8635034559093976`*^9, 
   3.8635034615835576`*^9}, {3.86350349533675*^9, 3.863503705588225*^9}, {
   3.8635295973348675`*^9, 3.8635296021046295`*^9}, {3.863529956566376*^9, 
   3.8635299620994005`*^9}, 3.8635310016038494`*^9},
 CellLabel->"In[279]:=",
 CellID->389552384,ExpressionUUID->"19be4188-4103-4d9c-83d8-dc843db72b70"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ProcessPrologEpilogPrimitives", "[", 
    RowBox[{"layoutData_", ",", "paddings_", ",", "plotRanges_"}], "]"}], "[",
    "prim_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"CoordinateMap", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"idx_", "->", "coord_"}], ")"}], ":>", 
      RowBox[{"transformCoord", "[", "\[IndentingNewLine]", 
       RowBox[{"coord", ",", "\[IndentingNewLine]", 
        RowBox[{"FirstCase", "[", "\[IndentingNewLine]", 
         RowBox[{"layoutData", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
             "idx2_", ",", "dims_", ",", "pos_", ",", "posOff_", ",", "size_",
               ",", "sizeOff_"}], "}"}], "/;", "\[IndentingNewLine]", 
            RowBox[{"And", "@@", 
             RowBox[{"Thread", "[", 
              RowBox[{"idx2", "<=", "idx", "<=", 
               RowBox[{"idx2", "+", "dims"}]}], "]"}]}]}], ":>", 
           "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
            "pos", ",", "posOff", ",", "\[IndentingNewLine]", "size", ",", 
             "sizeOff", ",", "\[IndentingNewLine]", 
             RowBox[{"Extract", "[", 
              RowBox[{"paddings", ",", "idx2"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Extract", "[", 
               RowBox[{"plotRanges", ",", "idx2"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"-", 
              RowBox[{"Subtract", "@@@", 
               RowBox[{"Extract", "[", 
                RowBox[{"plotRanges", ",", "idx2"}], "]"}]}]}]}], 
            "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "\[IndentingNewLine]",
          "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", "prim"}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8635207145966454`*^9, 3.8635208077886286`*^9}, {
   3.863521001679252*^9, 3.8635212478637705`*^9}, {3.863521284400965*^9, 
   3.863521383900474*^9}, 3.8635310807945204`*^9},
 CellLabel->"In[280]:=",
 CellID->471851365,ExpressionUUID->"d24468db-eb5b-4ebf-959f-fba2226b2eec"]
}, Closed]],

Cell[CellGroupData[{

Cell["AspectRatio", "Subsubsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8640255905911007`*^9, 3.8640255933342133`*^9}, {
   3.86403857216092*^9, 3.864038574224717*^9}, 3.8642871951708584`*^9},
 CellLabel->"In[25]:=",
 CellID->440005765,ExpressionUUID->"a8af4052-d60d-4782-995e-b262fca4c2e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"symbols", " ", "for", " ", "AspectRatio", " ", 
    RowBox[{"constraints", ".", " ", "Not"}], " ", "using", " ", "formal", 
    " ", "symbols", " ", "because", " ", "those", " ", "might", " ", "be", 
    " ", "polluted", " ", "by", " ", "something"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"a", ";", "h", ";", "w", ";"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8642886604505787`*^9, 3.864288716722537*^9}},
 CellLabel->"In[281]:=",
 CellID->544679977,ExpressionUUID->"3e6126f7-380f-43b3-845b-cd9a279c8a83"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetSizeExpressions", "[", "sizes_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Normalize", "[", 
     RowBox[{"#", ",", "Total"}], "]"}], "&"}], "/@", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "s"}], "}"}], "\[Function]", 
      RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "_"}], "}"}], ":>", 
            RowBox[{"v", "[", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
        "s"}], "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"w", ",", "h"}], "}"}], ",", "sizes"}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8640355688014336`*^9, 3.8640355799804754`*^9}, {
   3.8640357265631495`*^9, 3.864035770300417*^9}, {3.8640379637796464`*^9, 
   3.8640380162588997`*^9}, {3.864038055331957*^9, 3.864038156227208*^9}, 
   3.8640382544752417`*^9, {3.8640383098264847`*^9, 3.864038457307234*^9}, {
   3.8640400355877666`*^9, 3.864040042521867*^9}, {3.864048276498018*^9, 
   3.864048315874742*^9}, {3.8640484147521715`*^9, 3.8640484301691713`*^9}, {
   3.864048664667412*^9, 3.8640487268481193`*^9}, {3.864049495394761*^9, 
   3.8640495452087746`*^9}},
 CellLabel->"In[282]:=",
 CellID->478663745,ExpressionUUID->"32fb6764-b93b-4aa4-a9bd-f36defe71079"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComputeActualAR", "[", 
   RowBox[{"spec_", ",", "gr_", ",", "plotRange_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Replace", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
     RowBox[{"spec", ",", "\[IndentingNewLine]", 
      RowBox[{"Inherited", ":>", 
       RowBox[{"GraphicsOpt", "[", 
        RowBox[{"gr", ",", "AspectRatio"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Automatic", ":>", 
     RowBox[{"1", "/", 
      RowBox[{"Divide", "@@", 
       RowBox[{"Subtract", "@@@", "plotRange"}]}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8640386800237236`*^9, 3.864038732002785*^9}, {
   3.864038771105886*^9, 3.8640388416542997`*^9}, {3.864038910498766*^9, 
   3.864038924875841*^9}, {3.8640389951351213`*^9, 3.8640390268661685`*^9}, {
   3.864039319397909*^9, 3.8640393434108257`*^9}, 3.864048751755134*^9},
 CellLabel->"In[283]:=",
 CellID->850655271,ExpressionUUID->"1495592d-c61e-4ff6-b4ae-dc8c15e31c1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComputeAR", "[", 
   RowBox[{"spec_", ",", 
    RowBox[{"{", 
     RowBox[{"nx_", ",", "ny_"}], "}"}], ",", "sizeTotals_", ",", 
    "plotRangeSizes_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Replace", "[", "\[IndentingNewLine]", 
   RowBox[{"spec", ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"m", ":", 
        RowBox[{"Mean", "|", "GeometricMean"}]}], "\[RuleDelayed]", 
       RowBox[{
        RowBox[{"ny", "/", "nx"}], "/", 
        RowBox[{"m", "[", 
         RowBox[{"Divide", "@@@", 
          RowBox[{
           RowBox[{"DeleteCases", "[", "Null", "]"}], "@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"plotRangeSizes", ",", "1"}], "]"}]}]}], "]"}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Automatic", "\[Rule]", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"Divide", "@@", "sizeTotals"}]}], "/", 
        RowBox[{"GeometricMean", "[", 
         RowBox[{"Divide", "@@@", 
          RowBox[{
           RowBox[{"DeleteCases", "[", "Null", "]"}], "@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"plotRangeSizes", ",", "1"}], "]"}]}]}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.864039555776663*^9, 3.8640396257069335`*^9}, 
   3.8640479573057594`*^9},
 CellLabel->"In[284]:=",
 CellID->40517464,ExpressionUUID->"a9f1f399-7891-4e2c-865c-cff95d8bb973"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ARExpression", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i_", ",", "j_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"di_", ",", "dj_"}], "}"}]}], "}"}], ",", "sizes_", ",", 
    "spacings_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"a", "/", 
    RowBox[{"Divide", "@@", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"Total", "/@", "spacings"}]}], ")"}]}]}], " ", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"sizes", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", 
         RowBox[{
          RowBox[{"2", "i"}], "-", "1", "+", "i2"}]}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i2", ",", "0", ",", 
        RowBox[{"2", "di"}]}], "}"}]}], "]"}], "/", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"sizes", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"2", "j"}], "-", "1", "+", "j2"}]}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j2", ",", "0", ",", 
        RowBox[{"2", "dj"}]}], "}"}]}], "]"}]}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8642301220943794`*^9, 3.864230183395071*^9}, {
   3.8645413763251657`*^9, 3.864541407539285*^9}, 3.8645449876518726`*^9},
 CellLabel->"In[285]:=",
 CellID->673856316,ExpressionUUID->"bc29dfd6-6321-4f2f-bcb0-5a456a2abd9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ARConstraint", "[", 
   RowBox[{"spec_", ",", 
    RowBox[{"info", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i_", ",", "j_"}], "}"}], ",", "_"}], "}"}]}], ",", "sizes_", 
    ",", "spacings_", ",", "plots_", ",", "plotRanges_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ARExpression", "[", 
     RowBox[{"info", ",", "sizes", ",", "spacings"}], "]"}], "==", 
    RowBox[{"ComputeActualAR", "[", 
     RowBox[{"spec", ",", 
      RowBox[{"plots", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
      RowBox[{"plotRanges", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "]"}]}], "/.", 
   RowBox[{
    RowBox[{"_", "==", "Full"}], ":>", "True"}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8642316277766795`*^9, 3.8642316676199303`*^9}, {
  3.864232439672741*^9, 3.86423245938284*^9}, {3.864543101916404*^9, 
  3.864543109687728*^9}},
 CellLabel->"In[286]:=",
 CellID->673344323,ExpressionUUID->"45050bf3-4ac8-41c8-8f2c-17e67b0f7945"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BuildAREquations", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "wspecs___", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"listSpec", ":", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"totalSpec", ":", 
             RowBox[{"Except", "[", "_Rule", "]"}]}], ")"}], "|", 
           RowBox[{"PatternSequence", "[", "]"}]}], ",", "specs___Rule"}], 
         "}"}], "|", "spec1_Rule", "|", "totalSpec_"}]}]}], 
     "\[IndentingNewLine]", "}"}], ",", "dims_", ",", "structure_", ",", 
    "sizeExprs_", ",", "sizeTotals_", ",", "spacings_", ",", "plots_", ",", 
    "plotRanges_", ",", "plotRangeSizes_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Rationalize", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Prepend", "[", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", "totalSpec", "}"}], "===", 
          RowBox[{"{", "}"}]}], "||", 
         RowBox[{
          RowBox[{"{", "totalSpec", "}"}], "===", 
          RowBox[{"{", "Full", "}"}]}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "totalSpec", "}"}], "===", 
            RowBox[{"{", "Automatic", "}"}]}], "&&", 
           RowBox[{
            RowBox[{"{", "listSpec", "}"}], "===", 
            RowBox[{"{", "}"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
        "Nothing", ",", "\[IndentingNewLine]", 
        RowBox[{"a", "==", 
         RowBox[{"ComputeAR", "[", 
          RowBox[{
          "totalSpec", ",", "dims", ",", "sizeTotals", ",", 
           "plotRangeSizes"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", "]"}], "@", 
     RowBox[{"With", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"makeARConstraint", "=", 
         RowBox[{
          RowBox[{"ARConstraint", "[", 
           RowBox[{"##", ",", 
            RowBox[{"MapThread", "[", 
             RowBox[{"Riffle", ",", 
              RowBox[{"{", 
               RowBox[{"sizeExprs", ",", "spacings"}], "}"}]}], "]"}], ",", 
            "spacings", ",", "plots", ",", "plotRanges"}], "]"}], "&"}]}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Module", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"cons", "=", 
           RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Replace", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"wspecs", ",", "spec1", ",", "specs"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i_", ",", "j_"}], "}"}], "->", "spec_"}], ")"}], ":>", 
               RowBox[{"FirstCase", "[", "\[IndentingNewLine]", 
                RowBox[{"structure", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"info", ":", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}], ",", "_"}], "}"}]}], ":>", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"cons", ",", 
                    RowBox[{"makeARConstraint", "[", 
                    RowBox[{"spec", ",", "info"}], "]"}]}], "]"}]}]}], 
                "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"All", "->", "spec_"}], ")"}], ":>", 
               RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                RowBox[{"structure", ",", "\[IndentingNewLine]", 
                 RowBox[{"info_", ":>", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"cons", ",", 
                    RowBox[{"makeARConstraint", "[", 
                    RowBox[{"spec", ",", "info"}], "]"}]}], "]"}]}], ",", 
                 "\[IndentingNewLine]", "1"}], "\[IndentingNewLine]", "]"}]}],
               ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Automatic", "->", "spec_"}], ")"}], ":>", 
               RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                RowBox[{"structure", ",", "\[IndentingNewLine]", 
                 RowBox[{"info_", ":>", 
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"newCons", "=", 
                    RowBox[{"Append", "[", 
                    RowBox[{"cons", ",", 
                    RowBox[{"makeARConstraint", "[", 
                    RowBox[{"spec", ",", "info"}], "]"}]}], "]"}]}], "}"}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Quiet", "@", 
                    RowBox[{"FindInstance", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"And", "@@", "newCons"}], "&&", 
                    RowBox[{"And", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#", ">", "0"}], "&"}], "/@", 
                    RowBox[{"Flatten", "@", "sizeExprs"}]}], ")"}]}]}], ",", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"newCons", ",", 
                    RowBox[{"_w", "|", "_h", "|", "a"}], ",", "All"}], 
                    "]"}]}], "]"}]}], "=!=", 
                    RowBox[{"{", "}"}]}], ",", 
                    RowBox[{"cons", "=", "newCons"}]}], "]"}]}], 
                   "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]",
                  "1"}], "\[IndentingNewLine]", "]"}]}]}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", "1"}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "cons"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], ",", "\[IndentingNewLine]", "0"}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwd0F9MkgEUBXDwD1APkknAiOlsuNWciWJr+WBB6oiHbJkTFlISqBsJQjOz
hWZbadmDW1SMLQydDsk5W6scD1ToEMGkXFPmyjadtRGhUrpUNvvO93D32z0P
dzs3W204r02iUCj5xEBV7uxueiAqFoxoaPsJ6+rCe+HEkJwJk9dyMmGn1CiD
z4vdtZBH9ZEevWB3QW4/exgyaxXhA4RjhlXSoJb7DRrCgSVoedUWg4kPKzvw
ENdhZBNmMptNUFqluAnjlvuk1JOf2mDpH1Y7XPlossCLlgwb7Husc0J+tpV0
IfXMKGztlbyGtLzlQg5h8aToOPRIlC+gU6QZhnLpO18BYUN12SR0D+XMwmk+
dRvyO36LCwkdCs9Z2Nw0uFqDvsKuHSi0+dwq3P2b54G3tZ+95G6rH4dOn9Kv
J1TXZU3Bq1eupRkI7bpdJpQvVXLg2MEGHlS2eHPgQ545Hy6IWKOwpTTlJdT7
l/3wLrdmCnJL0kKQ8eznHJyZnvhO5uGSOFRV1W/BgLJgTxNhShfncjd6mbc1
8E4oYYT7mIsm2COxm634A+tWB3RFep7C60VFVhg/l+6AT+YH+uCP1iwn/Ndd
5oKxSPl72BgU+KFsfG6dFoyKN72/SF39vUl0QtlbYTI8dSPGgG+ObJBWlo9k
wEdb7Wx42Fahgl9oFWo4WL2mg9RcQSOMPgitw9P6jU24+JWegJ0z91IZhJfm
6cdghOM8Af8DPJiLew==
  "],
 CellLabel->"In[287]:=",
 CellID->744227904,ExpressionUUID->"42c10863-7f8b-4b0f-989a-b7a558dda7bb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResolveARTargets", "[", 
   RowBox[{
    RowBox[{"spec", ":", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "__", "}"}], ",", "_"}], "}"}], "|", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"_List", "|", "_Rule"}]}], "}"}]}]}], ",", "dims_", ",", 
    "structure_", ",", "sizes_", ",", "sizeTotals_", ",", "spacings_", ",", 
    "plots_", ",", "plotRanges_", ",", "plotRangeSizes_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"sizeExprs", ",", "vars", ",", "eqs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"sizeExprs", "=", 
      RowBox[{"GetSizeExpressions", "[", "sizes", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"BuildAREquations", "[", 
       RowBox[{
       "spec", ",", "dims", ",", "structure", ",", "sizeExprs", ",", 
        "sizeTotals", ",", "spacings", ",", "plots", ",", "plotRanges", ",", 
        "plotRangeSizes"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"vars", "=", 
      RowBox[{"DeleteDuplicates", "@", 
       RowBox[{
        RowBox[{"Append", "[", "a", "]"}], "@", 
        RowBox[{"Sort", "@", 
         RowBox[{"Cases", "[", 
          RowBox[{"sizeExprs", ",", 
           RowBox[{"_w", "|", "_h"}], ",", "All"}], "]"}]}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a", ",", "sizeExprs"}], "}"}], "/.", 
      RowBox[{"Last", "@", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{"_Maximize", ":>", 
          RowBox[{"{", 
           RowBox[{"a", "->", "Infinity"}], "}"}]}], "]"}], "@", 
        RowBox[{"Quiet", "@", 
         RowBox[{"Maximize", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "@@", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "a"}], "}"}], "sizeExprs"}], "]"}]}], ",", 
             "eqs", ",", 
             RowBox[{"And", "@@", 
              RowBox[{
               RowBox[{"GreaterThan", "[", "0", "]"}], "/@", "vars"}]}]}], 
            "}"}], ",", "vars"}], "]"}]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8640385913867993`*^9, 3.864038599244715*^9}, {
   3.8640391839228354`*^9, 3.8640392795535607`*^9}, {3.86403933642584*^9, 
   3.8640393369488525`*^9}, 3.864039436545737*^9, {3.8640401107852*^9, 
   3.8640402114261875`*^9}, {3.8640402483536882`*^9, 
   3.8640402527163887`*^9}, {3.8640403385225477`*^9, 3.864040485402402*^9}, {
   3.8640405182356234`*^9, 3.864040594595172*^9}, {3.8640406656186795`*^9, 
   3.864040903155795*^9}, {3.864047315467129*^9, 3.8640473217634044`*^9}, {
   3.8640479534510307`*^9, 3.8640479546698537`*^9}, {3.864048505539426*^9, 
   3.8640485172662*^9}, {3.8640486065081887`*^9, 3.864048607675288*^9}, {
   3.8640488715790577`*^9, 3.8640488722910585`*^9}, {3.864048970555016*^9, 
   3.864048971316016*^9}, {3.8640493407879376`*^9, 3.864049434889682*^9}, {
   3.8640496010662813`*^9, 3.8640496253786125`*^9}, {3.864049658816736*^9, 
   3.864049662050737*^9}, {3.8640497544510193`*^9, 3.864049760426019*^9}, {
   3.8640501933397675`*^9, 3.8640501978677654`*^9}, {3.864050274229228*^9, 
   3.864050314285429*^9}, {3.8640509647404385`*^9, 3.864050991084505*^9}, {
   3.8641045130096626`*^9, 3.864104516424879*^9}, {3.864104547763877*^9, 
   3.8641045865578356`*^9}, {3.864105004962819*^9, 3.864105056312501*^9}, {
   3.8641053997312665`*^9, 3.8641054222178288`*^9}, {3.8641950523829412`*^9, 
   3.8641950977220197`*^9}, {3.864195199649035*^9, 3.8641952018540373`*^9}, {
   3.864195238220016*^9, 3.864195330768839*^9}, {3.8641955135533376`*^9, 
   3.864195594721709*^9}, {3.8641965502763357`*^9, 3.864196551017324*^9}, {
   3.8641986815511413`*^9, 3.864198713786435*^9}, {3.8642007387641535`*^9, 
   3.864200739388682*^9}, {3.864200792449595*^9, 3.8642008241880836`*^9}, {
   3.864229081364523*^9, 3.8642290827725525`*^9}, {3.864229325513919*^9, 
   3.864229326055919*^9}, {3.864230024276888*^9, 3.8642300263178873`*^9}, {
   3.8642320559245815`*^9, 3.86423205659658*^9}, {3.8642881626858463`*^9, 
   3.8642881628728485`*^9}, {3.8642888393122177`*^9, 3.864288839754217*^9}, {
   3.8643147590634327`*^9, 3.8643148359819627`*^9}, {3.8643151001092305`*^9, 
   3.864315130052137*^9}, {3.864315243093822*^9, 3.8643152437888217`*^9}, {
   3.8643152756607704`*^9, 3.8643152933958373`*^9}, {3.8645412804678497`*^9, 
   3.8645412811970634`*^9}, {3.864541695318737*^9, 3.8645416955323744`*^9}, {
   3.864541917909179*^9, 3.8645419187011805`*^9}, {3.8645420743344393`*^9, 
   3.864542074533523*^9}, {3.864542728642091*^9, 3.8645427301342087`*^9}, {
   3.8645430644295797`*^9, 3.864543079367878*^9}, {3.864543309717457*^9, 
   3.864543318067596*^9}, {3.864543383957099*^9, 3.864543391749099*^9}, {
   3.8645435284528933`*^9, 3.8645435286524286`*^9}, {3.8645436360855474`*^9, 
   3.8645436509399776`*^9}, {3.86454421747754*^9, 3.8645442181335397`*^9}, {
   3.864544261124107*^9, 3.8645442613561063`*^9}},
 CellLabel->"In[288]:=",
 CellID->513481655,ExpressionUUID->"5ec87228-ab41-4ad2-b835-52c2bb39c317"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ResolveARTargets", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "spec_"}], "}"}], ",", "dims_", ",", 
    "structure_", ",", "sizes_", ",", "sizeTotals_", ",", "spacings_", ",", 
    "plots_", ",", "plotRanges_", ",", "plotRangeSizes_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ComputeAR", "[", 
     RowBox[{"spec", ",", "dims", ",", "sizeTotals", ",", "plotRangeSizes"}], 
     "]"}], ",", 
    RowBox[{"sizes", "/.", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "s_"}], "}"}], ":>", "s"}]}]}], 
   "}"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.864229227587227*^9, 3.864229242633193*^9}, {
  3.864229291500193*^9, 3.8642293183709183`*^9}, {3.8642293991968236`*^9, 
  3.8642294042468014`*^9}, {3.8643147402214346`*^9, 3.8643147492214336`*^9}, {
  3.8645430298223295`*^9, 3.864543040852603*^9}, {3.864544230803695*^9, 
  3.8645442591231036`*^9}},
 CellLabel->"In[289]:=",
 CellID->388956661,ExpressionUUID->"f5e7a2fe-de0c-4c9e-8b13-6b0deedc723d"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Grid structure processing", "Subsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7990550363320136`*^9, 3.7990550408466835`*^9}},
 CellLabel->"In[10]:=",
 CellID->932789901,ExpressionUUID->"f4624ae0-9755-4e01-951f-2e056fe703dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$SpanMarkers", "=", 
   RowBox[{"{", 
    RowBox[{"SpanFromLeft", ",", "SpanFromAbove", ",", "SpanFromBoth"}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ProcessGridStructure", "[", "grid_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"get", " ", "the", " ", "first", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"i", ".", "e", ".", " ", "biggest"}], " ", "&"}], " ", 
          "highest", " ", "priority"}], ")"}], " ", "sub"}], "-", 
       RowBox[{"grid", " ", "containing", " ", "each", " ", "cell"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"#", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"And", "@@", 
        RowBox[{"MapThread", "[", 
         RowBox[{"LessEqual", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{
            "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
           "}"}]}], "]"}]}], "&"}]}], "\[IndentingNewLine]", "]"}], "&"}], 
   "@", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "extract", " ", "all", " ", "valid", " ", "spanned", " ", "sub"}], "-", 
       RowBox[{
        RowBox[{"grids", ".", " ", "SpanFrom"}], "*", " ", "are", " ", "only",
         " ", "allowed", " ", "as", " ", "1", "x1"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pos_", ",", "dim_", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"p_", ",", 
             RowBox[{"SpanFromLeft", "..."}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"SpanFromAbove", ",", 
              RowBox[{"SpanFromBoth", "..."}]}], "}"}], "..."}]}], "}"}]}], 
        "}"}], "/;", 
       RowBox[{
        RowBox[{"dim", "\[Equal]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], "||", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"p", ",", 
          RowBox[{"Except", "[", 
           RowBox[{"Alternatives", "@@", "$SpanMarkers"}], "]"}]}], "]"}]}]}],
       "\[RuleDelayed]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"pos", ",", "dim"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
    "@", 
    RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"generate", " ", "all", " ", "possible", " ", "sub"}], "-", 
           RowBox[{"grids", " ", 
            RowBox[{"(", 
             RowBox[{
             "those", " ", "with", " ", "higher", " ", "priority", " ", 
              "first"}], ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"h", ",", "w"}], "}"}], ",", 
            RowBox[{"grid", "\[LeftDoubleBracket]", 
             RowBox[{
              RowBox[{"x", ";;", 
               RowBox[{"x", "+", "h"}]}], ",", 
              RowBox[{"y", ";;", 
               RowBox[{"y", "+", "w"}]}]}], "\[RightDoubleBracket]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"x", ",", "#"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"y", ",", "#2"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"w", ",", 
            RowBox[{"#2", "-", "y"}], ",", "0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"h", ",", 
            RowBox[{"#", "-", "x"}], ",", "0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], 
        "&"}], "@@", 
       RowBox[{"Dimensions", "@", "grid"}]}], ",", "\[IndentingNewLine]", 
      "3"}], "\[IndentingNewLine]", "]"}]}]}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7974190534533215`*^9, 3.797419064513315*^9}, {
   3.7974193162484264`*^9, 3.7974193231580296`*^9}, {3.797419419249816*^9, 
   3.7974195983943405`*^9}, {3.79741964504889*^9, 3.7974197173920937`*^9}, {
   3.7974197831053205`*^9, 3.7974200355770383`*^9}, {3.7974281276729765`*^9, 
   3.7974281584148903`*^9}, {3.7974282313872185`*^9, 
   3.7974283757162437`*^9}, {3.797428421046938*^9, 3.797428518491181*^9}, {
   3.7974285544542713`*^9, 3.797428602642045*^9}, {3.7974288689622917`*^9, 
   3.797428877767724*^9}, {3.7974291027615004`*^9, 3.7974293827037835`*^9}, 
   3.7974294127981224`*^9, {3.7974294482912903`*^9, 3.797429474390789*^9}, {
   3.79742951923103*^9, 3.7974295395083294`*^9}, {3.797429601891361*^9, 
   3.797429656465418*^9}, 3.797444215633301*^9, {3.7974448943602924`*^9, 
   3.7974448974100237`*^9}, 3.7974449304322624`*^9, {3.79744497684851*^9, 
   3.797445171977681*^9}, {3.797445348050433*^9, 3.797445348287359*^9}, {
   3.7974453799281764`*^9, 3.7974453871042457`*^9}, {3.7974454440343823`*^9, 
   3.7974454828255377`*^9}, {3.797445533395548*^9, 3.797445546865492*^9}, {
   3.7974455894920797`*^9, 3.79744572137674*^9}, {3.7974895300022364`*^9, 
   3.7974895302527533`*^9}, {3.79855028509708*^9, 3.7985502947440615`*^9}, {
   3.80701197304091*^9, 3.8070119832624545`*^9}, {3.8070293240857472`*^9, 
   3.8070293257398944`*^9}, {3.8070293635854588`*^9, 
   3.8070293856792364`*^9}, {3.8070727242165966`*^9, 3.807072726400899*^9}},
 CellLabel->"In[290]:=",
 CellID->793998039,ExpressionUUID->"5efc3dcd-b2f4-41bf-a79c-d3b4927036ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComputeEffectivePaddings", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nx_", ",", "ny_"}], "}"}], ",", "struc_", ",", "paddings_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Max", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Cases", "[", "\[IndentingNewLine]", 
          RowBox[{"struc", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i_", ",", "j_"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"h_", ",", "w_"}], "}"}]}], "}"}], "/;", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"j", ",", "i", ",", "w", ",", "h"}], "]"}], "\[Equal]",
               "idx"}]}], "\[RuleDelayed]", 
            RowBox[{"ListLookup", "[", 
             RowBox[{"paddings", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j", ",", 
                RowBox[{"Sequence", "@@", "#2"}]}], "}"}], ",", "0"}], 
             "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", "0"}], "\[IndentingNewLine]", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"idx", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"nx", ",", "ny"}], "}"}], "\[LeftDoubleBracket]", 
          RowBox[{
          "#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "\[RightDoubleBracket]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}], 
     "&"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "&"}], ",", 
        RowBox[{
         RowBox[{"#", "+", "#3"}], "&"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"#2", "+", "#4"}], "&"}], ",", 
        RowBox[{"#2", "&"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.806310225786889*^9, 3.806310282555896*^9}, {
   3.806310334317967*^9, 3.8063106547936087`*^9}, {3.806310747568324*^9, 
   3.8063107489713144`*^9}, 3.806310800314661*^9, {3.8063108377905183`*^9, 
   3.8063108586606703`*^9}, {3.806310976016925*^9, 3.8063109899175835`*^9}, {
   3.8063110500753317`*^9, 3.806311053355448*^9}, {3.806311097975478*^9, 
   3.8063111428372107`*^9}, {3.8063112687039557`*^9, 3.806311268867529*^9}, {
   3.807011455556285*^9, 3.80701151805048*^9}, {3.8070119092402315`*^9, 
   3.8070119209733334`*^9}, {3.8070721638386803`*^9, 3.807072177668167*^9}, {
   3.8070727992947407`*^9, 3.8070728094362173`*^9}},
 CellLabel->"In[292]:=",
 CellID->95492130,ExpressionUUID->"0f84ca5f-6775-4083-ad65-9124b58449c6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot labeling", "Subsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8058918802303324`*^9, 3.8058919064473767`*^9}},
 CellLabel->"In[4]:=",
 CellID->222074788,ExpressionUUID->"a6dcbabb-0fcf-495f-ab8c-bf7e8e0d0166"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NormalizeLabelSpec", "[", 
   RowBox[{"Labeled", "[", 
    RowBox[{
     RowBox[{"Verbatim", "[", "_", "]"}], ",", "lbl_"}], "]"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", "lbl", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NormalizeLabelSpec", "[", 
   RowBox[{"Labeled", "[", 
    RowBox[{
     RowBox[{"Verbatim", "[", "_", "]"}], ",", "lbl_", ",", "pos_"}], "]"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{"Placed", "[", 
    RowBox[{"lbl", ",", "pos"}], "]"}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeLabelSpec", "[", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Verbatim", "[", "_", "]"}], ",", "lbl_List", ",", "pos_List"}],
      "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "@", "lbl"}], "\[Equal]", 
    RowBox[{"Length", "@", "pos"}]}]}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Join", "@@", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NormalizeLabelSpec", "[", 
       RowBox[{"Labeled", "[", 
        RowBox[{"_", ",", "##"}], "]"}], "]"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"lbl", ",", "pos"}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"NormalizeLabelSpec", "[", 
    RowBox[{"Labeled", "[", 
     RowBox[{
      RowBox[{"Verbatim", "[", "_", "]"}], ",", "lbl_List", ",", "All"}], 
     "]"}], "]"}], "/;", 
   RowBox[{
    RowBox[{"Length", "@", "lbl"}], "\[Equal]", "4"}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"NormalizeLabelSpec", "[", 
   RowBox[{"Labeled", "[", 
    RowBox[{"_", ",", "lbl", ",", 
     RowBox[{"{", 
      RowBox[{"Bottom", ",", "Left", ",", "Top", ",", "Right"}], "}"}]}], 
    "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NormalizeLabelSpec", "[", 
   RowBox[{"Labeled", "[", 
    RowBox[{
     RowBox[{"Verbatim", "[", "_", "]"}], ",", 
     RowBox[{"Placed", "[", 
      RowBox[{"lbl_", ",", "pos_", ",", 
       RowBox[{"f_", ":", "Identity"}]}], "]"}]}], "]"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"{", 
   RowBox[{"Placed", "[", 
    RowBox[{
     RowBox[{"f", "@", "lbl"}], ",", "pos"}], "]"}], "}"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.80589192535925*^9, 3.8058919486725664`*^9}, {
   3.8058920074025955`*^9, 3.8058920151769505`*^9}, {3.805892097061839*^9, 
   3.805892411520238*^9}, {3.805892465627442*^9, 3.8058924884839916`*^9}, {
   3.8058925547801275`*^9, 3.805892604420759*^9}, {3.805892659275757*^9, 
   3.805892747415617*^9}, 3.8061453478611073`*^9, {3.8062229197711096`*^9, 
   3.806222993969144*^9}},
 CellLabel->"In[293]:=",
 CellID->181122374,ExpressionUUID->"682b520e-99a5-4741-913d-5912f69ab981"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NormalizeLabelOption", "[", 
   RowBox[{"n_", ",", "opt_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Map", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ApplyToWrapped", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Last", "[", 
          RowBox[{"#2", ",", 
           RowBox[{"#", "&"}]}], "]"}], "@", "#"}], "&"}], ",", 
       "\[IndentingNewLine]", "#", ",", "\[IndentingNewLine]", 
       RowBox[{"Except", "@", "_Placed"}], ",", "\[IndentingNewLine]", 
       "_Placed", ",", "\[IndentingNewLine]", 
       RowBox[{"Method", "\[Rule]", "Function"}]}], "\[IndentingNewLine]", 
      "]"}], "&"}], ",", "\[IndentingNewLine]", 
    RowBox[{"iNormalizeLabelOption", "[", 
     RowBox[{"n", ",", 
      RowBox[{"ThreadWrappers", "[", 
       RowBox[{"opt", ",", "Placed", ",", "3"}], "]"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8086605354387274`*^9, 3.8086605828554935`*^9}, {
   3.808660853410945*^9, 3.808660859005106*^9}, {3.808660910546144*^9, 
   3.8086610401079254`*^9}, 3.8086610911173472`*^9},
 CellLabel->"In[298]:=",
 CellID->569998995,ExpressionUUID->"e2d1c32c-e435-4d90-95a8-d5c0d07d9ec5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"iNormalizeLabelOption", "[", 
   RowBox[{"n_", ",", 
    RowBox[{"opt", ":", 
     RowBox[{"{", 
      RowBox[{"___", ",", 
       RowBox[{"{", 
        RowBox[{"___", ",", 
         RowBox[{"{", "___", "}"}], ",", "___"}], "}"}], ",", "___"}], 
      "}"}]}]}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"MapThread", "[", 
   RowBox[{"Join", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"iiNormalizeLabelOption", "[", 
       RowBox[{"n", ",", "#"}], "]"}], "&"}], "/@", "opt"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iNormalizeLabelOption", "[", 
   RowBox[{"n_", ",", "opt_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"iiNormalizeLabelOption", "[", 
   RowBox[{"n", ",", "opt"}], "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8086607279761066`*^9, 3.8086608200861397`*^9}},
 CellLabel->"In[299]:=",
 CellID->496118738,ExpressionUUID->"040f9130-e044-4f7b-bcc3-1cc0837776b5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"iiNormalizeLabelOption", "[", 
   RowBox[{"n_", ",", "None"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", "n"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iiNormalizeLabelOption", "[", 
   RowBox[{"n_", ",", "lbl_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", "lbl", "}"}], ",", "n"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iiNormalizeLabelOption", "[", 
   RowBox[{"n_", ",", "lbls_List"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"PadRight", "[", 
   RowBox[{
    RowBox[{"Replace", "[", 
     RowBox[{"lbls", ",", 
      RowBox[{
       RowBox[{"lbl", ":", 
        RowBox[{"Except", "[", "_List", "]"}]}], "\[RuleDelayed]", 
       RowBox[{"{", "lbl", "}"}]}], ",", "1"}], "]"}], ",", "n", ",", 
    RowBox[{"{", 
     RowBox[{"{", "}"}], "}"}]}], "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.805894118656392*^9, 3.8058941507141848`*^9}, {
   3.8058942028464203`*^9, 3.8058942323510094`*^9}, {3.806145367710087*^9, 
   3.806145418154079*^9}, {3.8061454664117465`*^9, 3.80614547278389*^9}, {
   3.8062231049378214`*^9, 3.80622311637201*^9}, {3.806244289454441*^9, 
   3.806244311179632*^9}, {3.8066657264517775`*^9, 3.806665750784404*^9}, 
   3.807977846463359*^9, {3.808660826483285*^9, 3.8086608297009745`*^9}},
 CellLabel->"In[301]:=",
 CellID->412091572,ExpressionUUID->"80e918b5-1b0a-4a16-af62-0cf042452d63"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComputeLabelIndices", "[", "plots_", "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Ordering", "@*", 
       RowBox[{"DeleteCases", "[", "Null", "]"}]}], "/@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Join", "@@", "#"}], ",", 
        RowBox[{"Join", "@@", 
         RowBox[{"Transpose", "@", "#"}]}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}], "&"}], "@", 
   RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"#", "===", "Null"}], ",", "Null", ",", "#2"}], "]"}], "&"}], 
     ",", "\[IndentingNewLine]", "plots", ",", "\[IndentingNewLine]", 
     RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.806328316555813*^9, 3.80632841876215*^9}, {
  3.806328452943832*^9, 3.8063284572941914`*^9}, {3.80632853173805*^9, 
  3.806328542371559*^9}, {3.806328794238307*^9, 3.80632888742857*^9}, {
  3.8063290002223797`*^9, 3.806329014296887*^9}, {3.806329123325264*^9, 
  3.8063291240604634`*^9}, {3.8063291829395685`*^9, 3.8063291961548696`*^9}, {
  3.8063311517019944`*^9, 3.80633115186618*^9}},
 CellLabel->"In[304]:=",
 CellID->797560982,ExpressionUUID->"e7029e7b-6ec4-4c59-9a44-2cc69b84829a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CollectLabels", "[", 
   RowBox[{"plots_", ",", "fromWrap_", ",", "fromOpt_", ",", "defPos_"}], 
   "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Association", "@", 
   RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"#", "\[Rule]", 
       RowBox[{
        RowBox[{"GroupBy", "[", 
         RowBox[{"Last", "\[Rule]", "First"}], "]"}], "@", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"Replace", "[", 
           RowBox[{
            RowBox[{"lbl", ":", 
             RowBox[{"Except", "[", "_Placed", "]"}]}], "\[RuleDelayed]", 
            RowBox[{"Placed", "[", 
             RowBox[{"lbl", ",", "defPos"}], "]"}]}], "]"}], "]"}], "@", 
         "\[IndentingNewLine]", 
         RowBox[{"Join", "[", "##2", "]"}]}]}]}], "&"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ComputeLabelIndices", "@", "plots"}], ",", "fromOpt", ",", 
       RowBox[{"Pick", "[", 
        RowBox[{"fromWrap", ",", 
         RowBox[{"Join", "@@", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "=!=", "Null"}], "&"}], ",", "plots", ",", 
            RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.806223029269391*^9, 3.8062230835079226`*^9}, {
   3.806223145595405*^9, 3.8062232051949825`*^9}, {3.806244009767027*^9, 
   3.8062441227949533`*^9}, {3.8062445155469065`*^9, 3.806244516408208*^9}, {
   3.806244605750697*^9, 3.8062446106461344`*^9}, {3.8063275659335065`*^9, 
   3.8063276139542093`*^9}, {3.8063276517134595`*^9, 
   3.8063276526200037`*^9}, {3.806328097804426*^9, 3.806328139457779*^9}, {
   3.8063283227358723`*^9, 3.8063283237525663`*^9}, {3.8063285527639704`*^9, 
   3.806328559642066*^9}, {3.8063289402475834`*^9, 3.806328940841323*^9}, {
   3.8063290247117558`*^9, 3.806329045743286*^9}, {3.806329201135228*^9, 
   3.80632920349988*^9}, {3.80633090416358*^9, 3.8063309800744996`*^9}, {
   3.8063310233336577`*^9, 3.806331035177972*^9}, 3.806331109318989*^9, {
   3.806665764273766*^9, 3.8066657680049586`*^9}, {3.807011001335745*^9, 
   3.80701100426933*^9}, {3.8070728930173492`*^9, 3.8070728938281207`*^9}, {
   3.8070732630003767`*^9, 3.8070732631845236`*^9}},
 CellLabel->"In[305]:=",
 CellID->755403888,ExpressionUUID->"4b7e240b-9344-42ca-845a-60c311d96d42"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ProcessAutoLabel", "[", 
   RowBox[{
    RowBox[{"idx", ":", 
     RowBox[{"{", 
      RowBox[{"_", ",", "_"}], "}"}]}], ",", "lbls_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"iProcessAutoLabel", "[", 
      RowBox[{"#", ",", "idx"}], "]"}], "&"}], ",", "lbls", ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8062427071077223`*^9, 3.8062427478959217`*^9}, {
  3.8062428490329185`*^9, 3.806242864623332*^9}, {3.8062445626910343`*^9, 
  3.806244588306322*^9}, {3.8062446281625757`*^9, 3.806244647364261*^9}, {
  3.8063285754851995`*^9, 3.806328588342148*^9}, {3.806328619180563*^9, 
  3.806328628034025*^9}},
 CellLabel->"In[306]:=",
 CellID->261345476,ExpressionUUID->"10f0cafa-407c-48f1-8129-aaa7379ad40e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"iProcessAutoLabel", "[", 
   RowBox[{"lbl_", ",", "_"}], "]"}], ":=", "\[IndentingNewLine]", 
  "lbl"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iProcessAutoLabel", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"t", ":", 
      RowBox[{"Automatic", "|", "Row", "|", "Column"}]}], "\[Rule]", 
     "spec_"}], ",", 
    RowBox[{"{", 
     RowBox[{"rowIdx_", ",", "colIdx_"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"iiProcessAutoLabel", "[", 
   RowBox[{"spec", ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"t", "===", "Row"}], ",", "rowIdx", ",", "colIdx"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iiProcessAutoLabel", "[", 
   RowBox[{"spec_", ",", "n_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Quiet", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Check", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ApplyToWrapped", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"StringReplace", "[", "\[IndentingNewLine]", 
          RowBox[{"#", ",", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"\"\<i\>\"", "\[RuleDelayed]", 
              RowBox[{"ToLowerCase", "@", 
               RowBox[{"RomanNumeral", "[", "n", "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<I\>\"", "\[RuleDelayed]", 
              RowBox[{"RomanNumeral", "[", "n", "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<a\>\"", "\[RuleDelayed]", 
              RowBox[{"StringJoin", "@", 
               RowBox[{"FromLetterNumber", "@", 
                RowBox[{"IntegerDigits", "[", 
                 RowBox[{"n", ",", "26"}], "]"}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<A\>\"", "\[RuleDelayed]", 
              RowBox[{"ToUpperCase", "@", 
               RowBox[{"StringJoin", "@", 
                RowBox[{"FromLetterNumber", "@", 
                 RowBox[{"IntegerDigits", "[", 
                  RowBox[{"n", ",", "26"}], "]"}]}]}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"\"\<1\>\"", "\[RuleDelayed]", 
              RowBox[{"ToString", "[", "n", "]"}]}]}], "\[IndentingNewLine]", 
            "}"}], ",", "\[IndentingNewLine]", "1"}], "\[IndentingNewLine]", 
          "]"}], "&"}], ",", "\[IndentingNewLine]", "spec", ",", 
        "\[IndentingNewLine]", "_String"}], "\[IndentingNewLine]", "]"}], ",",
       "\[IndentingNewLine]", "spec", ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"ApplyToWrapped", "::", "noMatch"}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"ApplyToWrapped", "::", "noMatch"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iiProcessAutoLabel", "[", 
   RowBox[{"spec_Function", ",", "n_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"spec", "[", "n", "]"}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8061459169811354`*^9, 3.8061459208508825`*^9}, {
   3.8061459638878107`*^9, 3.8061461298713284`*^9}, {3.8061462204982457`*^9, 
   3.806146244197688*^9}, {3.8061462776269875`*^9, 3.8061463217991095`*^9}, {
   3.806222107204466*^9, 3.806222258843994*^9}, 3.806222329907603*^9, {
   3.8062426986875277`*^9, 3.8062427030272818`*^9}, {3.806244658656296*^9, 
   3.806244708327072*^9}, {3.8063286357706003`*^9, 3.8063287487395954`*^9}, {
   3.8070092671930447`*^9, 3.807009273930451*^9}},
 CellLabel->"In[307]:=",
 CellID->607750395,ExpressionUUID->"1715f43f-17a0-43f2-9825-c49d42961c2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ConstructLabelInset", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "_", ",", "_", ",", "pos_", ",", "posOff_", ",", "size_", ",", 
      "sizeOff_"}], "}"}], ",", "pad_", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"lblPosType", ":", 
         RowBox[{"{", 
          RowBox[{"_", ",", "_"}], "}"}]}], ",", 
        RowBox[{"lblPosOff", ":", 
         RowBox[{"{", 
          RowBox[{"xo_", ",", "yo_"}], "}"}]}], ",", 
        RowBox[{"lblPos", ":", 
         RowBox[{"{", 
          RowBox[{"x_", ",", "y_"}], "}"}]}]}], "}"}], ",", "anchor_"}], 
     "}"}], ",", "lbls_", ",", "sty_", ",", "comb_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Inset", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pane", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Replace", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Replace", "[", "\[IndentingNewLine]", 
          RowBox[{"comb", ",", "\[IndentingNewLine]", 
           RowBox[{"Automatic", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Automatic", "\[Rule]", "Identity"}], ")"}]}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Automatic", "\[Rule]", "func_"}], ")"}], "\[RuleDelayed]", 
          RowBox[{"func", "@*", 
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "lbls"}], "\[Equal]", "1"}], ",", 
             "\[IndentingNewLine]", "First", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"x", "-", "0.5"}], "]"}], "\[Equal]", 
              RowBox[{"Abs", "[", 
               RowBox[{"y", "-", "0.5"}], "]"}]}], ",", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"if", " ", "on", " ", "the", " ", "diagonals"}], ",", 
               " ", 
               RowBox[{"break", " ", "tie", " ", "with", " ", "offsets"}]}], 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"xo", " ", 
                 RowBox[{"Sign", "[", 
                  RowBox[{"x", "-", "0.5"}], "]"}]}], ">", 
                RowBox[{"yo", " ", 
                 RowBox[{"Sign", "[", 
                  RowBox[{"y", "-", "0.5"}], "]"}]}]}], ",", 
               "\[IndentingNewLine]", "Column", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"#", ",", "\"\< \>\""}], "]"}], "&"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"x", "-", "0.5"}], "]"}], ">", 
              RowBox[{"Abs", "[", 
               RowBox[{"y", "-", "0.5"}], "]"}]}], ",", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"if", " ", "not", " ", "on", " ", "diagonal"}], ",", 
               " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"use", " ", "column", " ", "for", " ", 
                  RowBox[{"left", "/", "right"}], " ", "quadrant"}], " ", 
                 "&"}], " ", "row", " ", "otherwise"}]}], "*)"}], 
             "\[IndentingNewLine]", "Column", ",", "\[IndentingNewLine]", 
             "True", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Row", "[", 
               RowBox[{"#", ",", "\"\< \>\""}], "]"}], "&"}]}], 
            "\[IndentingNewLine]", "]"}]}]}]}], "\[IndentingNewLine]", "]"}], 
       "@", "lbls"}], ",", "\[IndentingNewLine]", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<GraphicsLabel\>\"", ",", "sty"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ContentPadding", "\[Rule]", "False"}]}], "\[IndentingNewLine]",
      "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Offset", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Scaled", "@", "#2"}]}], "]"}], "&"}], "@@", 
     RowBox[{"Transpose", "@", 
      RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "ipos", ",", "iposOff", ",", "isize", ",", "isizeOff", ",", "ipad", 
           ",", "ilblPosType", ",", "ilblPos", ",", "ilblPosOff", ",", 
           "isign", ",", "iotherInsideQ"}], "}"}], "\[Function]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"iposOff", "+", 
            RowBox[{"isizeOff", "*", "ilblPos"}], "+", "\[IndentingNewLine]", 
            
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"ilblPosType", "===", "ImageScaled"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Total", "@", "ipad"}], "*", "ilblPos"}], "-", 
               RowBox[{
               "ipad", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"isign", "\[Equal]", 
                  RowBox[{"-", "1"}]}], ",", 
                 RowBox[{"-", 
                  RowBox[{
                  "ipad", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ",", "0"}], "]"}], "+", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"isign", "\[Equal]", "1"}], ",", 
                 RowBox[{
                 "ipad", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], ",", "0"}], "]"}], "+", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "0.5"}], "\[LessEqual]", "isign", 
                   "\[LessEqual]", "0.5"}], "&&", 
                  RowBox[{"!", "iotherInsideQ"}]}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Total", "@", "ipad"}], "*", "ilblPos"}], "-", 
                  RowBox[{
                  "ipad", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ",", "0"}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], "+", "\[IndentingNewLine]", 
            "ilblPosOff"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ipos", "+", 
            RowBox[{"isize", "*", "ilblPos"}]}]}], "\[IndentingNewLine]", 
          "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
         "pos", ",", "posOff", ",", "\[IndentingNewLine]", "size", ",", 
          "sizeOff", ",", "\[IndentingNewLine]", "pad", ",", 
          "\[IndentingNewLine]", "lblPosType", ",", "lblPos", ",", 
          "lblPosOff", ",", "\[IndentingNewLine]", 
          RowBox[{"MapThread", "[", 
           RowBox[{"coordSign", ",", 
            RowBox[{"{", 
             RowBox[{"lblPosOff", ",", "lblPos"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Reverse", "@", 
           RowBox[{"MapThread", "[", 
            RowBox[{"coordInsideQ", ",", 
             RowBox[{"{", 
              RowBox[{"lblPosOff", ",", "lblPos"}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{"ImageScaled", "@", "anchor"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8058921105587635`*^9, 3.8058921333571243`*^9}, 
   3.805892606127607*^9, 3.806223231676922*^9, {3.8062400872688694`*^9, 
   3.806240091493374*^9}, 3.8062401452742167`*^9, {3.80624025928457*^9, 
   3.806240261952243*^9}, {3.806240346757394*^9, 3.806240394221588*^9}, 
   3.806240457641899*^9, {3.806241043389289*^9, 3.8062411124294796`*^9}, {
   3.8062412284046946`*^9, 3.8062412287155695`*^9}, {3.8062412761723995`*^9, 
   3.80624129549023*^9}, {3.8062413886204157`*^9, 3.8062413929182487`*^9}, {
   3.806241582985876*^9, 3.8062415882280397`*^9}, {3.8062417496446133`*^9, 
   3.806242100724948*^9}, {3.806242672706216*^9, 3.806242673357339*^9}, {
   3.80624965255571*^9, 3.806249688306711*^9}, {3.8062497352437105`*^9, 
   3.8062497830197105`*^9}, {3.806249849578974*^9, 3.8062498514509735`*^9}, {
   3.806249898221999*^9, 3.806249938858*^9}, {3.8063074389776373`*^9, 
   3.80630759677361*^9}, {3.8063076379525623`*^9, 3.8063076432188187`*^9}, {
   3.80630769180197*^9, 3.8063077924958677`*^9}, {3.8063088051891685`*^9, 
   3.806308856981431*^9}, {3.8063088987629104`*^9, 3.806308995731698*^9}, {
   3.8063090436398973`*^9, 3.806309043872903*^9}, {3.8063090994764905`*^9, 
   3.806309100878479*^9}, {3.806309220216017*^9, 3.8063092389480734`*^9}, {
   3.8063093033169026`*^9, 3.8063093040117555`*^9}, {3.8063094205839586`*^9, 
   3.806309436930659*^9}, 3.8063095747385354`*^9, {3.8063096736126194`*^9, 
   3.806309702068701*^9}, {3.8063116490112734`*^9, 3.806311653598556*^9}, {
   3.806311694231681*^9, 3.8063117221932487`*^9}, {3.806311880780777*^9, 
   3.8063119038800397`*^9}, {3.8063119580666275`*^9, 
   3.8063119633294907`*^9}, {3.8063367203482423`*^9, 
   3.8063367248251033`*^9}, {3.80633687644402*^9, 3.8063368771701508`*^9}, {
   3.8063369706349716`*^9, 3.8063369828120637`*^9}, {3.8063384107100315`*^9, 
   3.8063384908126855`*^9}, {3.8063406363501616`*^9, 
   3.8063406391547947`*^9}, {3.80634115102568*^9, 3.80634115444273*^9}, {
   3.806591395299042*^9, 3.8065914440536714`*^9}, {3.8065915010478315`*^9, 
   3.8065915274704447`*^9}, {3.8065916252253227`*^9, 
   3.8065916434473333`*^9}, {3.8065917102035823`*^9, 
   3.8065920794482737`*^9}, {3.8065921701127777`*^9, 3.806592172647274*^9}, {
   3.806592205391756*^9, 3.806592211403878*^9}, 3.806592267805851*^9, {
   3.806592658927997*^9, 3.8065926646170053`*^9}, {3.8065929250554895`*^9, 
   3.806592930857888*^9}, {3.806656154072238*^9, 3.8066561650830417`*^9}, {
   3.8066596002156973`*^9, 3.8066596062643595`*^9}, {3.8066616956325502`*^9, 
   3.8066617185590987`*^9}, {3.8066624892843657`*^9, 
   3.8066624899613705`*^9}, {3.806662547008003*^9, 3.8066625958478107`*^9}, {
   3.806662753900273*^9, 3.8066627856901445`*^9}, 3.8086709387553635`*^9, {
   3.8086710295748825`*^9, 3.8086711023454227`*^9}, {3.8086718295250807`*^9, 
   3.80867187078798*^9}, {3.80873995702323*^9, 3.8087399661038713`*^9}},
 CellLabel->"In[311]:=",
 CellID->422156207,ExpressionUUID->"66c3ba6a-09df-44cb-a04b-cc6e70782f00"]
}, Closed]],

Cell[CellGroupData[{

Cell["PlotGrid", "Subsection",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7990550071044264`*^9, 3.7990550088414536`*^9}},
 CellLabel->"In[20]:=",
 CellID->896902103,ExpressionUUID->"4585abea-ebaa-4636-be77-b55c38129cb7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$ValidPlaceholders", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Null", ",", "None"}], "}"}], "~", "Join", "~", 
    "$SpanMarkers"}]}], ";"}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.7973254011762447`*^9, 3.797325428909094*^9}, {
  3.7974195250683937`*^9, 3.7974195304418325`*^9}, {3.7974459739198284`*^9, 
  3.7974459795998316`*^9}, {3.8062434890264316`*^9, 3.8062434898797636`*^9}},
 CellLabel->"In[312]:=",
 CellID->66800584,ExpressionUUID->"57c454c8-1b72-41e0-95b7-96af91e3c4e2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$ValidWrappers", "=", 
   RowBox[{"Frame", "|", "Labeled"}]}], ";"}]], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8052845243543043`*^9, 3.805284534180451*^9}, {
  3.805363081751617*^9, 3.80536308306901*^9}, {3.806947179516713*^9, 
  3.8069471801216555`*^9}},
 CellLabel->"In[313]:=",
 CellID->44914782,ExpressionUUID->"cfffffd0-7510-498d-98ee-41d3fb8e36c7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ValidGridItemQ", "[", 
   RowBox[{"gr_", "?", "ValidGraphicsQ"}], "]"}], ":=", "\[IndentingNewLine]",
   "True"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ValidGridItemQ", "[", 
   RowBox[{"$ValidWrappers", "[", 
    RowBox[{"expr_", ",", "___"}], "]"}], "]"}], ":=", "\[IndentingNewLine]", 
  
  RowBox[{"ValidGridItemQ", "[", "expr", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ValidGridItemQ", "[", "_", "]"}], ":=", "\[IndentingNewLine]", 
  "False"}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.8052712393802195`*^9, 3.805271322046025*^9}, {
  3.805271362125783*^9, 3.8052714105352983`*^9}, {3.8052845399035983`*^9, 
  3.8052845630388117`*^9}, {3.806989454613123*^9, 3.806989455218609*^9}},
 CellLabel->"In[314]:=",
 CellID->148941611,ExpressionUUID->"58043040-f895-46c3-bcba-7fb2f1f8fada"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PlotGrid", "::", "noScaled"}], "=", 
   "\"\<Invalid item size spec ``. At least one column/row dimension must be \
relative.\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotGrid", "::", "cantScale"}], "=", 
   "\"\<Cannot use Scaled/ImageScaled size for `` ``, as no plots are \
available to estimate the size.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotGrid", "::", "cantRatio"}], "=", 
   "\"\<Setting AspectRatio for individual plots is not supported when Offset \
type sizes or spacings are used.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotGrid", "::", "unresolvable"}], "=", 
   "\"\<Cannot resolve constraints on AspectRatios. Remove some of the \
AspectRatio specifications or make more row/colum sizes Automatic.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"PlotGrid", "::", "zeroSize"}], "=", 
    "\"\<Some merge insets were determined to have zero size, likely due to a \
missing/incorrect Spacings setting.\>\""}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "PlotGrid", "]"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"FrameStyle", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"ItemSize", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"Spacings", "\[Rule]", "None"}], ",", 
      RowBox[{"\"\<ShowFrameLabels\>\"", "\[Rule]", "Full"}], ",", 
      RowBox[{"\"\<HideOuterTickLabels\>\"", "\[Rule]", "Full"}], ",", 
      RowBox[{"\"\<MergeAxes\>\"", "\[Rule]", "False"}], ",", 
      RowBox[{"Method", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"PlotLabels", "\[Rule]", "None"}], ",", 
      RowBox[{"LabelingFunction", "\[Rule]", "Automatic"}], ",", 
      RowBox[{"PerformanceGoal", "\[Rule]", "\"\<Quality\>\""}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "Inherited"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"PlotGrid", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"l_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"MatrixQ", "[", 
        RowBox[{"#", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"ValidGridItemQ", "@", "#"}], "||", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"$ValidPlaceholders", ",", "#"}], "]"}]}], "&"}]}], "]"}],
        "&"}], ")"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"o", ":", 
     RowBox[{"OptionsPattern", "[", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Options", "[", "PlotGrid", "]"}], ",", 
        RowBox[{"Options", "[", "Graphics", "]"}]}], "]"}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], ":=", 
  RowBox[{"UsingFrontEnd", "@", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
      "nx", ",", "ny", ",", "\[IndentingNewLine]", "plots", ",", 
       "\[IndentingNewLine]", "structure", ",", "\[IndentingNewLine]", 
       "wrappers", ",", "\[IndentingNewLine]", "paddingData", ",", 
       "\[IndentingNewLine]", "padding", ",", "\[IndentingNewLine]", "method",
        ",", "\[IndentingNewLine]", 
       RowBox[{"favorSpeed", "=", 
        RowBox[{
         RowBox[{"OptionValue", "[", "PerformanceGoal", "]"}], "===", 
         "\"\<Speed\>\""}]}], ",", "\[IndentingNewLine]", "fixTicks", ",", 
       "\[IndentingNewLine]", "allCustomTicks", ",", "\[IndentingNewLine]", 
       "frameStyle", ",", "\[IndentingNewLine]", 
       RowBox[{"rotateLabel", "=", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "RotateLabel", "]"}], ",", 
          RowBox[{
           RowBox[{"Rotate", "[", 
            RowBox[{"#", ",", 
             RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "&"}], ",", "Identity"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "frameInsets", ",", 
       "\[IndentingNewLine]", "plotRangeSpec", ",", "\[IndentingNewLine]", 
       "effectivePlotRanges", ",", "\[IndentingNewLine]", "labelData", ",", 
       "\[IndentingNewLine]", "labelInsets", ",", "\[IndentingNewLine]", "gi",
        ",", "\[IndentingNewLine]", "giNoLabels", ",", "\[IndentingNewLine]", 
       "grid", ",", "\[IndentingNewLine]", "legends", ",", 
       "\[IndentingNewLine]", "computeSizeMeans", ",", "\[IndentingNewLine]", 
       "sizes", ",", "\[IndentingNewLine]", "rangeSizes", ",", 
       "\[IndentingNewLine]", "imageSizes", ",", "\[IndentingNewLine]", 
       "sizeTotals", ",", "\[IndentingNewLine]", "rawSpacings", ",", 
       "\[IndentingNewLine]", "spacings", ",", "\[IndentingNewLine]", 
       "positions", ",", "\[IndentingNewLine]", "positionOffsets", ",", 
       "\[IndentingNewLine]", "sizeOffsets", ",", "\[IndentingNewLine]", 
       "aspectRatio", ",", "\[IndentingNewLine]", "layoutData", ",", 
       "\[IndentingNewLine]", "showFrameLabels", ",", "\[IndentingNewLine]", 
       "hideOuterLabels", ",", "\[IndentingNewLine]", "mergeAxes", ",", 
       "\[IndentingNewLine]", "mergeAxesInsets", ",", "\[IndentingNewLine]", 
       "mergeAxesZeroSize", ",", "\[IndentingNewLine]", "effectiveSizes", ",",
        "\[IndentingNewLine]", "options", ",", "\[IndentingNewLine]", 
       "effectiveGridSize"}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ny", ",", "nx"}], "}"}], "=", 
       RowBox[{"Dimensions", "@", "l"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rawSpacings", "=", 
       RowBox[{
        RowBox[{"Expand2DSpec", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "Spacings", "]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"nx", ",", "ny"}], "}"}], "-", "1"}], ",", "Last"}], 
         "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"implicitAutomatic", "|", "None", "|", "Automatic"}], 
          "\[Rule]", "0"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plots", ",", "wrappers"}], "}"}], "=", 
       RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Map", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ApplyToWrapped", "[", 
             RowBox[{"List", ",", "#", ",", 
              RowBox[{"Except", "[", 
               RowBox[{"$ValidWrappers", "[", "___", "]"}], "]"}], ",", 
              RowBox[{"$ValidWrappers", "[", "___", "]"}]}], "]"}], "&"}], 
           ",", "\[IndentingNewLine]", "l", ",", "\[IndentingNewLine]", 
           RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"structure", "=", 
       RowBox[{"ProcessGridStructure", "[", "l", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"showFrameLabels", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"ExpandFrameLabelSpec", "@", 
           RowBox[{"$FrameLabelMerger", "@", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Prepend", "[", "#", "]"}], "@", "\[IndentingNewLine]", 
             RowBox[{"Cases", "[", 
              RowBox[{"#2", ",", 
               RowBox[{
                RowBox[{"Frame", "[", 
                 RowBox[{"_", ",", "opts__"}], "]"}], "\[RuleDelayed]", 
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"\"\<ShowFrameLabels\>\"", "/.", 
                   RowBox[{"{", "opts", "}"}]}], ",", 
                  RowBox[{"\"\<ShowFrameLabels\>\"", "\[Rule]", "Nothing"}]}],
                  "]"}]}]}], "]"}]}]}]}], "\[IndentingNewLine]", "&"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"ExpandGridSpec", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"OptionValue", "[", "\"\<ShowFrameLabels\>\"", "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"nx", ",", "ny"}], "}"}], ",", "\[IndentingNewLine]", 
              "$FrameLabelMerger"}], "\[IndentingNewLine]", "]"}], "/.", 
            RowBox[{"implicitAutomatic", "\[Rule]", "Full"}]}], ",", 
           "\[IndentingNewLine]", "wrappers"}], "\[IndentingNewLine]", "}"}], 
         ",", "\[IndentingNewLine]", "2"}], "\[IndentingNewLine]", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"hideOuterLabels", "=", 
       RowBox[{"ExpandOuterLabelSpec", "[", "\[IndentingNewLine]", 
        RowBox[{"structure", ",", "\[IndentingNewLine]", 
         RowBox[{"OptionValue", "[", "\"\<HideOuterTickLabels\>\"", "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"SidedFrameOptionFromWrappers", "[", 
          RowBox[{"wrappers", ",", "\"\<HideOuterTickLabels\>\""}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"nx", ",", "ny"}], "}"}], ",", "\[IndentingNewLine]", 
         "favorSpeed"}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"mergeAxes", "=", 
       RowBox[{"ExpandMergeAxesSpec", "[", "\[IndentingNewLine]", 
        RowBox[{
        "plots", ",", "\[IndentingNewLine]", "structure", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"OptionValue", "[", "\"\<MergeAxes\>\"", "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"SidedFrameOptionFromWrappers", "[", 
          RowBox[{"wrappers", ",", "\"\<MergeAxes\>\""}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"nx", ",", "ny"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"method", "=", 
       RowBox[{
        RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "Method", "]"}], ",", 
             RowBox[{"Automatic", "\[Rule]", 
              RowBox[{"{", "}"}]}]}], "]"}], ",", 
           RowBox[{"\"\<FixFrameTicks\>\"", "\[Rule]", "True"}], ",", 
           RowBox[{"\"\<AllCustomTicks\>\"", "\[Rule]", "Automatic"}]}], 
          "}"}]}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"fixTicks", "=", 
       RowBox[{"\"\<FixFrameTicks\>\"", "/.", "method"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"allCustomTicks", "=", 
       RowBox[{"\"\<AllCustomTicks\>\"", "/.", "method"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"idx", "=", 
             RowBox[{"First", "@", 
              RowBox[{"FirstPosition", "[", 
               RowBox[{"structure", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j"}], "}"}], ",", "_"}], "}"}]}], 
               "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ApplyFrameSettings", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ListLookup", "[", 
              RowBox[{"structure", ",", 
               RowBox[{"{", 
                RowBox[{"idx", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"showFrameLabels", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ListLookup", "[", 
              RowBox[{"hideOuterLabels", ",", 
               RowBox[{"{", "idx", "}"}], ",", "None"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ListLookup", "[", 
              RowBox[{"mergeAxes", ",", 
               RowBox[{"{", "idx", "}"}], ",", "None"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Indexed", "[", 
              RowBox[{"effectiveSizes", ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", "plots", ",", "\[IndentingNewLine]", 
             "rawSpacings"}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "ny"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "nx"}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"plots", "/.", 
        RowBox[{
         RowBox[{"Hold", "[", "EnsureCustomTicks", "]"}], "\[Rule]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"TrueQ", "[", 
            RowBox[{"allCustomTicks", "/.", 
             RowBox[{"Automatic", "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"!", "favorSpeed"}], "&&", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                "plots", ",", "$ModifiedDefaultTickPattern", ",", "All"}], 
                "]"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", 
           "EnsureCustomTicks", ",", "\[IndentingNewLine]", 
           RowBox[{"#2", "&"}]}], "\[IndentingNewLine]", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"plots", ",", 
         RowBox[{
          RowBox[{"Alternatives", "@@", "$ValidPlaceholders"}], "\[Rule]", 
          "Null"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plotRangeSpec", "=", 
       RowBox[{"ExpandPlotRangeSpec", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nx", ",", "ny"}], "}"}], ",", 
         RowBox[{"OptionValue", "[", "PlotRange", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#", "===", "Null"}], ",", "#", ",", 
            RowBox[{"Show", "[", 
             RowBox[{"#", ",", 
              RowBox[{"PlotRange", "->", "#2"}]}], "]"}]}], "]"}], "&"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"plots", ",", "\[IndentingNewLine]", 
           RowBox[{"ComputeEffectivePlotRanges", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Map", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"g", ":", 
                  RowBox[{"Except", "[", "Null", "]"}]}], ":>", 
                 RowBox[{
                  RowBox[{"NormalizeGraphicsOpt", "[", "PlotRange", "]"}], 
                  "@", 
                  RowBox[{"GraphicsOpt", "[", 
                   RowBox[{"g", ",", "PlotRange"}], "]"}]}]}], "]"}], ",", 
               "\[IndentingNewLine]", "plots", ",", "\[IndentingNewLine]", 
               RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"plotRangeSpec", "/.", 
              RowBox[{
               RowBox[{"Min", "|", "Max"}], "->", "Inherited"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",",
          "\[IndentingNewLine]", "2"}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gi", "=", 
       RowBox[{"GraphicsInformation", "@", "plots"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"effectivePlotRanges", "=", 
       RowBox[{"ComputeEffectivePlotRanges", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"gi", "[", "PlotRange", "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"plotRangeSpec", "/.", 
          RowBox[{
           RowBox[{"All", "|", "Automatic"}], "->", "Inherited"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sizes", "=", 
       RowBox[{
        RowBox[{"Expand2DSpec", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "ItemSize", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"nx", ",", "ny"}], "}"}], ",", "Last"}], "]"}], "/.", 
        RowBox[{"implicitAutomatic", "\[Rule]", "Automatic"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"computeSizeMeans", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{"Mean", "@*", 
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"{", "}"}], "\[Rule]", 
             RowBox[{"{", "Indeterminate", "}"}]}], "]"}]}], "]"}], "/@", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"MapAt", "[", 
             RowBox[{"Transpose", ",", "1"}], "]"}], "@", 
            RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
                RowBox[{"#", ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{"SparseArray", "[", 
                    RowBox[{"Rule", "@@@", "structure"}], "]"}], ",", 
                    RowBox[{"Except", "@", "0"}], ",", 
                    RowBox[{"{", "3", "}"}]}], "]"}], "\[Rule]", "Null"}]}], 
                "\[IndentingNewLine]", "]"}], "/.", "\[IndentingNewLine]", 
               RowBox[{"Null", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{"Null", ",", "Null"}], "}"}]}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{"2", ",", "3", ",", "1"}], "}"}]}], 
             "\[IndentingNewLine]", "]"}]}], "/.", 
           RowBox[{"Null", "\[Rule]", "Nothing"}]}], "\[IndentingNewLine]", 
          ")"}]}], "&"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"rangeSizes", "=", 
       RowBox[{"computeSizeMeans", "[", 
        RowBox[{"Apply", "[", 
         RowBox[{
          RowBox[{"Abs", "@*", "Subtract"}], ",", "effectivePlotRanges", ",", 
          
          RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"imageSizes", "=", 
       RowBox[{"computeSizeMeans", "[", 
        RowBox[{"gi", "[", "ImageSize", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"positionOffsets", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"rawSpacings", ",", 
         RowBox[{"_Scaled", "\[Rule]", "0"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"spacings", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"rawSpacings", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Scaled", "@", "s_"}], "\[RuleDelayed]", "s"}], ",", 
           RowBox[{"_", "\[Rule]", "0"}]}], "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sizeOffsets", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"sizes", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Offset", "[", 
             RowBox[{"off_", ",", 
              RowBox[{"_", ":", "0"}]}], "]"}], "\[RuleDelayed]", "off"}], 
           ",", 
           RowBox[{"_", "\[Rule]", "0"}]}], "}"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sizes", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"sizes", ",", 
         RowBox[{
          RowBox[{"Offset", "[", 
           RowBox[{"_", ",", 
            RowBox[{"sz_", ":", "0"}]}], "]"}], "\[RuleDelayed]", "sz"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"Total", "/@", "sizes"}], ",", "0"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
          "ResourceFunction", "[", "\"\<ResourceFunctionMessage\>\"", "]"}], 
          "[", 
          RowBox[{
           RowBox[{"PlotGrid", "::", "noScaled"}], ",", 
           RowBox[{"OptionValue", "[", "ItemSize", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "@", "$Failed"}]}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"sizeTotals", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "@", 
          RowBox[{"Replace", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"_", "[", "s_", "]"}], "\[RuleDelayed]", "s"}], ",", 
              RowBox[{
               RowBox[{"Scaled", " ", "|", "ImageScaled", "|", "Automatic"}], 
               "\[Rule]", "1"}]}], "}"}], ",", "1"}], "]"}]}], "&"}], "/@", 
        "sizes"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sizes", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Replace", "[", "\[IndentingNewLine]", 
             RowBox[{"#", ",", "\[IndentingNewLine]", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Scaled", "[", "s_", "]"}], "\[RuleDelayed]", 
                 RowBox[{"s", " ", "#3"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ImageScaled", "[", "s_", "]"}], "\[RuleDelayed]", 
                 RowBox[{"s", " ", "#4"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"Automatic", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"Automatic", ",", 
                   RowBox[{"1", "/", "#2"}]}], "}"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Scaled", "\[Rule]", "#3"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"ImageScaled", "\[Rule]", "#4"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"s_", "\[RuleDelayed]", 
                 RowBox[{"s", "/", "#2"}]}]}], "\[IndentingNewLine]", "}"}]}],
              "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]",
            "#"}], "\[IndentingNewLine]", "]"}], "&"}], "/@", 
        RowBox[{"Transpose", "@", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"sizes", ",", "\[IndentingNewLine]", 
           RowBox[{"sizeTotals", "+", 
            RowBox[{"0", " ", "sizes"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Normalize", "[", 
              RowBox[{"#", ",", 
               RowBox[{"Total", "@*", 
                RowBox[{"Replace", "[", 
                 RowBox[{"Indeterminate", "\[Rule]", "1"}], "]"}]}]}], "]"}], 
             "&"}], "/@", "rangeSizes"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Normalize", "[", 
              RowBox[{"#", ",", 
               RowBox[{"Total", "@*", 
                RowBox[{"Replace", "[", 
                 RowBox[{"Indeterminate", "\[Rule]", "1"}], "]"}]}]}], "]"}], 
             "&"}], "/@", "imageSizes"}]}], "\[IndentingNewLine]", 
          "}"}]}]}]}], ";", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"OptionValue", "[", "AspectRatio", "]"}], ",", 
           RowBox[{"_List", "|", "_Rule"}]}], "]"}], "&&", 
         RowBox[{"MemberQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"positionOffsets", ",", "sizeOffsets"}], "}"}], ",", 
           RowBox[{"Except", "[", 
            RowBox[{"0", "|", "0."}], "]"}], ",", 
           RowBox[{"{", "3", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
          "ResourceFunction", "[", "\"\<ResourceFunctionMessage\>\"", "]"}], 
          "[", 
          RowBox[{"PlotGrid", "::", "cantRatio"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "@", "$Failed"}]}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"aspectRatio", ",", "sizes"}], "}"}], "=", 
       RowBox[{"N", "@", 
        RowBox[{"ResolveARTargets", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Flatten", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"Cases", "[", "\[IndentingNewLine]", 
                  RowBox[{"#", ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"Frame", "[", 
                    RowBox[{"_", ",", "opts__"}], "]"}], "\[RuleDelayed]", 
                    RowBox[{"Replace", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"#2", "->", "AspectRatio"}], "/.", 
                    RowBox[{"{", "opts", "}"}]}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"_", "->", "AspectRatio"}], ")"}], "\[Rule]", 
                    "Nothing"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
                 "&"}], ",", "\[IndentingNewLine]", "wrappers", ",", 
                "\[IndentingNewLine]", 
                RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}], ",", 
              "\[IndentingNewLine]", "2"}], "\[IndentingNewLine]", "]"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"OptionValue", "[", "AspectRatio", "]"}]}], 
           "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"ny", ",", "nx"}], "}"}], ",", "structure", ",", "sizes", 
          ",", "sizeTotals", ",", "spacings", ",", "plots", ",", 
          "effectivePlotRanges", ",", 
          RowBox[{"gi", "[", "\"\<PlotRangeSize\>\"", "]"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"AllTrue", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{"aspectRatio", ",", "sizes"}], "}"}]}], ",", 
           RowBox[{"NumberQ", "@*", "N"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
          "ResourceFunction", "[", "\"\<ResourceFunctionMessage\>\"", "]"}], 
          "[", 
          RowBox[{"PlotGrid", "::", "unresolvable"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "@", "$Failed"}]}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{
          RowBox[{"Total", "/@", "sizes"}], ",", "0"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
          "ResourceFunction", "[", "\"\<ResourceFunctionMessage\>\"", "]"}], 
          "[", 
          RowBox[{
           RowBox[{"PlotGrid", "::", "noScaled"}], ",", 
           RowBox[{"OptionValue", "[", "ItemSize", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "@", "$Failed"}]}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MemberQ", "[", 
         RowBox[{"sizes", ",", "Indeterminate", ",", 
          RowBox[{"{", "2", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "ResourceFunction", "[", "\"\<ResourceFunctionMessage\>\"", "]"}],
             "[", 
            RowBox[{
             RowBox[{"PlotGrid", "::", "cantScale"}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"#", "\[Equal]", "1"}], ",", "\"\<row\>\"", ",", 
               "\"\<column\>\""}], "]"}], ",", "#2"}], "]"}], "&"}], "@@", 
          RowBox[{"FirstPosition", "[", 
           RowBox[{"sizes", ",", "Indeterminate"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Return", "@", "$Failed"}]}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"sizes", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Normalize", "[", 
          RowBox[{"#", ",", "Total"}], "]"}], "&"}], "/@", "sizes"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sizeOffsets", "+=", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Total", "/@", "positionOffsets"}], "+", 
           RowBox[{"Total", "/@", "sizeOffsets"}]}], ")"}]}], "*", 
        "sizes"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sizes", "*=", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Total", "/@", "spacings"}]}], ")"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"positionOffsets", "=", 
       RowBox[{"AccumulateShifts", "[", 
        RowBox[{"sizeOffsets", ",", "positionOffsets"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"positions", "=", 
       RowBox[{"AccumulateShifts", "[", 
        RowBox[{"sizes", ",", "spacings"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"layoutData", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"xyLookupBL", "=", 
              RowBox[{"XYLookup", "[", 
               RowBox[{"#", "+", 
                RowBox[{"#2", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "0"}], "}"}]}]}], "]"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"xyLookupTR", "=", 
              RowBox[{"XYLookup", "[", 
               RowBox[{"#", "+", 
                RowBox[{"#2", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1"}], "}"}]}]}], "]"}]}]}], 
            "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"##", ",", "\[IndentingNewLine]", 
             RowBox[{"xyLookupBL", "@", "positions"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"xyLookupBL", "@", "positionOffsets"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"xyLookupTR", "@", "sizes"}], "+", 
              RowBox[{"xyLookupTR", "@", "positions"}], "-", 
              RowBox[{"xyLookupBL", "@", "positions"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"xyLookupTR", "@", "sizeOffsets"}], "+", 
              RowBox[{"xyLookupTR", "@", "positionOffsets"}], "-", 
              RowBox[{"xyLookupBL", "@", "positionOffsets"}]}]}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], 
         "&"}], "@@@", "structure"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"options", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"PlotRange", "\[Rule]", "Automatic"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AspectRatio", "\[Rule]", "aspectRatio"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", "->", 
             RowBox[{
              RowBox[{"ProcessPrologEpilogPrimitives", "[", 
               RowBox[{"layoutData", ",", 
                RowBox[{"gi", "[", "ImagePadding", "]"}], ",", 
                "effectivePlotRanges"}], "]"}], "@", 
              RowBox[{"OptionValue", "[", "#", "]"}]}]}], "}"}], "&"}], "/@", 
          
          RowBox[{"{", 
           RowBox[{"Prolog", ",", "Epilog"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "o", "}"}], ",", 
             RowBox[{"Options", "@", "Graphics"}]}], "]"}], ",", 
           RowBox[{"Except", "[", 
            RowBox[{"FrameLabel", "|", "Method", "|", "PlotRange"}], "]"}]}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Method", "\[Rule]", 
          RowBox[{"FilterRules", "[", 
           RowBox[{"method", ",", 
            RowBox[{"Except", "[", 
             RowBox[{"\"\<FixFrameTicks\>\"", "|", "\"\<AllCustomTicks\>\""}],
              "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"ImagePadding", "\[Rule]", "Automatic"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plots", ",", "legends"}], "}"}], "=", 
       RowBox[{"Reap", "@", 
        RowBox[{"Map", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"#", "=!=", "Null"}], ",", "\[IndentingNewLine]", 
             RowBox[{"ApplyToWrapped", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Sow", "@", "#2"}], ";", "#"}], ")"}], "&"}], ",", 
               "\[IndentingNewLine]", "#", ",", "\[IndentingNewLine]", 
               "_Graphics", ",", "\[IndentingNewLine]", 
               RowBox[{"Legended", "[", 
                RowBox[{"_", ",", 
                 RowBox[{"Except", "@", 
                  RowBox[{"_", "?", "LegendInsideQ"}]}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"Method", "\[Rule]", "Function"}]}], 
              "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
           "&"}], ",", "\[IndentingNewLine]", "plots", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"effectiveGridSize", "=", 
       RowBox[{
        RowBox[{"GraphicsInformation", "[", 
         RowBox[{"Graphics", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", "options"}], "]"}], "]"}], 
        "\[LeftDoubleBracket]", "\"\<PlotRangeSize\>\"", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"effectiveSizes", "=", 
       RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", "ny", ",", "nx"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[Rule]", 
            RowBox[{"#6", "+", 
             RowBox[{"#5", "*", "effectiveGridSize"}]}]}], "&"}], "@@@", 
          "layoutData"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gi", "=", 
       RowBox[{"GraphicsInformation", "@", "\[IndentingNewLine]", 
        RowBox[{"With", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"pl", "=", 
            RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"MatchQ", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{
                    RowBox[{"Alternatives", "@@", "$SpanMarkers"}], "|", 
                    "Null", "|", "None"}]}], "]"}]}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"Show", "[", "\[IndentingNewLine]", 
                  RowBox[{"#", ",", "\[IndentingNewLine]", 
                   RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"effectivePlotRanges", ",", "#2"}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"ImageSize", "->", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"effectiveSizes", ",", "#2"}], "]"}]}]}], 
                  "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                "]"}], "&"}], ",", "\[IndentingNewLine]", "plots", ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
           "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{"pl", ",", "\[IndentingNewLine]", 
            RowBox[{"Replace", "[", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{
               "we", " ", "also", " ", "need", " ", "GraphicsInformation", 
                " ", "for", " ", "the", " ", "plots", " ", "without", " ", 
                "PlotLabel"}], ",", " ", 
               RowBox[{
               "since", " ", "PlotLabel", " ", "is", " ", "placed", " ", 
                "outside", " ", "explicit", " ", "ImagePadding", " ", 
                "settings"}]}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"pl", ",", "\[IndentingNewLine]", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"p", ":", 
                   RowBox[{"Except", "[", "Null", "]"}]}], "/;", 
                  RowBox[{
                   RowBox[{"GraphicsOpt", "[", 
                    RowBox[{"p", ",", "PlotLabel"}], "]"}], "=!=", "None"}]}],
                  "\[RuleDelayed]", 
                 RowBox[{"Show", "[", 
                  RowBox[{"p", ",", 
                   RowBox[{"PlotLabel", "\[Rule]", "None"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"_", "\[Rule]", "Null"}]}], "\[IndentingNewLine]", 
               "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
           "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"giNoLabels", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#2", "===", "Null"}], ",", "##"}], "]"}], "&"}], ",", 
           "#", ",", "2"}], "]"}], "&"}], "/@", "gi"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"gi", "=", 
       RowBox[{"gi", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"paddingData", "=", 
       RowBox[{"ComputeEffectivePaddings", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nx", ",", "ny"}], "}"}], ",", "structure", ",", 
         RowBox[{"gi", "[", "ImagePadding", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"padding", "=", 
       RowBox[{"MapThread", "[", 
        RowBox[{"Construct", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"First", ",", "Last"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Last", ",", "First"}], "}"}]}], "}"}], ",", 
           "paddingData"}], "}"}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"frameStyle", "=", 
       RowBox[{
        RowBox[{"NormalizeGraphicsOpt", "[", "FrameStyle", "]"}], "@", 
        RowBox[{"Replace", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"OptionValue", "[", "FrameStyle", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Automatic", "\[Rule]", 
           RowBox[{"GraphicsOpt", "[", 
            RowBox[{
             RowBox[{"FirstCase", "[", 
              RowBox[{"plots", ",", "_Graphics", ",", 
               RowBox[{"{", "}"}], ",", "All"}], "]"}], ",", "FrameStyle"}], 
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"frameInsets", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"#", "=!=", "None"}], ",", "\[IndentingNewLine]", 
            RowBox[{"Inset", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"#3", "@", 
               RowBox[{"Pane", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"BaseStyle", "\[Rule]", 
                  RowBox[{"{", 
                   RowBox[{
                   "\"\<GraphicsLabel\>\"", ",", "\"\<GraphicsFrame\>\"", ",",
                     "#2"}], "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"Offset", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"5", "+", "#5"}], ")"}], "#4"}], ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0.5", ",", "0.5"}], "}"}], "+", 
                  RowBox[{"0.5", "#4"}]}], "]"}]}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ImageScaled", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.5", ",", "0.5"}], "}"}], "-", 
                RowBox[{"0.5", "#4"}]}], "]"}]}], "\[IndentingNewLine]", 
             "]"}], ",", "\[IndentingNewLine]", "Nothing"}], 
           "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"NormalizeGraphicsOpt", "[", "FrameLabel", "]"}], "@", 
            RowBox[{"OptionValue", "[", "FrameLabel", "]"}]}], ",", 
           "\[IndentingNewLine]", "frameStyle", ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"rotateLabel", ",", "rotateLabel"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Identity", ",", "Identity"}], "}"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"0", ",", 
                 RowBox[{"-", "1"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], "}"}], ",", 
           "\[IndentingNewLine]", "padding"}], "\[IndentingNewLine]", "}"}], 
         ",", "\[IndentingNewLine]", "2"}], "\[IndentingNewLine]", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"labelData", "=", 
       RowBox[{"CollectLabels", "[", "\[IndentingNewLine]", 
        RowBox[{"plots", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Catenate", "@*", 
           RowBox[{"Map", "[", "NormalizeLabelSpec", "]"}], "@*", 
           RowBox[{"Cases", "[", "_Labeled", "]"}]}], "/@", 
          RowBox[{"Join", "@@", "wrappers"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"NormalizeLabelOption", "[", 
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"plots", ",", 
             RowBox[{"Except", "[", "Null", "]"}], ",", 
             RowBox[{"{", "2", "}"}]}], "]"}], ",", 
           RowBox[{"OptionValue", "[", "PlotLabels", "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Left", ",", "Top"}], "}"}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"labelData", "=", 
       RowBox[{"KeyValueMap", "[", 
        RowBox[{"ProcessAutoLabel", ",", "labelData"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"labelInsets", "=", 
       RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"layout", "=", "#"}], ",", "\[IndentingNewLine]", 
              RowBox[{"pad", "=", 
               RowBox[{"MapThread", "[", 
                RowBox[{"Extract", ",", 
                 RowBox[{"{", 
                  RowBox[{"paddingData", ",", 
                   RowBox[{"ReverseY", "@", 
                    RowBox[{"Reverse", "@", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}]}]}]}], "}"}], ",", 
                 "2"}], "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"KeyValueMap", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"ConstructLabelInset", "[", "\[IndentingNewLine]", 
                RowBox[{
                "layout", ",", "\[IndentingNewLine]", "pad", ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"MapAt", "[", 
                   RowBox[{"Transpose", ",", "1"}], "]"}], "@", 
                  RowBox[{"placedHelper", "@", "#"}]}], ",", 
                 "\[IndentingNewLine]", "#2", ",", "\[IndentingNewLine]", 
                 RowBox[{"OptionValue", "[", "LabelStyle", "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"OptionValue", "[", "LabelingFunction", "]"}]}], 
                "\[IndentingNewLine]", "]"}], "&"}], ",", 
              "\[IndentingNewLine]", "#2"}], "\[IndentingNewLine]", "]"}]}], 
           "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{"layoutData", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Extract", "[", 
                RowBox[{"plots", ",", 
                 RowBox[{
                 "#", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], "=!=", "Null"}], 
              "&"}]}], "]"}], ",", "\[IndentingNewLine]", "labelData"}], 
          "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mergeAxesInsets", ",", "mergeAxesZeroSize"}], "}"}], "=", 
       RowBox[{"Reap", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"With", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"gr", "=", 
                 RowBox[{"Extract", "[", 
                  RowBox[{"plots", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"spac", "=", 
                 RowBox[{"LookupSpacings", "[", 
                  RowBox[{"rawSpacings", ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}]}], 
               "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"gr", "=!=", "Null"}], ",", "\[IndentingNewLine]", 
                RowBox[{"Table", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"ConstructMergeInset", "[", "\[IndentingNewLine]", 
                   RowBox[{"#", ",", "\[IndentingNewLine]", 
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"spac", "[", "dir", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Scaled", "@", "s_"}], "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", "0"}], "}"}]}], ",", 
                    RowBox[{
                    RowBox[{"Missing", "[", "]"}], "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                    RowBox[{"s_", "\[RuleDelayed]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "s"}], "}"}]}]}], "}"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"NormalizedOptionValue", "[", 
                    RowBox[{"gr", ",", "Frame"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Extract", "[", 
                    RowBox[{
                    RowBox[{"gi", "[", "ImagePadding", "]"}], ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", "dir", ",", "\[IndentingNewLine]", 
                    
                    RowBox[{"Extract", "[", 
                    RowBox[{"#2", ",", 
                    RowBox[{"$SidePositions", "[", "dir", "]"}]}], "]"}], ",",
                     "\[IndentingNewLine]", 
                    RowBox[{"NormalizedOptionValue", "[", 
                    RowBox[{"gr", ",", "FrameStyle"}], "]"}], ",", 
                    "\[IndentingNewLine]", "#2"}], "\[IndentingNewLine]", 
                   "]"}], ",", "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{"dir", ",", 
                    RowBox[{"Keys", "@", "$SidePositions"}]}], "}"}]}], 
                 "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                "Nothing"}], "\[IndentingNewLine]", "]"}]}], 
             "\[IndentingNewLine]", "]"}], "&"}], ",", "\[IndentingNewLine]", 
           
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{"layoutData", ",", "\[IndentingNewLine]", "mergeAxes"}], 
            "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "]"}], ",",
          "\[IndentingNewLine]", "ConstructMergeInset"}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"mergeAxesZeroSize", "=!=", 
         RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "ResourceFunction", "[", "\"\<ResourceFunctionMessage\>\"", "]"}], 
         "[", 
         RowBox[{"PlotGrid", "::", "zeroSize"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Inset", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"If", "[", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"!", 
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"l", ",", "#"}], "]"}], ",", 
                    RowBox[{"Null", "|", "None"}]}], "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"Annotation", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Inset", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"l", ",", "#"}], "]"}], ",", 
                    RowBox[{"Alternatives", "@@", "$SpanMarkers"}]}], "]"}]}],
                     ",", "\[IndentingNewLine]", 
                    RowBox[{"Show", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"plots", ",", "#"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotRangePadding", "\[Rule]", "None"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"PlotRange", "\[Rule]", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"effectivePlotRanges", ",", "#"}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"ImagePadding", "\[Rule]", 
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{
                    RowBox[{"giNoLabels", "[", "ImagePadding", "]"}], ",", 
                    "#"}], "]"}], "+", "1"}]}], 
                    RowBox[{"(*", 
                    RowBox[{"fix", " ", "clipping", " ", "of", " ", "frame"}],
                     "*)"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"AspectRatio", "\[Rule]", "Full"}]}], 
                    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Table", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Inset", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Graphics", "@", 
                    RowBox[{"Disk", "[", "]"}]}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{"Scaled", "[", "\[IndentingNewLine]", 
                    RowBox[{"0.5", "+", 
                    RowBox[{"0.2", "i", "*", 
                    RowBox[{"Switch", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"l", ",", "#"}], "]"}], ",", 
                    "\[IndentingNewLine]", "SpanFromLeft", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    "\[IndentingNewLine]", "SpanFromAbove", ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "1"}], "}"}], ",", 
                    "\[IndentingNewLine]", "_", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Scaled", "@", "0.2"}]}], "\[IndentingNewLine]", 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], 
                    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{"PlotRange", "\[Rule]", "1"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"AspectRatio", "\[Rule]", "Full"}]}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Offset", "[", 
                    RowBox[{"#4", ",", "#3"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Scaled", "[", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Offset", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Total", "/@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{
                    RowBox[{"gi", "[", "ImagePadding", "]"}], ",", "#"}], 
                    "]"}], "/.", 
                    RowBox[{"Null", "\[Rule]", "0"}]}], ")"}]}], "+", "#6", 
                    "+", "2"}], 
                    RowBox[{"(*", 
                    RowBox[{"fix", " ", "clipping", " ", "of", " ", "frame"}],
                     "*)"}], ",", "#5"}], "]"}]}], "\[IndentingNewLine]", 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"\"\<PlotGridItem\>\"", ",", "##"}], "}"}]}], 
                    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                  "]"}], "&"}], "@@@", "layoutData"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"PlotRange", "\[Rule]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ImagePadding", "\[Rule]", "padding"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"AspectRatio", "\[Rule]", "Full"}]}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Offset", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"padding", "\[LeftDoubleBracket]", 
                 RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
               
               RowBox[{"Scaled", "@", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ImageScaled", "@", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Offset", "[", 
              RowBox[{
               RowBox[{"Total", "/@", "padding"}], ",", 
               RowBox[{"Scaled", "@", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], 
            "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
           "frameInsets", ",", "\[IndentingNewLine]", "labelInsets", ",", 
           "\[IndentingNewLine]", "mergeAxesInsets"}], "\[IndentingNewLine]", 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"DeleteDuplicatesBy", "[", "First", "]"}], "@", 
          RowBox[{"Flatten", "@", "options"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"effectiveSizes", "=", 
       RowBox[{"ReplacePart", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", "ny", ",", "nx"}], "]"}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[Rule]", 
            RowBox[{"#6", "+", 
             RowBox[{"#5", "*", "effectiveGridSize"}]}]}], "&"}], "@@@", 
          "layoutData"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"fixTicks", ",", "\[IndentingNewLine]", 
        RowBox[{"grid", "=", 
         RowBox[{"grid", "/.", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Annotation", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Inset", "[", "\[IndentingNewLine]", 
              RowBox[{"gr_", ",", "\[IndentingNewLine]", "rest___"}], 
              "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"a", ":", 
              RowBox[{"{", 
               RowBox[{
               "\"\<PlotGridItem\>\"", ",", "idx_", ",", "_", ",", "_", ",", 
                "_", ",", "size_", ",", "sizeOff_"}], "}"}]}]}], 
            "\[IndentingNewLine]", "]"}], "\[RuleDelayed]", 
           "\[IndentingNewLine]", 
           RowBox[{"Annotation", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Inset", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Show", "[", "\[IndentingNewLine]", 
                RowBox[{"gr", ",", "\[IndentingNewLine]", 
                 RowBox[{"FrameTicks", "\[Rule]", 
                  RowBox[{"MapAt", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"ScaleFrameTicksV2", "[", 
                    RowBox[{
                    RowBox[{"Divide", "@@", 
                    RowBox[{"(", 
                    RowBox[{"sizeOff", "+", 
                    RowBox[{"size", "*", "effectiveGridSize"}]}], ")"}]}], 
                    ",", 
                    RowBox[{"Divide", "@@", 
                    RowBox[{"Subtract", "@@@", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"effectivePlotRanges", ",", "idx"}], "]"}]}]}]}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"NormalizedOptionValue", "[", 
                    RowBox[{"gr", ",", "FrameTicks"}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "All"}], "}"}]}], "\[IndentingNewLine]",
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
               "\[IndentingNewLine]", "rest"}], "\[IndentingNewLine]", "]"}], 
             ",", "\[IndentingNewLine]", "a"}], "\[IndentingNewLine]", 
            "]"}]}]}]}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"grid", "=", 
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{"grid", ",", "\[IndentingNewLine]", 
         RowBox[{"CoordinatesToolOptions", "\[Rule]", 
          RowBox[{"With", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"layoutData", "=", "layoutData"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"imagePadding", "=", 
               RowBox[{"First", "/@", "padding"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"plotRanges", "=", "effectivePlotRanges"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"df", "=", 
               RowBox[{"Map", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"#", "=!=", "Null"}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{
                    RowBox[{"GetCoordinatesToolOptions", "[", "#", "]"}], 
                    "@", "\"\<DisplayFunction\>\""}]}], "\[IndentingNewLine]",
                    "]"}], "&"}], ",", "\[IndentingNewLine]", "plots", ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"cvf", "=", 
               RowBox[{"Map", "[", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"#", "=!=", "Null"}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{
                    RowBox[{"GetCoordinatesToolOptions", "[", "#", "]"}], 
                    "@", "\"\<CopiedValueFunction\>\""}]}], 
                   "\[IndentingNewLine]", "]"}], "&"}], ",", 
                 "\[IndentingNewLine]", "plots", ",", "\[IndentingNewLine]", 
                 RowBox[{"{", "2", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
             "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Function", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "type", ",", "updateScale", ",", "funcs", ",", "valFunc", ",",
                  "def"}], "}"}], ",", "\[IndentingNewLine]", 
               RowBox[{"type", "\[Rule]", 
                RowBox[{"(", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"$VersionNumber", "==", "12.3"}], ",", 
                    "\[IndentingNewLine]", 
                    "\"\<Not supported in Mathematica 12.3 due to Front-End \
crash\>\"", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"updateScale", "||", 
                    RowBox[{"!", 
                    RowBox[{"ListQ", "@", "plotScaleData"}]}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{
                    "Try", " ", "to", " ", "compute", " ", "plot", " ", 
                    "size", " ", "in", " ", "absolute", " ", "units", " ", 
                    "needed", " ", "for", " ", "coordinate", " ", 
                    "transformations"}], ",", " ", 
                    RowBox[{
                    "using", " ", "image", " ", "corner", " ", "or", " ", 
                    "plot", " ", "range", " ", "corner", " ", "as", " ", 
                    RowBox[{"reference", ".", " ", "Since"}], " ", 
                    "\"\<CopiedValueFunction\>\"", " ", "is", " ", "only", 
                    " ", "called", " ", "once", " ", "the", " ", "values", 
                    " ", "are", " ", "copied"}], ",", " ", 
                    RowBox[{
                    "we", " ", "need", " ", "to", " ", "cache", " ", "this", 
                    " ", "value", " ", "for", " ", "the", " ", "case", " ", 
                    "that", " ", "the", " ", "mouse", " ", "is", " ", "no", 
                    " ", "longer", " ", "on", " ", "top", " ", "of", " ", 
                    "the", " ", "plot"}]}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"plotScaleData", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "MousePosition", "[", "\"\<GraphicsImageScaled\>\"", 
                    "]"}], ",", 
                    RowBox[{
                    "MousePosition", "[", "\"\<GraphicsAbsolute\>\"", "]"}]}],
                     "}"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"plotData", "=", 
                    RowBox[{"FirstCase", "[", "\[IndentingNewLine]", 
                    RowBox[{"layoutData", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    "idx_", ",", "_", ",", "pos_", ",", "posOff_", ",", 
                    "size_", ",", "sizeOff_"}], "}"}], "\[RuleDelayed]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"cursor", "=", 
                    RowBox[{"#", "*", 
                    RowBox[{
                    "plotScaleData", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"effPos", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"posOff", ",", "pos"}], "}"}], "*", 
                    "plotScaleData"}], "]"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"effSize", "=", 
                    RowBox[{"Total", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"sizeOff", ",", "size"}], "}"}], "*", 
                    "plotScaleData"}], "]"}]}]}], "\[IndentingNewLine]", 
                    "}"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"idx", ",", "cursor", ",", "effPos", ",", 
                    RowBox[{"effPos", "+", "effSize"}]}], "}"}], "/;", 
                    "\[IndentingNewLine]", 
                    RowBox[{"And", "@@", 
                    RowBox[{"Thread", "[", 
                    RowBox[{"effPos", "<", "cursor", "<", 
                    RowBox[{"effPos", "+", "effSize"}]}], "]"}]}]}]}], 
                    "\[IndentingNewLine]", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}]}], "\[IndentingNewLine]", 
                    "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"With", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{"id", "=", 
                    RowBox[{"First", "@", "plotData"}]}], 
                    "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
                    
                    RowBox[{"If", "[", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"FreeQ", "[", 
                    RowBox[{"id", ",", "0"}], "]"}], "&&", 
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{"plotRanges", ",", "id"}], "]"}], "=!=", 
                    "Null"}]}], ",", "\[IndentingNewLine]", 
                    RowBox[{"valFunc", "[", "\[IndentingNewLine]", 
                    RowBox[{"id", ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#", "=!=", "None"}], ",", "#", ",", 
                    RowBox[{"Nothing", "&"}]}], "]"}], "&"}], "[", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"funcs", ",", "id"}], "]"}], "]"}], "@", 
                    RowBox[{"MapThread", "[", "\[IndentingNewLine]", 
                    RowBox[{"Rescale", ",", "\[IndentingNewLine]", 
                    RowBox[{"{", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    "plotData", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{"Transpose", "@", 
                    RowBox[{"plotData", "\[LeftDoubleBracket]", 
                    RowBox[{"3", ";;"}], "\[RightDoubleBracket]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"Extract", "[", 
                    RowBox[{"plotRanges", ",", "id"}], "]"}]}], 
                    "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
                    "\[IndentingNewLine]", "def"}], "\[IndentingNewLine]", 
                    "]"}]}], "\[IndentingNewLine]", "]"}]}], 
                    "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
                   "]"}], "&"}], ")"}]}]}], "\[IndentingNewLine]", "]"}], "@@@", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "\"\<DisplayFunction\>\"", ",", "True", ",", "df", ",", 
                 RowBox[{
                  RowBox[{"Column", "@", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Row", "@", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Plot: \>\"", ",", "#"}], "}"}]}], ",", 
                    "#2"}], "}"}]}], "&"}], ",", 
                 "\"\<Not inside a plot\>\""}], "}"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{
                "\"\<CopiedValueFunction\>\"", ",", "False", ",", "cvf", ",", 
                 "List", ",", 
                 RowBox[{"Missing", "[", "\"\<OutsidePlot\>\"", "]"}]}], 
                "}"}]}], "\[IndentingNewLine]", "}"}]}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"RightComposition", "@@", 
         RowBox[{"Flatten", "@", "legends"}]}], ")"}], "@", 
       RowBox[{"InjectCustomTicksLoading", "@", "grid"}]}]}]}], 
    "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 TaggingRules->{},
 InitializationCell->True,
 CellChangeTimes->{{3.779962844209722*^9, 3.779962895354743*^9}, {
   3.7799629326308765`*^9, 3.779962934195877*^9}, {3.7799629939173417`*^9, 
   3.7799631980271907`*^9}, {3.7799636235072327`*^9, 
   3.7799636358244705`*^9}, {3.779963931132207*^9, 3.7799641617041454`*^9}, {
   3.779964193754588*^9, 3.7799645922879486`*^9}, {3.7799649537390203`*^9, 
   3.7799649545304985`*^9}, {3.7799651018949823`*^9, 
   3.7799651021050043`*^9}, {3.797324891293642*^9, 3.7973248939616694`*^9}, {
   3.797325039767723*^9, 3.7973250585669947`*^9}, {3.7973251536917367`*^9, 
   3.7973251657353616`*^9}, {3.797325436310334*^9, 3.797325452969355*^9}, {
   3.797325494127005*^9, 3.797325499520811*^9}, {3.797445861053401*^9, 
   3.797445871453496*^9}, {3.7974459336052675`*^9, 3.797446007780594*^9}, {
   3.7974885974976873`*^9, 3.797488648652796*^9}, {3.79748937881625*^9, 
   3.7974894345221057`*^9}, 3.7974896397072105`*^9, {3.7974915387987237`*^9, 
   3.797491557197109*^9}, {3.7974916256281967`*^9, 3.7974916378087397`*^9}, {
   3.797491703632185*^9, 3.797491714210147*^9}, {3.7974921285228977`*^9, 
   3.797492136300346*^9}, {3.797492590799653*^9, 3.797492703677594*^9}, {
   3.797494033485634*^9, 3.7974941115289836`*^9}, {3.7974941655966644`*^9, 
   3.79749418635894*^9}, {3.7974942388286533`*^9, 3.7974942566272726`*^9}, {
   3.7974943574214163`*^9, 3.7974945140961857`*^9}, {3.797494551277649*^9, 
   3.7974946147066717`*^9}, {3.797496306832795*^9, 3.797496316868812*^9}, {
   3.797496406577403*^9, 3.7974965978021483`*^9}, 3.797496802007571*^9, {
   3.7974968693471785`*^9, 3.7974969848513927`*^9}, {3.797497094553057*^9, 
   3.7974971099988637`*^9}, {3.7974971407914414`*^9, 
   3.7974971548921547`*^9}, {3.797497196433968*^9, 3.797497226181648*^9}, {
   3.797497341013458*^9, 3.797497359581539*^9}, {3.797498329716967*^9, 
   3.797498390691749*^9}, {3.797499537855776*^9, 3.7974995654129486`*^9}, {
   3.7974996863185515`*^9, 3.797499802393463*^9}, 3.797499941351082*^9, {
   3.797500007068752*^9, 3.7975004032923985`*^9}, {3.797500457097136*^9, 
   3.7975005078910184`*^9}, {3.797500543067929*^9, 3.7975007140563855`*^9}, {
   3.7975007776610126`*^9, 3.7975008046173224`*^9}, {3.7975010289758935`*^9, 
   3.797501068690292*^9}, {3.7975011136761613`*^9, 3.7975011165626707`*^9}, {
   3.7975013230498796`*^9, 3.797501330844458*^9}, {3.7975013756066465`*^9, 
   3.797501423275819*^9}, {3.797501466518016*^9, 3.7975014917079477`*^9}, {
   3.797501552713854*^9, 3.797501564623168*^9}, {3.797507133432016*^9, 
   3.7975072252802935`*^9}, {3.797507261572548*^9, 3.7975074349342117`*^9}, {
   3.797507465658244*^9, 3.797507473211062*^9}, {3.7975079023518496`*^9, 
   3.79750795512086*^9}, {3.7975080381820707`*^9, 3.7975082180430927`*^9}, {
   3.7975083637591777`*^9, 3.797508467696848*^9}, {3.797508522138087*^9, 
   3.7975086138692827`*^9}, {3.7975086451583176`*^9, 3.79750878524008*^9}, {
   3.7975088321636157`*^9, 3.7975088390806465`*^9}, {3.7975090110732794`*^9, 
   3.7975090348425198`*^9}, 3.7975093972004895`*^9, {3.797509506471697*^9, 
   3.7975096054922647`*^9}, {3.797509653506118*^9, 3.797509704579102*^9}, {
   3.797509917120302*^9, 3.797509951419815*^9}, {3.7975106244022493`*^9, 
   3.797510629113824*^9}, {3.7975114573384604`*^9, 3.7975114810469017`*^9}, {
   3.7975115118412676`*^9, 3.7975115122302685`*^9}, {3.79751187946727*^9, 
   3.7975119390474477`*^9}, {3.7975119750822115`*^9, 3.797511992080392*^9}, {
   3.79751203969798*^9, 3.797512126958842*^9}, {3.79751238131009*^9, 
   3.7975123842827225`*^9}, {3.7975124799229608`*^9, 
   3.7975124807499638`*^9}, {3.797512736543913*^9, 3.7975127367469177`*^9}, {
   3.797513032606778*^9, 3.797513047234909*^9}, {3.7975130948501577`*^9, 
   3.797513105088231*^9}, {3.797513307947446*^9, 3.7975133945851793`*^9}, {
   3.797513463088695*^9, 3.797513481722828*^9}, {3.797513551358333*^9, 
   3.797513552588332*^9}, {3.7975135870975666`*^9, 3.7975136561348996`*^9}, {
   3.7975136866312675`*^9, 3.7975136898286247`*^9}, {3.7975137919130154`*^9, 
   3.797513796006606*^9}, {3.7975138773062687`*^9, 3.797513880272683*^9}, {
   3.797514026918105*^9, 3.797514027844616*^9}, 3.797521019005261*^9, {
   3.7975210580198393`*^9, 3.797521122469139*^9}, {3.797521178805891*^9, 
   3.79752118516473*^9}, {3.797521244437041*^9, 3.7975212665450425`*^9}, {
   3.7975213344158792`*^9, 3.7975213610654774`*^9}, {3.7975214381993723`*^9, 
   3.797521441704525*^9}, {3.797521496149403*^9, 3.797521652748415*^9}, {
   3.797521689957301*^9, 3.797521691570318*^9}, {3.797521797631671*^9, 
   3.7975217983626547`*^9}, {3.7975304970852213`*^9, 
   3.7975305954188704`*^9}, {3.7975306254851236`*^9, 3.797530665046875*^9}, {
   3.7975306986830406`*^9, 3.797530710651806*^9}, {3.7975307808037724`*^9, 
   3.797530781451851*^9}, {3.7975308180959663`*^9, 3.7975308268528366`*^9}, {
   3.797530867548908*^9, 3.7975309182687273`*^9}, {3.797530954855757*^9, 
   3.7975309769248734`*^9}, {3.797580756429164*^9, 3.7975807743076715`*^9}, {
   3.7977520272517357`*^9, 3.79775205545079*^9}, {3.797752121966303*^9, 
   3.7977521582316904`*^9}, {3.797752371566375*^9, 3.797752372083373*^9}, 
   3.797917857804801*^9, {3.7979178924466963`*^9, 3.797917933121359*^9}, 
   3.7979181537590322`*^9, {3.797918649248607*^9, 3.797918688513242*^9}, {
   3.797918727758813*^9, 3.7979188547820845`*^9}, {3.7979189131759763`*^9, 
   3.7979190139954214`*^9}, {3.7979190582280707`*^9, 
   3.7979192329621997`*^9}, {3.797919282253395*^9, 3.797919293844949*^9}, {
   3.797919523453692*^9, 3.79791953518071*^9}, 3.7979195716692057`*^9, {
   3.797921230698761*^9, 3.7979213012864933`*^9}, {3.7979213346107826`*^9, 
   3.797921335311782*^9}, {3.7979214018332205`*^9, 3.797921447763932*^9}, {
   3.7979234491260424`*^9, 3.797923488870306*^9}, {3.7979382853947453`*^9, 
   3.797938385448554*^9}, {3.797938719675357*^9, 3.7979387206453443`*^9}, {
   3.7980061860802364`*^9, 3.7980061864022512`*^9}, {3.7980063815711536`*^9, 
   3.7980064894427147`*^9}, {3.7980068416390452`*^9, 
   3.7980068488053875`*^9}, {3.7980068900111237`*^9, 
   3.7980068919441347`*^9}, {3.7980070137258244`*^9, 3.798007029947896*^9}, {
   3.798007061105077*^9, 3.798007063276808*^9}, {3.798008103631234*^9, 
   3.7980081541703978`*^9}, {3.7980084496786814`*^9, 3.798008489429037*^9}, {
   3.798008638379958*^9, 3.7980086635792527`*^9}, {3.7980294075997005`*^9, 
   3.7980294469997196`*^9}, {3.7980294786807103`*^9, 3.798029608563093*^9}, {
   3.798029672881957*^9, 3.7980297079193087`*^9}, {3.798029747090228*^9, 
   3.7980297574401217`*^9}, {3.7985374532945595`*^9, 3.798537600331833*^9}, {
   3.7985376315889864`*^9, 3.79853777059121*^9}, {3.7985378282978115`*^9, 
   3.7985378749839635`*^9}, {3.798537927743106*^9, 3.798537975830995*^9}, {
   3.7985380183463955`*^9, 3.7985380562789087`*^9}, {3.798538144492059*^9, 
   3.798538146199117*^9}, {3.798538212206933*^9, 3.798538241838393*^9}, {
   3.798538388233109*^9, 3.7985383901431365`*^9}, {3.798538440704079*^9, 
   3.79853844229442*^9}, {3.798538575729018*^9, 3.798538579038989*^9}, {
   3.7985386441989503`*^9, 3.7985386840860343`*^9}, {3.7985389094880204`*^9, 
   3.798538918517821*^9}, {3.7985457013925514`*^9, 3.7985457043929796`*^9}, {
   3.798545840432366*^9, 3.798545840608021*^9}, {3.7985495780368032`*^9, 
   3.798549589665801*^9}, {3.798549968107089*^9, 3.798549969634074*^9}, {
   3.798640520365041*^9, 3.7986405350008326`*^9}, {3.798640602945033*^9, 
   3.798640606034009*^9}, {3.798641335411072*^9, 3.798641423098402*^9}, {
   3.79864154286263*^9, 3.798641573266206*^9}, {3.798641691059065*^9, 
   3.798641704797033*^9}, {3.7986931065955124`*^9, 3.798693191281684*^9}, {
   3.7986932941936755`*^9, 3.798693294844676*^9}, {3.798694268680315*^9, 
   3.7986942750097637`*^9}, {3.798703486373814*^9, 3.798703489752885*^9}, {
   3.7987035852812347`*^9, 3.798703587315631*^9}, {3.7987171865206394`*^9, 
   3.7987171908961515`*^9}, {3.798723347623257*^9, 3.798723482895481*^9}, {
   3.798723700919218*^9, 3.798723781398555*^9}, {3.79872385267107*^9, 
   3.798723854613126*^9}, {3.798723974939228*^9, 3.798723975670227*^9}, {
   3.798724035359951*^9, 3.798724052061062*^9}, {3.7987323922812843`*^9, 
   3.7987323924483056`*^9}, {3.79873244233304*^9, 3.7987324540999107`*^9}, {
   3.7987326501135597`*^9, 3.7987326503115807`*^9}, {3.798740221253837*^9, 
   3.798740223709838*^9}, {3.7987404167844877`*^9, 3.7987404170144873`*^9}, 
   3.798741348409489*^9, {3.79905429155888*^9, 3.7990543217440157`*^9}, {
   3.799054364981386*^9, 3.7990543694492965`*^9}, {3.79905440348622*^9, 
   3.799054450693552*^9}, {3.799054527403107*^9, 3.7990546526980724`*^9}, {
   3.799055408055119*^9, 3.799055408836132*^9}, {3.799056724111953*^9, 
   3.799056724847953*^9}, {3.7990567821932983`*^9, 3.7990567823932805`*^9}, {
   3.7990568171385536`*^9, 3.799056817761531*^9}, {3.7990569379807987`*^9, 
   3.7990569857183743`*^9}, {3.799057022734634*^9, 3.7990572293897395`*^9}, {
   3.7990577455348597`*^9, 3.7990577498638463`*^9}, {3.799057835903996*^9, 
   3.799057837162999*^9}, 3.7990579322732515`*^9, {3.7990680817412567`*^9, 
   3.799068082410135*^9}, {3.799068121678069*^9, 3.7990681218671064`*^9}, {
   3.7990689214280367`*^9, 3.799068995605187*^9}, {3.799069050307604*^9, 
   3.799069085611354*^9}, {3.7990691197454257`*^9, 3.7990691255582657`*^9}, {
   3.799070864864106*^9, 3.7990709046483116`*^9}, {3.799071564172711*^9, 
   3.7990717188012886`*^9}, {3.7990718958212805`*^9, 3.799071901121541*^9}, {
   3.799071939497828*^9, 3.7990719425956864`*^9}, {3.799071983154481*^9, 
   3.799071983809473*^9}, {3.7990720907746863`*^9, 3.7990721146153297`*^9}, {
   3.799072152434248*^9, 3.799072180241722*^9}, {3.7990728285603*^9, 
   3.799072833215027*^9}, {3.7990729831420774`*^9, 3.799072984110077*^9}, {
   3.7990788660627947`*^9, 3.7990788667667975`*^9}, {3.799078992930603*^9, 
   3.7990790411126113`*^9}, {3.7990791398398075`*^9, 
   3.7990791720397778`*^9}, {3.799079324188236*^9, 3.7990794279208837`*^9}, {
   3.7990798273626375`*^9, 3.799079846350664*^9}, {3.7990799233243275`*^9, 
   3.7990799424891825`*^9}, {3.7990799732728624`*^9, 3.799079980280979*^9}, {
   3.79908001181293*^9, 3.79908017401898*^9}, {3.799080228292158*^9, 
   3.7990802289891586`*^9}, {3.799080286345374*^9, 3.7990802878343754`*^9}, {
   3.799080335642042*^9, 3.799080358833579*^9}, {3.7990805045907574`*^9, 
   3.799080533437396*^9}, {3.805271875298499*^9, 3.8052718794553823`*^9}, {
   3.8052842904351225`*^9, 3.805284310273588*^9}, {3.8052843449673033`*^9, 
   3.8052843557952433`*^9}, {3.805284430022813*^9, 3.805284521198323*^9}, {
   3.8052845787531404`*^9, 3.805284595141921*^9}, {3.805284714533369*^9, 
   3.805284722194343*^9}, {3.8052847994914474`*^9, 3.8052848469488573`*^9}, {
   3.8052849209874983`*^9, 3.805284959583974*^9}, {3.805285763477995*^9, 
   3.8052857652075686`*^9}, {3.805286559741505*^9, 3.8052865623245068`*^9}, {
   3.8052866053085556`*^9, 3.80528667744217*^9}, {3.8052869061683807`*^9, 
   3.8052869096330595`*^9}, {3.8052869411882772`*^9, 3.805286964178446*^9}, {
   3.805287091523975*^9, 3.8052871938795624`*^9}, {3.805287226968112*^9, 
   3.805287227698161*^9}, {3.8052872596357737`*^9, 3.8052872638207645`*^9}, {
   3.8053630922431655`*^9, 3.805363125773677*^9}, 3.8053634077891617`*^9, {
   3.8053641081082067`*^9, 3.8053641206273518`*^9}, {3.805367265148365*^9, 
   3.805367297745944*^9}, {3.805367373592445*^9, 3.805367559851767*^9}, {
   3.805367602949326*^9, 3.805367708602991*^9}, {3.8053677415212846`*^9, 
   3.8053677772311563`*^9}, {3.805367819023758*^9, 3.8053678220005736`*^9}, {
   3.805367866070523*^9, 3.805367911011752*^9}, {3.8053679590403023`*^9, 
   3.8053679622088113`*^9}, {3.805368012355028*^9, 3.8053680182192802`*^9}, {
   3.805368265809588*^9, 3.805368266962556*^9}, 3.8053683383424025`*^9, {
   3.8053683821038136`*^9, 3.8053684159920797`*^9}, {3.8053685077842765`*^9, 
   3.8053685086532536`*^9}, {3.8053685440158005`*^9, 
   3.8053686016779346`*^9}, {3.8053887950562754`*^9, 
   3.8053889056191235`*^9}, {3.805389031916357*^9, 3.8053890339643393`*^9}, {
   3.8053892298186665`*^9, 3.8053892331682043`*^9}, {3.8053892766313286`*^9, 
   3.8053892785608873`*^9}, {3.8053893771680994`*^9, 3.805389545777049*^9}, {
   3.805389598033477*^9, 3.8053896404140005`*^9}, {3.8053899509429607`*^9, 
   3.8053900624294343`*^9}, {3.8053901127935534`*^9, 
   3.8053901338890686`*^9}, {3.8053902600669622`*^9, 
   3.8053903318104043`*^9}, {3.805390402255666*^9, 3.8053904023626795`*^9}, {
   3.8053905802018833`*^9, 3.8053905824928665`*^9}, {3.805390817863654*^9, 
   3.8053908221046762`*^9}, 3.8053908650148993`*^9, {3.8053909531583223`*^9, 
   3.8053909874802656`*^9}, {3.805430989813455*^9, 3.8054310116198463`*^9}, {
   3.806242259718589*^9, 3.8062422885628157`*^9}, {3.806242399500128*^9, 
   3.8062424692138824`*^9}, {3.8062425736773624`*^9, 
   3.8062426633549957`*^9}, {3.8062427667673216`*^9, 
   3.8062427997000127`*^9}, {3.806242883765683*^9, 3.806242929644125*^9}, {
   3.8062429925744643`*^9, 3.8062430692673836`*^9}, {3.8062431626258173`*^9, 
   3.806243216079073*^9}, {3.8062432868867865`*^9, 3.8062433525411415`*^9}, {
   3.806243538353502*^9, 3.8062436032329755`*^9}, {3.8062436856145086`*^9, 
   3.806243686503644*^9}, {3.8062437502659426`*^9, 3.806243812152689*^9}, {
   3.806243902538138*^9, 3.806243968680701*^9}, {3.806244150678353*^9, 
   3.806244209067671*^9}, {3.806244241187771*^9, 3.806244253834934*^9}, {
   3.806244470467757*^9, 3.8062444717899466`*^9}, {3.8062445472641754`*^9, 
   3.806244549296248*^9}, {3.8062447292893705`*^9, 3.806244759592536*^9}, {
   3.8062448324465513`*^9, 3.806244836941674*^9}, {3.8062493847854905`*^9, 
   3.8062493954974904`*^9}, {3.806307389914818*^9, 3.8063074205501175`*^9}, {
   3.806309718728659*^9, 3.806309724924666*^9}, {3.806310677278042*^9, 
   3.8063107153855333`*^9}, {3.806310818544256*^9, 3.8063108192782555`*^9}, {
   3.806310925739815*^9, 3.8063109286896906`*^9}, {3.806311019614835*^9, 
   3.806311021198887*^9}, {3.806311276629081*^9, 3.806311283093298*^9}, {
   3.806311316302744*^9, 3.8063113250486507`*^9}, {3.8063113645842876`*^9, 
   3.8063114463239927`*^9}, {3.8063114763471427`*^9, 3.806311500061685*^9}, {
   3.8063115355696545`*^9, 3.806311633483815*^9}, {3.8063119837371244`*^9, 
   3.806311985292122*^9}, {3.8063282022504406`*^9, 3.806328231445388*^9}, {
   3.8063310601446447`*^9, 3.806331061366184*^9}, {3.8063386193220353`*^9, 
   3.806338722478685*^9}, {3.8063388228495665`*^9, 3.8063388248164515`*^9}, {
   3.806338877352725*^9, 3.8063388828373036`*^9}, {3.806338958866066*^9, 
   3.806338961133995*^9}, {3.806340466011162*^9, 3.8063404689207463`*^9}, {
   3.806340589447071*^9, 3.8063405928702583`*^9}, {3.8063406506371336`*^9, 
   3.8063406561349077`*^9}, {3.806665499253203*^9, 3.8066655002153006`*^9}, {
   3.80666554209141*^9, 3.806665560910328*^9}, {3.806665695906205*^9, 
   3.8066656959811983`*^9}, {3.806769043474416*^9, 3.8067690939764786`*^9}, {
   3.806770262624449*^9, 3.806770269004077*^9}, {3.8067735487395053`*^9, 
   3.8067735499520187`*^9}, {3.806930940942655*^9, 3.8069309419027615`*^9}, {
   3.8069310248588867`*^9, 3.8069310354293036`*^9}, {3.8069315116920767`*^9, 
   3.8069315356473026`*^9}, {3.8069315704251213`*^9, 3.806931713115863*^9}, {
   3.8069317746581106`*^9, 3.8069317861639776`*^9}, {3.8069318973849154`*^9, 
   3.8069320295776834`*^9}, {3.8069322377701607`*^9, 3.806932242475378*^9}, {
   3.8069471885659237`*^9, 3.8069472410285697`*^9}, {3.8069473593915477`*^9, 
   3.8069473854808493`*^9}, {3.8069474672652326`*^9, 
   3.8069475991082582`*^9}, {3.8069476291712875`*^9, 
   3.8069476299908895`*^9}, {3.8069477061101665`*^9, 
   3.8069477065097513`*^9}, {3.806947961879116*^9, 3.8069479718009157`*^9}, {
   3.8069484194617233`*^9, 3.806948425161805*^9}, {3.806949902607067*^9, 
   3.806949951043442*^9}, 3.806951522007961*^9, {3.8069537343232946`*^9, 
   3.806953734469928*^9}, {3.806953764560355*^9, 3.806954017604534*^9}, {
   3.806954084607809*^9, 3.806954085339551*^9}, {3.8069544960539064`*^9, 
   3.8069544962892885`*^9}, {3.8069545335041466`*^9, 
   3.8069545444077225`*^9}, {3.806954634916724*^9, 3.8069546542035403`*^9}, {
   3.8069547298391967`*^9, 3.8069547355269423`*^9}, {3.806954804349592*^9, 
   3.8069548620002413`*^9}, {3.806954998317789*^9, 3.8069550011304336`*^9}, {
   3.806955147706686*^9, 3.8069551484370637`*^9}, {3.8069551878491263`*^9, 
   3.8069551891866302`*^9}, {3.8069552536084003`*^9, 
   3.8069552537936954`*^9}, {3.8069554002942953`*^9, 
   3.8069554011704473`*^9}, {3.806955466223734*^9, 3.8069554896523013`*^9}, {
   3.8069895453069744`*^9, 3.806989753071786*^9}, {3.8069898671329737`*^9, 
   3.80698992202532*^9}, {3.8069904851209173`*^9, 3.806990486148333*^9}, {
   3.8069906861750965`*^9, 3.8069906885083923`*^9}, 3.806990729004346*^9, {
   3.8069923005999055`*^9, 3.8069923486241455`*^9}, {3.806994836195117*^9, 
   3.8069948475749607`*^9}, 3.8069949213452544`*^9, {3.806995093406067*^9, 
   3.806995206940194*^9}, {3.806995337428149*^9, 3.8069953383085318`*^9}, {
   3.8069953715223527`*^9, 3.806995377715871*^9}, {3.8069987224473267`*^9, 
   3.806998722574724*^9}, {3.807007680405196*^9, 3.807007690882668*^9}, {
   3.807008233858856*^9, 3.807008278929255*^9}, {3.8070104313139763`*^9, 
   3.807010444164129*^9}, {3.8070138649773955`*^9, 3.8070138659133344`*^9}, {
   3.8070141921553574`*^9, 3.8070141923242035`*^9}, {3.807022185714244*^9, 
   3.8070221867210817`*^9}, {3.807022326295784*^9, 3.8070223264473233`*^9}, {
   3.807022940439416*^9, 3.8070229413506913`*^9}, 3.807023278643725*^9, {
   3.807023590228446*^9, 3.8070236198728485`*^9}, {3.8070292638769293`*^9, 
   3.8070292751099515`*^9}, {3.8070723638640623`*^9, 
   3.8070723690157804`*^9}, {3.8070724588705616`*^9, 
   3.8070725714097195`*^9}, {3.8070726061642356`*^9, 
   3.8070726157605658`*^9}, {3.8070727769599123`*^9, 
   3.8070727873684206`*^9}, {3.8070730296322145`*^9, 3.807073052952524*^9}, {
   3.807073084243802*^9, 3.8070731070485616`*^9}, {3.807073144824878*^9, 
   3.8070731950300827`*^9}, {3.8070734099679356`*^9, 
   3.8070734135758257`*^9}, {3.8070735099518895`*^9, 3.807073525875796*^9}, {
   3.808671117419715*^9, 3.808671211231267*^9}, 3.81435402558959*^9, {
   3.8143545334746046`*^9, 3.814354545569415*^9}, {3.814354636708435*^9, 
   3.814354637466385*^9}, {3.8143546751823072`*^9, 3.8143546754255133`*^9}, {
   3.81436343408307*^9, 3.814363435129794*^9}, {3.814364198554064*^9, 
   3.8143641987401237`*^9}, {3.815136332587311*^9, 3.815136338084837*^9}, {
   3.8151365727682886`*^9, 3.8151365741682887`*^9}, {3.815136685097686*^9, 
   3.815136686027685*^9}, {3.8151371084192915`*^9, 3.8151371468043923`*^9}, {
   3.8151973067229633`*^9, 3.815197330833071*^9}, 3.815197368739064*^9, {
   3.8151974121603355`*^9, 3.815197414135749*^9}, {3.815198476180976*^9, 
   3.8151985050828743`*^9}, {3.815198581862775*^9, 3.8151985934448104`*^9}, {
   3.815198637716685*^9, 3.8151986420100164`*^9}, {3.815200246972068*^9, 
   3.8152002470241127`*^9}, {3.815223917401018*^9, 3.8152239445890017`*^9}, {
   3.8152240177234087`*^9, 3.8152240679688125`*^9}, {3.8152241379507675`*^9, 
   3.8152241534084044`*^9}, {3.815292983287917*^9, 3.815293076263691*^9}, {
   3.8152931255604267`*^9, 3.815293142578374*^9}, {3.815293201444624*^9, 
   3.8152932044356785`*^9}, {3.815293268347834*^9, 3.8152932952522125`*^9}, {
   3.815366738678883*^9, 3.815366777201478*^9}, {3.8153668193561997`*^9, 
   3.8153669887157574`*^9}, {3.815367035205016*^9, 3.815367178140109*^9}, {
   3.8153672083754053`*^9, 3.815367308445512*^9}, {3.8153673964468737`*^9, 
   3.8153675014610777`*^9}, {3.8153677680753746`*^9, 
   3.8153677688536386`*^9}, {3.815367809374856*^9, 3.8153678773555746`*^9}, {
   3.8153679118307943`*^9, 3.815367913624197*^9}, {3.815392529411377*^9, 
   3.8153926168713417`*^9}, {3.815392647920529*^9, 3.815392649634514*^9}, {
   3.8153926868521223`*^9, 3.8153926991920195`*^9}, 3.8153927328897257`*^9, {
   3.8154550417378006`*^9, 3.815455129404172*^9}, {3.815455189194459*^9, 
   3.815455197343644*^9}, 3.8154552663985925`*^9, {3.815763025527503*^9, 
   3.8157630578118467`*^9}, {3.8157631327855964`*^9, 
   3.8157632074173865`*^9}, {3.8157632548093166`*^9, 
   3.8157634530954895`*^9}, {3.8157634932160363`*^9, 3.815763494745075*^9}, {
   3.8157635364166307`*^9, 3.8157636620107822`*^9}, {3.818780957417221*^9, 
   3.81878103052871*^9}, {3.8187810701018324`*^9, 3.8187810825783873`*^9}, {
   3.818781129443754*^9, 3.818781145669818*^9}, 3.8187818306388254`*^9, {
   3.862053531337834*^9, 3.8620535949976406`*^9}, 3.862136647356856*^9, {
   3.862227750034676*^9, 3.8622277591286907`*^9}, {3.8622278835301933`*^9, 
   3.862227906243687*^9}, {3.86352855634202*^9, 3.8635285609380255`*^9}, {
   3.8635286007943583`*^9, 3.863528683837926*^9}, {3.863528723138908*^9, 
   3.863528738976894*^9}, {3.863528770410867*^9, 3.8635288073668456`*^9}, {
   3.8635288561642017`*^9, 3.8635288574828763`*^9}, {3.8635289317841735`*^9, 
   3.863528938923376*^9}, {3.863529113399362*^9, 3.863529115179017*^9}, {
   3.86352922076486*^9, 3.863529260482592*^9}, {3.864036405775961*^9, 
   3.8640365060294466`*^9}, {3.864038226637512*^9, 3.8640382374628024`*^9}, {
   3.8640402570487986`*^9, 3.864040323770791*^9}, {3.864047787191838*^9, 
   3.8640478680238705`*^9}, {3.864047905553862*^9, 3.864047913154857*^9}, {
   3.8640481942287555`*^9, 3.864048225683401*^9}, {3.864048382565826*^9, 
   3.8640483976641726`*^9}, {3.864048449750173*^9, 3.8640484644391737`*^9}, {
   3.8640485887579527`*^9, 3.8640485896021824`*^9}, {3.8640492175056543`*^9, 
   3.8640492353148394`*^9}, {3.8640501260306635`*^9, 3.864050133600607*^9}, {
   3.8640503526489477`*^9, 3.864050382961414*^9}, {3.864050442647747*^9, 
   3.864050562993884*^9}, {3.8640506837859063`*^9, 3.8640506973768263`*^9}, {
   3.8640507988274174`*^9, 3.8640508765652647`*^9}, {3.864050937553434*^9, 
   3.864050947089572*^9}, {3.8640512534555826`*^9, 3.8640512546085815`*^9}, {
   3.8641049345734215`*^9, 3.8641049578455505`*^9}, {3.8641953460343523`*^9, 
   3.8641953603533735`*^9}, {3.864195420804484*^9, 3.8641954328002186`*^9}, {
   3.864195480463772*^9, 3.864195481041773*^9}, {3.8641970009395046`*^9, 
   3.864197021812604*^9}, {3.864200862331644*^9, 3.8642008625136476`*^9}, {
   3.8642899150687833`*^9, 3.8642899159537835`*^9}, {3.864314232617366*^9, 
   3.8643143072643557`*^9}, {3.864314361805803*^9, 3.864314434063414*^9}, {
   3.864314468102418*^9, 3.864314548148559*^9}, {3.8643145822147617`*^9, 
   3.864314706453809*^9}, {3.8645417470882215`*^9, 3.864541756023384*^9}, {
   3.864543015055519*^9, 3.8645430218766904`*^9}, {3.8645433396351633`*^9, 
   3.8645433527711763`*^9}, 3.8672558548547077`*^9, {3.878785722167796*^9, 
   3.87878574612731*^9}, {3.878785793196313*^9, 3.878785867496909*^9}, {
   3.87878593647849*^9, 3.8787859888325186`*^9}, {3.879061052532881*^9, 
   3.87906105404453*^9}, {3.8790611174779778`*^9, 3.8790611176627045`*^9}, {
   3.8790617246958513`*^9, 3.8790617308692446`*^9}, {3.879062843780946*^9, 
   3.879062856779683*^9}, {3.879063442579528*^9, 3.8790636120920343`*^9}, {
   3.8790639326136265`*^9, 3.879064005555957*^9}, {3.879064146892203*^9, 
   3.87906416558432*^9}, {3.8790642369285545`*^9, 3.8790643041666718`*^9}, {
   3.8790643565055366`*^9, 3.879064480356732*^9}, {3.8790645922460136`*^9, 
   3.8790645950809193`*^9}, {3.8790646744128866`*^9, 3.8790647004753523`*^9}, 
   3.8790647517557173`*^9, {3.8790648664833426`*^9, 3.879064884812052*^9}, {
   3.879065997529707*^9, 3.8790660206833363`*^9}, {3.87906629578948*^9, 
   3.879066339032545*^9}},
 CellLabel->"In[317]:=",
 CellID->663758714,ExpressionUUID->"41e3f9ec-9157-48ad-9d55-ac75f303a04b"],

Cell[BoxData[""], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.89029901205744*^9, 3.8902990159350348`*^9}},
 CellLabel->
  "In[324]:=",ExpressionUUID->"b16a6ba5-e22e-4f7b-bbda-9082e56ddfc6"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Analysis", "Section",
 CellChangeTimes->{{3.8769109369712*^9, 3.87691097365557*^9}, {
  3.902896491241413*^9, 
  3.9028964926212997`*^9}},ExpressionUUID->"e1eb2d18-e001-4872-85bc-\
3c0f09883927"],

Cell[CellGroupData[{

Cell["time average", "Subsection",
 CellChangeTimes->{{3.882504495106471*^9, 3.882504514188869*^9}, {
  3.884756250449435*^9, 3.884756250785568*^9}, {3.884756285953271*^9, 
  3.884756289697698*^9}, {3.8847572901574078`*^9, 3.8847573222373857`*^9}, {
  3.88478257039648*^9, 3.884782572476583*^9}, {3.8908344263159237`*^9, 
  3.8908344280753403`*^9}, {3.9003511710209827`*^9, 3.900351178361463*^9}, {
  3.902896496494033*^9, 
  3.902896497070024*^9}},ExpressionUUID->"6bb7b5ee-cbd7-4952-9ffc-\
6b93d000d321"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"rrNTF2", " ", "=", " ", 
    RowBox[{"Range", "[", 
     RowBox[{"10", ",", "18"}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "this", " ", "is", " ", "to", " ", "select", " ", "the", " ", "files", 
     " ", "corresponding", " ", "to", " ", "NTF2"}], ",", " ", 
    RowBox[{"Kap", " ", "or", " ", 
     RowBox[{"both", ".", " ", "\[IndentingNewLine]", "Please"}], " ", "make",
      " ", "sure", " ", "they", " ", "are", " ", "in", " ", "the", " ", 
     "right", " ", 
     RowBox[{"order", "!"}]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rrKap", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "9"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rrAll", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "18"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rr", " ", "=", "rrAll"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"launch", " ", "=", " ", 
    RowBox[{"StringDelete", "[", 
     RowBox[{
      RowBox[{"DateString", "[", 
       RowBox[{"DateObject", "[", "]"}], "]"}], ",", " ", "\"\<:\>\""}], 
     "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "this", " ", "is", " ", "needed", " ", "to", " ", "create", " ", "a", " ", 
    "directory", " ", "to", " ", "save", " ", "the", " ", "data"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ppKap", "=", " ", 
    RowBox[{"Table", "[", " ", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{"1.176", " ", 
        SuperscriptBox["10", "j"]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", " ", "1", ",", "4", ",", " ", "0.1"}], "}"}]}], 
     "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "this", " ", "allows", " ", "you", " ", "to", " ", "eventually", " ", 
    "insert", " ", "multiple", " ", "time", " ", "sampling", " ", "points", 
    " ", "at", " ", "once"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ppNTF2", "=", " ", 
   RowBox[{"Table", "[", " ", 
    RowBox[{
     RowBox[{"Round", "[", 
      RowBox[{"2.929", " ", 
       SuperscriptBox["10", "j"]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", " ", "1", ",", "4", ",", " ", "0.1"}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.890832929195304*^9, 3.890832929821538*^9}, {
   3.890837754210094*^9, 3.8908377566853952`*^9}, {3.8909209566648808`*^9, 
   3.8909209794486237`*^9}, {3.890921392910418*^9, 3.89092151407727*^9}, {
   3.891057445462722*^9, 3.891057447045163*^9}, {3.891058706586883*^9, 
   3.89105870729757*^9}, {3.891059848635038*^9, 3.891059853708725*^9}, {
   3.8910603676258717`*^9, 3.891060370448339*^9}, 3.8910606444239187`*^9, 
   3.8910607957484713`*^9, {3.902896553586261*^9, 
   3.9028966294135733`*^9}},ExpressionUUID->"332cec7b-3e82-479b-bb04-\
0515d7b2c8a6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ppt", "[", "l", "]"}], " ", "=", " ", 
      RowBox[{"ppKap", "[", 
       RowBox[{"[", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], "]"}], "]"}]}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"l", ",", " ", "rrKap"}], "}"}]}], "]"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "we", " ", "only", " ", "select", " ", "one", " ", "time", " ", "sampling",
     " ", "point", " ", "sat", " ", "1", " ", "ms"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ppt", "[", "l", "]"}], " ", "=", " ", 
     RowBox[{"ppNTF2", "[", 
      RowBox[{"[", 
       RowBox[{"{", 
        RowBox[{"-", "1"}], "}"}], "]"}], "]"}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"l", ",", " ", "rrNTF2"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.891060464008762*^9, 3.8910604807664433`*^9}, {
  3.89106060398457*^9, 3.891060628038394*^9}, {3.891060713719599*^9, 
  3.8910607147482977`*^9}, {3.902896510258566*^9, 
  3.9028965707487783`*^9}},ExpressionUUID->"811d8229-5be8-46b5-a7cd-\
f26120f6acc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "filenumA", ",", " ", "particles", ",", " ", "time", ",", 
        "xyztContacts", ",", "  ", "ree", ",", " ", "mee2", ",", " ", "mee", 
        ",", " ", "meeBP", ",", " ", "tre1", ",", "tre2", ",", " ", "tre3", 
        ",", " ", "deltasA", ",", " ", "meeB", ",", " ", "msdA", ",", " ", 
        "msdStdA", ",", " ", "outTA", ",", " ", "diffA", ",", " ", 
        "timeStepA", ",", " ", "msdQ75A", ",", "msdQ25A", ",", " ", "pp"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"filenumA", "=", " ", "l"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Current file: \>\"", "<>", 
         RowBox[{"fileNames", "[", 
          RowBox[{"[", "filenumA", "]"}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"particles", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"100", " ", "+", " ", "i"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"Length", "[", " ", 
              RowBox[{"Import", "[", 
               RowBox[{"fileNames", "[", 
                RowBox[{"[", "filenumA", "]"}], "]"}], "]"}], "]"}], "/", 
             "6"}]}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"number", " ", "of", " ", "particles"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"pp", " ", "=", " ", 
        RowBox[{"ppt", "[", "l", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"time", " ", "=", " ", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"fileNames", "[", 
           RowBox[{"[", "filenumA", "]"}], "]"}], ",", "\"\<101/time\>\""}], 
         "]"}]}], ";", " ", 
       RowBox[{"(*", "time", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"frames", "[", "l", "]"}], " ", "=", " ", 
        RowBox[{"Length", "@", "time"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"number", " ", "of", " ", "frames"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"timeStepA", " ", "=", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"time", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"time", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ")"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"timestep", " ", "in", " ", "ms"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"timeStep", "[", "l", "]"}], " ", "=", " ", "timeStepA"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"tre1", " ", "=", " ", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"to", " ", "time", " ", "the", " ", "import"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"xyztContacts", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"fileNames", "[", 
                RowBox[{"[", "filenumA", "]"}], "]"}], ",", " ", 
               RowBox[{
                RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\</x\>\""}]}], 
              "]"}], ",", " ", 
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"fileNames", "[", 
                RowBox[{"[", "filenumA", "]"}], "]"}], ",", " ", 
               RowBox[{
                RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\</y\>\""}]}], 
              "]"}], ",", 
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"fileNames", "[", 
                RowBox[{"[", "filenumA", "]"}], "]"}], ",", " ", 
               RowBox[{
                RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\</z\>\""}]}], 
              "]"}], ",", 
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"fileNames", "[", 
                RowBox[{"[", "filenumA", "]"}], "]"}], ",", " ", 
               RowBox[{
                RowBox[{"ToString", "[", "i", "]"}], "<>", 
                "\"\</time\>\""}]}], "]"}], ",", " ", 
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"fileNames", "[", 
                RowBox[{"[", "filenumA", "]"}], "]"}], ",", " ", 
               RowBox[{
                RowBox[{"ToString", "[", "i", "]"}], "<>", 
                "\"\</ncontacts\>\""}]}], "]"}]}], "}"}], "\[Transpose]"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "particles"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"we", " ", "import", " ", 
         RowBox[{"{", 
          RowBox[{"x", " ", "y", " ", "z", " ", "t", " ", "contacts"}], "}"}],
          " ", "data", " ", "in", " ", "per", " ", "frame", " ", "per", " ", 
         "particle", " ", "into", " ", "a", " ", 
         RowBox[{"List", ".", " ", "this"}], " ", "could", " ", "be", " ", 
         "optimised"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Import (xyztContacts) time = \>\"", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"AbsoluteTime", "[", "]"}], " ", "-", " ", "tre1"}], "]"}],
          "<>", "\"\<s\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tre2", " ", "=", " ", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "to", " ", "time", " ", "the", " ", "calculation", " ", "below"}], 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", "\n", 
       RowBox[{"meeB", " ", "=", " ", "xyztContacts"}], ";", 
       "\[IndentingNewLine]", 
       StyleBox["\[IndentingNewLine]",
        FontSize->12], 
       StyleBox[
        RowBox[{"deltasA", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            SuperscriptBox[
             RowBox[{"Differences", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"meeB", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "1"}], "]"}], "]"}], ",", "1", ",", " ", 
               RowBox[{"pp", "[", 
                RowBox[{"[", "p", "]"}], "]"}]}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"Differences", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"meeB", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "2"}], "]"}], "]"}], ",", "1", ",", " ", 
               RowBox[{"pp", "[", 
                RowBox[{"[", "p", "]"}], "]"}]}], "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"Differences", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"meeB", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "3"}], "]"}], "]"}], ",", "1", ",", " ", 
               RowBox[{"pp", "[", 
                RowBox[{"[", "p", "]"}], "]"}]}], "]"}], "2"]}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "@", "meeB"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", " ", 
             RowBox[{"Length", "@", "pp"}]}], "}"}]}], "]"}]}],
        FontSize->14], 
       StyleBox[";",
        FontSize->14], 
       RowBox[{
        StyleBox[
         StyleBox[
          RowBox[{"(", "*"}]],
         FontSize->14], 
        RowBox[{
         RowBox[{
          RowBox[{
           StyleBox["we",
            FontSize->14], 
           StyleBox[" ",
            FontSize->14], 
           StyleBox["calculate",
            FontSize->14], 
           StyleBox[" ",
            FontSize->14], 
           SuperscriptBox[
            StyleBox["\[CapitalDelta]x",
             FontSize->14], "2"]}], "+", 
          StyleBox[" ",
           FontSize->14], 
          SuperscriptBox["\[CapitalDelta]y", "2"], 
          StyleBox[" ",
           FontSize->14], 
          StyleBox["+",
           FontSize->14], 
          StyleBox[" ",
           FontSize->14], 
          RowBox[{
           SuperscriptBox["\[CapitalDelta]z", "2"], " ", "at", " ", "a", " ", 
           "fixed", " ", "time", " ", "distance", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"e", ".", "g", ".", " ", "1"}], " ", "ms"}], ")"}], ".",
             " ", "Per"}], " ", "each", " ", "frame", " ", "couple"}]}], ",", 
         " ", 
         RowBox[{"per", " ", "each", " ", "particle"}]}], 
        StyleBox[
         StyleBox[
          RowBox[{"*", ")"}]],
         FontSize->14]}], 
       StyleBox["\n",
        FontSize->14], 
       StyleBox[
        RowBox[{"msdA", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Quantile", "[", 
            RowBox[{
             RowBox[{"deltasA", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "p"}], "]"}], "]"}], ",", " ", "0.50"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "@", "meeB"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", " ", 
             RowBox[{"Length", "@", "pp"}]}], "}"}]}], "]"}]}],
        FontSize->14], 
       StyleBox[";",
        FontSize->14], 
       StyleBox[" ",
        FontSize->14], 
       StyleBox[
        RowBox[{
         StyleBox[
          RowBox[{"(", "*"}]], 
         RowBox[{
         "we", " ", "extract", " ", "the", " ", "median", " ", "value", " ", 
          "per", " ", "each", " ", "particle"}], 
         StyleBox[
          RowBox[{"*", ")"}]]}],
        FontSize->14], 
       StyleBox["\[IndentingNewLine]",
        FontSize->14], 
       StyleBox[
        RowBox[{"msdQ25A", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Quantile", "[", 
            RowBox[{
             RowBox[{"deltasA", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "p"}], "]"}], "]"}], ",", " ", "0.25"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "@", "meeB"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", " ", 
             RowBox[{"Length", "@", "pp"}]}], "}"}]}], "]"}]}],
        FontSize->14], 
       StyleBox[";",
        FontSize->14], 
       StyleBox[
        RowBox[{
         StyleBox[
          RowBox[{"(", "*"}]], 
         RowBox[{
         "we", " ", "extract", " ", "the", " ", "0.25", " ", "quantile", " ", 
          "value", " ", "per", " ", "each", " ", "particle"}], 
         StyleBox[
          RowBox[{"*", ")"}]]}],
        FontSize->14], 
       StyleBox["\[IndentingNewLine]",
        FontSize->14], 
       StyleBox[
        RowBox[{"msdQ75A", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Quantile", "[", 
            RowBox[{
             RowBox[{"deltasA", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "p"}], "]"}], "]"}], ",", " ", "0.75"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "@", "meeB"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", " ", 
             RowBox[{"Length", "@", "pp"}]}], "}"}]}], "]"}]}],
        FontSize->14], 
       StyleBox[";",
        FontSize->14], 
       StyleBox[
        RowBox[{
         StyleBox[
          RowBox[{"(", "*"}]], 
         RowBox[{
         "we", " ", "extract", " ", "the", " ", "0.75", " ", "quantile", " ", 
          "value", " ", "per", " ", "each", " ", "particle"}], 
         StyleBox[
          RowBox[{"*", ")"}]]}],
        FontSize->14], 
       StyleBox["\n",
        FontSize->14], 
       StyleBox[
        RowBox[{"diffA", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"msdA", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "p"}], "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"6", " ", 
              RowBox[{"pp", "[", 
               RowBox[{"[", "p", "]"}], "]"}], "*", "timeStepA", " ", "*", 
              "1000"}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "@", "meeB"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", 
             RowBox[{"Length", "@", "pp"}]}], "}"}]}], "]"}]}],
        FontSize->14], 
       StyleBox[";",
        FontSize->14], 
       StyleBox[" ",
        FontSize->14], 
       StyleBox[
        RowBox[{
         StyleBox[
          RowBox[{"(", "*"}]], 
         RowBox[{
         "D", " ", "of", " ", "each", " ", "particle", " ", "is", " ", 
          "calculated", " ", "as", " ", 
          RowBox[{
           FractionBox[
            RowBox[{
             StyleBox["<",
              FontSize->14], 
             RowBox[{
              SuperscriptBox[
               StyleBox["\[CapitalDelta]x",
                FontSize->14], "2"], "+", " ", 
              SuperscriptBox["\[CapitalDelta]y", "2"], " ", "+", " ", 
              SuperscriptBox["\[CapitalDelta]z", "2"]}], ">"}], 
            RowBox[{"6", " ", "t"}]], " ", ".", " ", 
           RowBox[{"<>", " ", "denotes"}]}], " ", "the", " ", "median"}], 
         StyleBox[
          RowBox[{"*", ")"}]]}],
        FontSize->14], "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"outTA", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "5"}], "]"}], "]"}], ",", " ", "0"}], "]"}],
            "&"}], "/@", "meeB"}]}],
        FontSize->14], 
       StyleBox[";",
        FontSize->14], 
       StyleBox[" ",
        FontSize->14], 
       StyleBox[
        RowBox[{
         StyleBox[
          RowBox[{"(", "*"}]], 
         RowBox[{
         "counts", " ", "the", " ", "0", " ", "contacts", " ", "frame"}], 
         StyleBox[
          RowBox[{"*", ")"}]]}],
        FontSize->14], "\n", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<differences (asdP) calculation time = \>\"", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"AbsoluteTime", "[", "]"}], " ", "-", " ", "tre2"}], "]"}],
          "<>", "\"\<s\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"msd", "[", "l", "]"}], " ", "=", " ", "msdA"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"diff", "[", "l", "]"}], "=", "diffA"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"outT", "[", "l", "]"}], " ", "=", "outTA"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"deltas", "[", "l", "]"}], " ", "=", " ", "deltasA"}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"msdQ25", "[", "l", "]"}], " ", "=", " ", "msdQ25A"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"msdQ75", "[", "l", "]"}], " ", "=", " ", "msdQ75A"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"exports", " ", "the", " ", "calculation"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</export/\>\"", "<>",
           "launch", "<>", "\"\</\>\"", "<>", " ", 
          RowBox[{"StringDelete", "[", 
           RowBox[{
            RowBox[{"fileNames", "[", 
             RowBox[{"[", "filenumA", "]"}], "]"}], ",", " ", "\"\<.h5\>\""}],
            "]"}], "<>", "\"\<_outTime.mx\>\""}], ",", " ", "outTA", ",", " ", 
         RowBox[{"OverwriteTarget", "->", "True"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</export/\>\"", "<>",
           "launch", "<>", "\"\</\>\"", "<>", " ", 
          RowBox[{"StringDelete", "[", 
           RowBox[{
            RowBox[{"fileNames", "[", 
             RowBox[{"[", "filenumA", "]"}], "]"}], ",", " ", "\"\<.h5\>\""}],
            "]"}], "<>", "\"\<_deltas.mx\>\""}], ",", " ", "deltasA", ",", 
         " ", 
         RowBox[{"OverwriteTarget", "->", "True"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"l", ",", "rrAll"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.866610966257272*^9, 3.8666109824806967`*^9}, 
   3.86661111300806*^9, {3.876390202199662*^9, 3.876390203459754*^9}, {
   3.877436080395021*^9, 3.877436080731986*^9}, {3.87743789941658*^9, 
   3.877437942720709*^9}, {3.8775245224326687`*^9, 3.8775245476586237`*^9}, {
   3.877526317686084*^9, 3.877526365545067*^9}, {3.877526868773394*^9, 
   3.877526887895637*^9}, {3.878635223288615*^9, 3.8786353058389587`*^9}, {
   3.878636581684978*^9, 3.878636601892467*^9}, 3.878636655445355*^9, 
   3.8786371882616863`*^9, 3.8786372441981773`*^9, {3.8786373057249813`*^9, 
   3.878637310484639*^9}, 3.878637455746963*^9, 3.878637498984686*^9, 
   3.8786413817565327`*^9, 3.879390765030747*^9, 3.879390838317243*^9, {
   3.879391132825135*^9, 3.879391134713869*^9}, 3.879391240123163*^9, {
   3.882529373496645*^9, 3.882529382760848*^9}, {3.882529997819746*^9, 
   3.882530002366172*^9}, {3.882530266010931*^9, 3.882530378494485*^9}, 
   3.882530582722891*^9, {3.882531692089402*^9, 3.882531702477083*^9}, {
   3.882533186989501*^9, 3.882533197174889*^9}, {3.8825338084687843`*^9, 
   3.8825338089052687`*^9}, {3.882534056177066*^9, 3.882534061694233*^9}, {
   3.883197215412325*^9, 3.8831972155894213`*^9}, {3.8831974273283653`*^9, 
   3.883197428047501*^9}, {3.883197581306608*^9, 3.883197587283473*^9}, {
   3.8831980349509773`*^9, 3.8831980370602427`*^9}, 3.883198509728307*^9, {
   3.883203837642303*^9, 3.883203854779293*^9}, {3.883203988423925*^9, 
   3.88320401106494*^9}, {3.883204057753414*^9, 3.883204165962825*^9}, {
   3.883204222696143*^9, 3.883204225893713*^9}, {3.883204744234144*^9, 
   3.883204744691819*^9}, {3.883209524583311*^9, 3.883209525686301*^9}, 
   3.88321053812698*^9, 3.883217707180971*^9, 3.883217789122772*^9, 
   3.883221128455001*^9, {3.883660211580608*^9, 3.883660359262311*^9}, {
   3.883660401867886*^9, 3.883660499482442*^9}, {3.884756883103116*^9, 
   3.884756890608382*^9}, {3.884757177935998*^9, 3.884757194124392*^9}, {
   3.884757859768035*^9, 3.884757860008974*^9}, {3.884782585131858*^9, 
   3.8847825866036*^9}, {3.8847826330205793`*^9, 3.884782646800778*^9}, {
   3.884782719789315*^9, 3.884782731894288*^9}, {3.8847827622990503`*^9, 
   3.88478288557312*^9}, {3.884782920866287*^9, 3.8847830220708323`*^9}, {
   3.884783057109367*^9, 3.8847830590259047`*^9}, {3.884783191638824*^9, 
   3.88478324794249*^9}, {3.884783300790637*^9, 3.884783335150731*^9}, {
   3.8847833868640947`*^9, 3.8847834240851793`*^9}, {3.884783471893897*^9, 
   3.884783627830571*^9}, {3.884783915799713*^9, 3.884783916433638*^9}, {
   3.884783979784319*^9, 3.884783981264037*^9}, {3.884786907015893*^9, 
   3.884786908484799*^9}, {3.884787080495682*^9, 3.884787080648168*^9}, {
   3.88483628699684*^9, 3.884836307764062*^9}, {3.884838014419401*^9, 
   3.8848380156939497`*^9}, 3.890810543636133*^9, {3.8908304833742447`*^9, 
   3.89083049426441*^9}, {3.890830746634636*^9, 3.890830844495037*^9}, 
   3.8908312638614492`*^9, {3.890831424283235*^9, 3.890831502455101*^9}, {
   3.890831764642046*^9, 3.890831790721287*^9}, {3.890831840672234*^9, 
   3.89083188501047*^9}, 3.890831915530814*^9, {3.890832241290275*^9, 
   3.890832243793985*^9}, {3.8908322825710173`*^9, 3.8908322828861027`*^9}, {
   3.890832363244808*^9, 3.890832375197607*^9}, {3.890832447192379*^9, 
   3.89083249941779*^9}, {3.890832955578371*^9, 3.890832960625656*^9}, {
   3.890833007000444*^9, 3.8908332154925203`*^9}, {3.8908378185295973`*^9, 
   3.890837824291999*^9}, {3.8908379720186768`*^9, 3.890837974011814*^9}, {
   3.8908385173300743`*^9, 3.8908385198388453`*^9}, {3.890838627894635*^9, 
   3.890838640449914*^9}, {3.8908387230211153`*^9, 3.890838739446024*^9}, {
   3.890838775547237*^9, 3.890838799513877*^9}, {3.890881344151882*^9, 
   3.890881366207121*^9}, {3.890881634091021*^9, 3.890881930584963*^9}, {
   3.89088199389424*^9, 3.890881998149455*^9}, {3.890882428657893*^9, 
   3.890882431866247*^9}, {3.890911151658023*^9, 3.8909111974948997`*^9}, {
   3.890912523808963*^9, 3.890912561798942*^9}, {3.890919430636655*^9, 
   3.89091943402418*^9}, {3.891055693181518*^9, 3.8910556963311577`*^9}, {
   3.89105573188214*^9, 3.891055765013133*^9}, {3.891056735954055*^9, 
   3.8910567506374483`*^9}, {3.8910571094191008`*^9, 3.891057117097645*^9}, {
   3.89105745409128*^9, 3.891057456039682*^9}, {3.891058711897936*^9, 
   3.8910587139334717`*^9}, {3.8910593518627043`*^9, 3.891059353072529*^9}, {
   3.891059861871582*^9, 3.891059862625882*^9}, {3.891060725729444*^9, 
   3.891060748071876*^9}, {3.891061024736507*^9, 3.8910610255459557`*^9}, {
   3.9028966413040333`*^9, 3.902896664773959*^9}, {3.902896695651964*^9, 
   3.902896723438649*^9}, {3.902912891437896*^9, 3.902913042685153*^9}, {
   3.9029134289151382`*^9, 3.902913446798519*^9}, {3.902913526364573*^9, 
   3.902913531227416*^9}, {3.90291356861158*^9, 3.902913704344038*^9}, {
   3.9029138128728447`*^9, 3.902913813159066*^9}, {3.902914099684054*^9, 
   3.9029141998612537`*^9}, {3.9029142824052763`*^9, 
   3.9029142827861834`*^9}, {3.902914482193343*^9, 
   3.902914534273213*^9}},ExpressionUUID->"6bc01139-d2b7-4988-9b49-\
efa2151e287a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "we", " ", "use", " ", "the", " ", "25", " ", "and", " ", "75", " ", 
    "quantiles", " ", "to", " ", "calculate", " ", "the", " ", "error", " ", 
    "and", " ", "put", " ", "it", " ", "Around", " ", "the", " ", "media", 
    " ", "value"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"diffErr25", "[", "l", "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"msdQ25", "[", "l", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "p"}], "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"6", " ", 
              RowBox[{
               RowBox[{"ppt", "[", "l", "]"}], "[", 
               RowBox[{"[", "p", "]"}], "]"}], "*", 
              RowBox[{"timeStep", "[", "l", "]"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "@", 
              RowBox[{"msd", "[", "l", "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"ppt", "[", "l", "]"}]}]}], "}"}]}], "]"}], "/", 
         "1000"}]}], ";"}], " ", ",", " ", 
      RowBox[{"{", 
       RowBox[{"l", ",", "rrAll"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"diffErr75", "[", "l", "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"msdQ75", "[", "l", "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "p"}], "]"}], "]"}], "/", 
            RowBox[{"(", 
             RowBox[{"6", " ", 
              RowBox[{
               RowBox[{"ppt", "[", "l", "]"}], "[", 
               RowBox[{"[", "p", "]"}], "]"}], "*", 
              RowBox[{"timeStep", "[", "l", "]"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "@", 
              RowBox[{"msd", "[", "l", "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"p", ",", 
             RowBox[{"Length", "@", 
              RowBox[{"ppt", "[", "l", "]"}]}]}], "}"}]}], "]"}], "/", 
         "1000"}]}], ";"}], " ", ",", " ", 
      RowBox[{"{", 
       RowBox[{"l", ",", "rrAll"}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"diffBar", "[", "l", "]"}], "=", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Around", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"diff", "[", "l", "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}], "[", 
            RowBox[{"[", "k", "]"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"diff", "[", "l", "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}], "-", 
              RowBox[{
               RowBox[{
                RowBox[{"diffErr25", "[", "l", "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], ",", " ", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"diffErr75", "[", "l", "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}], " ", "-", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"diff", "[", "l", "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "[", 
               RowBox[{"[", "k", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"j", ",", " ", 
           RowBox[{"Length", "@", 
            RowBox[{"diff", "[", "l", "]"}]}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"k", ",", " ", 
           RowBox[{"Length", "@", 
            RowBox[{
             RowBox[{"diff", "[", "l", "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"l", ",", " ", "rrAll"}], "}"}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.890889044117515*^9, 3.890889054330105*^9}, {
  3.890911835571954*^9, 3.890911837391733*^9}, {3.890921717159218*^9, 
  3.890921732836568*^9}, {3.891057373314083*^9, 3.8910573765879793`*^9}, {
  3.891059323475354*^9, 3.891059339100067*^9}, {3.891060762689993*^9, 
  3.89106076375242*^9}, {3.8910657214680443`*^9, 3.8910657410123377`*^9}, {
  3.902916568636771*^9, 
  3.9029166204930077`*^9}},ExpressionUUID->"3c2d6783-1e98-4d59-9906-\
c7c1d4160611"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"line", " ", "=", " ", 
      RowBox[{"Line", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.01"}], ",", " ", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.7", ",", "1"}], "}"}]}], "}"}], "]"}]}], ";"}], "*)"}], 
   " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "this", " ", "is", " ", "to", " ", "draw", " ", "a", " ", "line", " ", 
      "at", " ", "D"}], " ", "=", " ", "1"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "in", " ", "this", " ", "plots", " ", "the", " ", "first", " ", "is", 
      " ", "the", " ", "full", " ", "saturation"}], ",", " ", 
     RowBox[{"the", " ", "second", " ", "half", " ", 
      RowBox[{"saturation", ".", " ", "normalised"}], " ", "by", " ", "D", 
      " ", "of", " ", "single", " ", "molecule"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"plotD", "[", "f", "]"}], " ", "=", " ", 
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"outT", "[", "f", "]"}], "/", 
             RowBox[{"frames", "[", "f", "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"diffBar", "[", "f", "]"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}], "/", 
             RowBox[{
              RowBox[{"diff", "[", 
               RowBox[{"f", "-", "2"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], "}"}], 
          "\[Transpose]"}], ",", 
         RowBox[{"PlotRange", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.01"}], ",", " ", "0.7"}], "}"}], ",", " ", 
            RowBox[{"{", " ", 
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"-", "2"}]], ",", " ", "300"}], "}"}]}], "}"}]}], ",", 
         
         RowBox[{"Frame", "->", "True"}], ",", " ", 
         RowBox[{"PlotStyle", "->", "Blue"}], ",", " ", 
         RowBox[{"PlotMarkers", "\[Rule]", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<\[EmptyCircle]\>\"", ",", 
            RowBox[{"FontFamily", "->", "\"\<Helvetica\>\""}], ",", "12"}], 
           "]"}]}], ",", " ", 
         RowBox[{"AspectRatio", "->", "1"}], ",", " ", 
         RowBox[{"ImageSize", "->", "300"}], ",", " ", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
            "Black"}], "}"}]}], ",", " ", 
         RowBox[{"FrameLabel", "->", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Relative contact time\>\"", ",", " ", 
            "\"\<D (normalised)\>\""}], "}"}]}], ",", " ", 
         RowBox[{"IntervalMarkers", "->", "\"\<Fences\>\""}], ",", " ", 
         RowBox[{"IntervalMarkersStyle", "->", "Thin"}], ","}], " ", 
        RowBox[{"(*", 
         RowBox[{",", " ", 
          RowBox[{"Epilog", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Directive", "[", 
              RowBox[{"{", 
               RowBox[{"Thick", ",", "Black", ",", " ", "Dashed"}], "}"}], 
              "]"}], ",", "line"}], "}"}]}]}], "*)"}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ListLogPlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"outT", "[", 
              RowBox[{"f", "-", "1"}], "]"}], "/", 
             RowBox[{"frames", "[", "f", "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"diffBar", "[", 
               RowBox[{"f", "-", "1"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", 
                RowBox[{"-", "1"}]}], "]"}], "]"}], "/", 
             RowBox[{
              RowBox[{"diff", "[", 
               RowBox[{"f", "-", "2"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", " ", 
                RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], "}"}], 
          "\[Transpose]"}], ",", 
         RowBox[{"Frame", "->", "True"}], ",", " ", 
         RowBox[{"PlotStyle", "->", "Red"}], ",", " ", 
         RowBox[{"PlotMarkers", "\[Rule]", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<\[EmptyCircle]\>\"", ",", 
            RowBox[{"FontFamily", "->", "\"\<Helvetica\>\""}], ",", "12"}], 
           "]"}]}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
            "Black"}], "}"}]}], ",", "  ", 
         RowBox[{"IntervalMarkers", "->", "\"\<Fences\>\""}], ",", " ", 
         RowBox[{"IntervalMarkersStyle", "->", "Thin"}]}], "]"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], ",", "  ", 
    RowBox[{"{", 
     RowBox[{"f", ",", " ", "3", ",", " ", "18", ",", " ", "3"}], "}"}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.902895094997473*^9, 3.902895109014909*^9}, {
  3.902896178580537*^9, 
  3.9028963059233522`*^9}},ExpressionUUID->"b0d27459-57d1-4299-9393-\
8fcc084fb570"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ff", " ", "=", " ", "18"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"this", " ", "is", " ", "with", " ", "the", " ", "legend"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plotD", "[", "18", "]"}], "=", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListLogPlot", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"outT", "[", "ff", "]"}], "/", 
           RowBox[{"frames", "[", "ff", "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"diffBar", "[", "ff", "]"}], "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], "/", 
           RowBox[{
            RowBox[{"diff", "[", 
             RowBox[{"ff", "-", "2"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", 
              RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], "}"}], "\[Transpose]"}],
        ",", 
       RowBox[{"PlotRange", "->", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.01"}], ",", " ", "0.7"}], "}"}], ",", " ", 
          RowBox[{"{", " ", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "2"}]], ",", " ", "300"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"Frame", "->", "True"}], ",", " ", 
       RowBox[{"PlotStyle", "->", "Blue"}], ",", " ", 
       RowBox[{"PlotMarkers", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\[EmptyCircle]\>\"", ",", 
          RowBox[{"FontFamily", "->", "\"\<Helvetica\>\""}], ",", "12"}], 
         "]"}]}], ",", " ", 
       RowBox[{"AspectRatio", "->", "1"}], ",", " ", 
       RowBox[{"ImageSize", "->", "300"}], ",", " ", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
          "Black"}], "}"}]}], ",", " ", 
       RowBox[{"FrameLabel", "->", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Relative contact time\>\"", ",", "  ", 
          "\"\<D (normalised)\>\""}], "}"}]}], ",", " ", 
       RowBox[{"IntervalMarkers", "->", "\"\<Fences\>\""}], ",", " ", 
       RowBox[{"IntervalMarkersStyle", "->", "Thin"}], 
       RowBox[{"(*", 
        RowBox[{",", " ", 
         RowBox[{"Epilog", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "Black", ",", " ", "Dashed"}], "}"}], 
             "]"}], ",", "line"}], "}"}]}]}], "*)"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotLegends", "->", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"{", "\"\<Full saturation\>\"", "}"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0.66", ",", " ", "0.20"}], "}"}]}], "]"}]}]}], "]"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"ListLogPlot", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"outT", "[", 
            RowBox[{"ff", "-", "1"}], "]"}], "/", 
           RowBox[{"frames", "[", "ff", "]"}]}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"diffBar", "[", 
             RowBox[{"ff", "-", "1"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", 
              RowBox[{"-", "1"}]}], "]"}], "]"}], "/", 
           RowBox[{
            RowBox[{"diff", "[", 
             RowBox[{"ff", "-", "2"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", " ", 
              RowBox[{"-", "1"}]}], "]"}], "]"}]}]}], "}"}], "\[Transpose]"}],
        ",", 
       RowBox[{"Frame", "->", "True"}], ",", " ", 
       RowBox[{"PlotStyle", "->", "Red"}], ",", " ", 
       RowBox[{"PlotMarkers", "\[Rule]", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\[EmptyCircle]\>\"", ",", 
          RowBox[{"FontFamily", "->", "\"\<Helvetica\>\""}], ",", "12"}], 
         "]"}]}], ",", 
       RowBox[{"LabelStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
          "Black"}], "}"}]}], ",", "  ", 
       RowBox[{"IntervalMarkers", "->", "\"\<Fences\>\""}], ",", " ", 
       RowBox[{"IntervalMarkersStyle", "->", "Thin"}], ",", " ", 
       RowBox[{"PlotLegends", "->", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"{", "\"\<Half saturation\>\"", "}"}], ",", "  ", 
          RowBox[{"{", 
           RowBox[{"0.665", ",", " ", "0.10"}], "}"}]}], "]"}]}]}], "]"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.891074752244318*^9, 3.8910748313959312`*^9}, {
   3.891074889991173*^9, 3.8910748947579517`*^9}, {3.891074986774551*^9, 
   3.891075044908804*^9}, {3.891075950600618*^9, 3.8910759751169367`*^9}, {
   3.891076032058072*^9, 3.891076035605831*^9}, {3.8910762568484697`*^9, 
   3.891076258507532*^9}, {3.891076712973456*^9, 3.8910767350860453`*^9}, 
   3.900500314683299*^9, 3.9005004190272503`*^9, {3.9005004772578793`*^9, 
   3.900500479289672*^9}, 3.900500706782751*^9, {3.900500771576211*^9, 
   3.900500772565346*^9}, {3.900500920431685*^9, 3.9005009206025333`*^9}, {
   3.900501017423114*^9, 3.900501059437481*^9}, {3.900501158786973*^9, 
   3.900501160720796*^9}, 3.900501304334613*^9, {3.9005013703796797`*^9, 
   3.900501370580171*^9}, {3.902895068179679*^9, 
   3.902895081771899*^9}},ExpressionUUID->"73b203b1-df71-405a-bdb5-\
7a6986a45268"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "here", " ", "the", " ", "plots", " ", "are", " ", "assembled", " ", 
    "using", " ", 
    RowBox[{"PlotGrid", ".", " ", "Remeber"}], " ", "to", " ", "run", " ", 
    "\"\<Definition\>\"", " ", "cell"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"plotTab", " ", "=", " ", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"plotD", "[", "f", "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"f", ",", " ", "3", ",", " ", "18", ",", " ", "3"}], 
          "}"}]}], "]"}], ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"plotGrid", " ", "=", 
    RowBox[{"PlotGrid", "[", 
     RowBox[{"plotTab", ",", " ", 
      RowBox[{"ImageSize", "->", "800"}], ",", " ", 
      RowBox[{"Spacings", "->", "5"}], ",", " ", 
      RowBox[{"\"\<ShowFrameLabels\>\"", "->", "Automatic"}], ",", " ", 
      RowBox[{"\"\<HideOuterTickLabels\>\"", "->", "All"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.891069910018394*^9, 3.891069919327566*^9}, {
   3.89106994968871*^9, 3.891069998947422*^9}, {3.891071298438405*^9, 
   3.891071306017828*^9}, {3.891071427106717*^9, 3.8910714383846493`*^9}, 
   3.891075623651984*^9, {3.891075928676488*^9, 3.8910759310579*^9}, {
   3.891076197770218*^9, 3.891076198524746*^9}, {3.8910767789466677`*^9, 
   3.891076785040572*^9}, {3.891076818128146*^9, 3.891076823888439*^9}, 
   3.891076855644649*^9, {3.891076908043*^9, 3.8910769083009987`*^9}, {
   3.9028963201522417`*^9, 
   3.902896353711029*^9}},ExpressionUUID->"7e4cf6ba-2f3e-4ab0-a462-\
11ed754e4cec"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</export/\>\"", "<>", 
    "launch", "<>", "\"\</\>\"", "<>", " ", 
    "\"\<_DiffVsContactTime.png\>\""}], ",", " ", "plotGrid", ",", " ", 
   RowBox[{"ImageResolution", "->", "500"}], ",", 
   RowBox[{"OverwriteTarget", "\[Rule]", "\"\<KeepBoth\>\""}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.89107612446656*^9, 3.8910761552013407`*^9}},
 CellLabel->
  "In[625]:=",ExpressionUUID->"1eed9959-a836-41d8-80fd-eb541fe7cb62"],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</export/\>\"", "<>",
       "launch", "<>", "\"\</\>\"", "<>", " ", 
      RowBox[{"StringDelete", "[", 
       RowBox[{
        RowBox[{"fileNames", "[", 
         RowBox[{"[", "l", "]"}], "]"}], ",", " ", "\"\<.h5\>\""}], "]"}], 
      "<>", "\"\<_DvsTime.png\>\""}], ",", " ", 
     RowBox[{"plotD", "[", "l", "]"}], ",", " ", 
     RowBox[{"ImageResolution", "->", "500"}], ",", 
     RowBox[{"OverwriteTarget", "\[Rule]", "\"\<KeepBoth\>\""}]}], "]"}], ",",
    " ", 
   RowBox[{"{", 
    RowBox[{"l", ",", " ", 
     RowBox[{"{", "12", "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.890912814298687*^9, 3.8909129492011003`*^9}, {
  3.890913000157588*^9, 3.890913011338934*^9}, {3.8909222604354687`*^9, 
  3.89092226143417*^9}, {3.8910761114594316`*^9, 3.8910761117780867`*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"d8643d46-b3f3-45ff-b226-c5dc1d7ef2c6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ensemble average (short timing)", "Subsection",
 CellChangeTimes->{{3.882504495106471*^9, 3.882504514188869*^9}, {
  3.884756247953621*^9, 3.884756248273543*^9}, {3.884757285338461*^9, 
  3.884757297357643*^9}, {3.890283064993051*^9, 3.890283065401819*^9}, {
  3.891170967583152*^9, 3.891170976778562*^9}, {3.900351180584036*^9, 
  3.900351185660986*^9}},ExpressionUUID->"55b93bf3-4ef8-4782-bdf1-\
e8ebcc5f4f2a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", 
     RowBox[{
     "x1_", ",", "x2_", ",", " ", "y1_", ",", "y2_", ",", "z1_", ",", "z2_", 
      ",", " ", "tau1_", ",", " ", "tau2_"}], "]"}], " ", "=", " ", 
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"x1", "-", "x2"}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"y1", "-", "y2"}], ")"}], "2"], "+", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"z1", " ", "-", " ", "z2"}], ")"}], "2"]}], 
     RowBox[{"6", 
      RowBox[{"Abs", "[", 
       RowBox[{"tau2", "-", "tau1"}], "]"}]}]]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "formula", " ", "for", " ", "the", " ", "diffusion", " ", "coefficent"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"binLog", " ", "=", " ", 
    RowBox[{"Table", "[", 
     RowBox[{
      SuperscriptBox["10", "j"], ",", " ", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"-", "3"}], ",", "2.6", ",", "0.1"}], "}"}]}], "]"}]}], ";"}],
   " ", 
  RowBox[{"(*", 
   RowBox[{"bins", " ", "for", " ", "the", " ", "D", " ", 
    RowBox[{"histogram", ".", " ", "they"}], " ", "are", " ", "exponential"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"binZ", " ", "=", " ", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", " ", "70", ",", " ", "1"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"bins", " ", "for", " ", "the", " ", "Z", " ", 
    RowBox[{"histogram", ".", " ", "they"}], " ", "are", " ", "exponential"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"binC", " ", "=", " ", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", " ", "30", ",", " ", "1"}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"bins", " ", "for", " ", "the", " ", "contacts", " ", 
    RowBox[{"histogram", ".", " ", "they"}], " ", "are", " ", "exponential"}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"launch", " ", "=", " ", 
   RowBox[{"StringDelete", "[", 
    RowBox[{
     RowBox[{"DateString", "[", 
      RowBox[{"DateObject", "[", "]"}], "]"}], ",", " ", "\"\<:\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ss", " ", "=", " ", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"12", ",", " ", "9"}], "]"}], ",", " ", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"30", ",", " ", "9"}], "]"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "number", " ", "of", " ", "frames", " ", "to", " ", "make", " ", "1", " ", 
     RowBox[{"\[Micro]s", ".", " ", "12"}], " ", "for", " ", "kap"}], ",", 
    " ", 
    RowBox[{"30", " ", "for", " ", "NTF2", " ", 
     RowBox[{"(", 
      RowBox[{"shorter", " ", "timestep"}], ")"}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.888654677147917*^9, 3.888654677418531*^9}, {
   3.888657444185968*^9, 3.888657444396146*^9}, {3.890283079250635*^9, 
   3.8902831008177137`*^9}, {3.890299094206449*^9, 3.890299095344316*^9}, {
   3.890666158279564*^9, 3.8906661672966633`*^9}, {3.891170984095539*^9, 
   3.8911709850367393`*^9}, {3.8911800624128733`*^9, 3.8911800687459507`*^9}, 
   3.891180968816925*^9, {3.89122356705252*^9, 3.89122356732771*^9}, {
   3.891227062924118*^9, 3.891227073074244*^9}, {3.8912295167222757`*^9, 
   3.891229516963114*^9}, {3.891229550344088*^9, 3.891229550561586*^9}, {
   3.891229799702427*^9, 3.8912297999850388`*^9}, {3.9029168088490887`*^9, 
   3.902916922244985*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"74cdc800-a803-49ab-b3b5-9e43bd389e98"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rrNTF2", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{"10", ",", "18"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rrKap", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "9"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rrAll", " ", "=", " ", 
   RowBox[{"Range", "[", 
    RowBox[{"1", ",", "18"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rr", " ", "=", "rrAll"}], ";"}]}], "Input",
 CellChangeTimes->{{3.888728345376219*^9, 3.8887284104955797`*^9}, 
   3.888768357073361*^9, {3.8888113814001703`*^9, 3.8888113862670794`*^9}, {
   3.888815682787898*^9, 3.888815683080368*^9}, {3.8890098891356163`*^9, 
   3.889009889556443*^9}, {3.889010029817203*^9, 3.889010030996443*^9}, {
   3.88901106491284*^9, 3.889011065156363*^9}, {3.889501430391309*^9, 
   3.8895014335106993`*^9}, {3.889506371124014*^9, 3.889506374208626*^9}, {
   3.8895231579646387`*^9, 3.889523158684304*^9}, {3.889765933164733*^9, 
   3.889765934310549*^9}, 3.890121191255362*^9, {3.89012787074723*^9, 
   3.890127873688837*^9}, {3.890128880281604*^9, 3.8901288811569*^9}, {
   3.890208913441346*^9, 3.890208915495635*^9}, {3.8902102031708*^9, 
   3.890210203368404*^9}, 3.890219589808591*^9, {3.890234153206689*^9, 
   3.890234156377314*^9}, 3.8902830726189737`*^9, {3.890283369225473*^9, 
   3.8902833704000196`*^9}, 3.890289574901071*^9, {3.890306065727654*^9, 
   3.890306065785509*^9}, {3.890307965874095*^9, 3.8903079661029673`*^9}, {
   3.8903105420395927`*^9, 3.890310547366033*^9}, {3.890370253977343*^9, 
   3.890370278654914*^9}, 3.891171007543359*^9, {3.891522414544201*^9, 
   3.891522416575129*^9}, 3.902917134808481*^9, 3.902918579685091*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"517ee54e-a310-402d-bcff-b81d1be33253"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "filenumA", ",", "particlesA", ",", " ", "timeA", ",", "timeStepA", 
        ",", " ", "mee2", ",", "hb", ",", "  ", "tre1", ",", 
        RowBox[{"(*", "singleDiffB", "*)"}], " ", 
        RowBox[{"(*", 
         RowBox[{"mee", ",", " ", "meeB", ","}], "*)"}], " ", "histDA", ",", 
        " ", "histZA", ",", " ", "singleDiffMeanB", ",", " ", "singleZMeanB", 
        ",", " ", "histD", ",", " ", "histZ", ",", " ", "listHist", ",", " ", 
        "histDvsZ", ",", " ", "dVsZB", ",", " ", "zRot", ",", " ", "grrD", 
        ",", " ", "grrZ", ",", " ", "histGridA", ",", "s", ",", "rap", ",", 
        " ", "singleCMeanB", ",", "  ", "histC", ",", " ", "histCA", ",", " ",
         "histCvsZ", ",", "listHistC", ",", " ", "cVsZB", ",", " ", "dzcA", 
        ",", " ", "plotHistCvsZA"}], "}"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"filenumA", "=", " ", "j"}], ";", "\[IndentingNewLine]", 
       RowBox[{"s", " ", "=", " ", 
        RowBox[{"ss", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\n", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<File: \>\"", "<>", 
         RowBox[{"StringDelete", "[", 
          RowBox[{
           RowBox[{"fileNames", "[", 
            RowBox[{"[", "filenumA", "]"}], "]"}], ",", " ", "\"\<.h5\>\""}], 
          "]"}], "<>", "\"\< / sampling = \>\"", "<>", " ", 
         RowBox[{"ToString", "[", "s", "]"}], "<>", "\"\< / hop = \>\"", "<>",
          " ", 
         RowBox[{"ToString", "[", "h", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"particlesA", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"100", " ", "+", " ", "i"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"Length", "[", " ", 
              RowBox[{"Import", "[", 
               RowBox[{"fileNames", "[", 
                RowBox[{"[", "filenumA", "]"}], "]"}], "]"}], "]"}], "/", 
             "6"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"timeA", " ", "=", " ", 
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"fileNames", "[", 
           RowBox[{"[", "filenumA", "]"}], "]"}], ",", "\"\<101/time\>\""}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"timeStepA", " ", "=", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"timeA", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{"timeA", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "  ", 
         SuperscriptBox["10", 
          RowBox[{"-", "3"}]]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"tre1", " ", "=", " ", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xyztContacts", "[", "j", "]"}], " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"fileNames", "[", 
                RowBox[{"[", "filenumA", "]"}], "]"}], ",", " ", 
               RowBox[{
                RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\</x\>\""}]}], 
              "]"}], ",", " ", 
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"fileNames", "[", 
                RowBox[{"[", "filenumA", "]"}], "]"}], ",", " ", 
               RowBox[{
                RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\</y\>\""}]}], 
              "]"}], ",", 
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"fileNames", "[", 
                RowBox[{"[", "filenumA", "]"}], "]"}], ",", " ", 
               RowBox[{
                RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\</z\>\""}]}], 
              "]"}], ",", 
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"fileNames", "[", 
                RowBox[{"[", "filenumA", "]"}], "]"}], ",", " ", 
               RowBox[{
                RowBox[{"ToString", "[", "i", "]"}], "<>", 
                "\"\</time\>\""}]}], "]"}], ",", " ", 
             RowBox[{"Import", "[", 
              RowBox[{
               RowBox[{"fileNames", "[", 
                RowBox[{"[", "filenumA", "]"}], "]"}], ",", " ", 
               RowBox[{
                RowBox[{"ToString", "[", "i", "]"}], "<>", 
                "\"\</ncontacts\>\""}]}], "]"}]}], "}"}], "\[Transpose]"}], 
          ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "particlesA"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"import", " ", 
         RowBox[{"{", 
          RowBox[{"x", " ", "y", " ", "z", " ", "t", " ", "contacts"}], "}"}],
          " ", "per", " ", "frame", " ", "per", " ", "particle"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Import (xyztContacts) time = \>\"", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"AbsoluteTime", "[", "]"}], " ", "-", " ", "tre1"}], "]"}],
          "<>", "\"\<s\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tre2", " ", "=", " ", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       "\n", 
       RowBox[{"mee", " ", "=", 
        RowBox[{"xyztContacts", "[", "j", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"meeB", " ", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Partition", "[", 
             RowBox[{"#", ",", " ", 
              RowBox[{"2", " ", "s"}]}], "]"}], "&"}], "/@", "mee"}], ",", 
          "1"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{"particles", " ", "timetraces", " ", 
         RowBox[{"are", " ", "'"}], 
         RowBox[{"chopped", "'"}], " ", "down", " ", "to", " ", "1", " ", 
         RowBox[{"\[Micro]s", ".", " ", "All"}], " ", "different", " ", 
         "Kaps", " ", "mixed", " ", "together"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<partitioning time = \>\"", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"AbsoluteTime", "[", "]"}], " ", "-", " ", "tre2"}], "]"}],
          "<>", "\"\<s\>\""}], "]"}], ";", "\n", 
       RowBox[{"tre3", " ", "=", " ", 
        RowBox[{"AbsoluteTime", "[", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"singleDiffB", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"d", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"meeB", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"meeB", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "s"}], "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"meeB", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"meeB", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "s"}], "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"meeB", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"meeB", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "s"}], "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"meeB", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"meeB", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", 
               RowBox[{"k", "+", "s"}], "]"}], "]"}], "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "@", "meeB"}]}], "}"}], ",", "  ", 
          RowBox[{"{", 
           RowBox[{"k", ",", " ", 
            RowBox[{"s", "-", "1"}]}], "}"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "calculate", " ", "the", " ", "diffusion", " ", "coefficent", " ", 
          "of", " ", "each", " ", "sub"}], "-", 
         RowBox[{"timetrace", " ", "up", " ", "to", " ", "1", "ms"}]}], 
        "*)"}], "\n", 
       RowBox[{"singleDiffMeanB", " ", "=", " ", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Mean", "[", 
            RowBox[{"singleDiffB", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "  ", 
           RowBox[{"{", 
            RowBox[{"i", ",", " ", 
             RowBox[{"Length", "@", "meeB"}]}], "}"}]}], "]"}], "/", 
         "1000"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"averages", " ", "all", " ", "the", " ", "sub"}], "-", 
         RowBox[{
         "timetraces", " ", "\"\<instant by instant\>\"", " ", "and", " ", 
          "converts", " ", "from", " ", 
          RowBox[{
           SuperscriptBox["nm", "2"], "/", "ms"}], " ", "to", " ", 
          RowBox[{
           SuperscriptBox["\[Micro]m", "2"], "/", "s"}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"singleZMeanB", " ", "=", "  ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Mean", "[", 
           RowBox[{
            RowBox[{"meeB", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "3"}], "]"}], "]"}], "]"}], ",", "  ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "@", "meeB"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "averages", " ", "all", " ", "the", " ", "z", " ", "positions", " ", 
         "of", " ", "the", " ", "subtimetraces"}], "*)"}], "\n", 
       RowBox[{"singleCMeanB", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Mean", "[", 
           RowBox[{
            RowBox[{"meeB", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "5"}], "]"}], "]"}], "]"}], ",", "  ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "@", "meeB"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "averages", " ", "all", " ", "the", " ", "contacts", " ", "positions",
          " ", "of", " ", "the", " ", "subtimetraces"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<diffusion calculation time = \>\"", "<>", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"AbsoluteTime", "[", "]"}], " ", "-", " ", "tre3"}], "]"}],
          "<>", "\"\<s\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dVsZB", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"singleDiffMeanB", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
             RowBox[{"singleZMeanB", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "\[Transpose]"}], ",", 
          "  ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "@", "meeB"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"creates", " ", 
          RowBox[{"{", 
           RowBox[{"D", ",", " ", "z"}], "}"}], " ", "list", " ", "per", " ", 
          "sub"}], "-", "timetrace"}], "*)"}], " ", "\[IndentingNewLine]", 
       RowBox[{"cVsZB", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"singleCMeanB", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
             RowBox[{"singleZMeanB", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "\[Transpose]"}], ",", 
          "  ", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", 
            RowBox[{"Length", "@", "meeB"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "below", " ", "we", " ", "build", " ", "all", " ", "the", " ", 
         "histograms", " ", "with", " ", "the", " ", "bins", " ", 
         "previously", " ", "defined"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"histDA", " ", "=", 
        RowBox[{"HistogramList", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "singleDiffMeanB", "]"}], ",", 
          RowBox[{"{", "binLog", "}"}], ",", " ", "\"\<Probability\>\""}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"histD", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MovingAverage", "[", 
            RowBox[{
             RowBox[{"histDA", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], ",", 
           RowBox[{
            RowBox[{"histDA", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/", 
            RowBox[{"Max", "[", 
             RowBox[{"histDA", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}], 
         "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"histZA", " ", "=", 
        RowBox[{"HistogramList", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "singleZMeanB", "]"}], ",", 
          RowBox[{"{", "binZ", "}"}], ",", " ", "\"\<Probability\>\""}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"histZ", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MovingAverage", "[", 
            RowBox[{
             RowBox[{"histZA", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], ",", 
           RowBox[{
            RowBox[{"histZA", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/", 
            RowBox[{"Max", "[", 
             RowBox[{"histZA", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}], 
         "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"histCA", " ", "=", 
        RowBox[{"HistogramList", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", "singleCMeanB", "]"}], ",", 
          RowBox[{"{", "binC", "}"}], ",", " ", "\"\<Probability\>\""}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"histC", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"MovingAverage", "[", 
            RowBox[{
             RowBox[{"histCA", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], ",", 
           RowBox[{
            RowBox[{"histCA", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "/", 
            RowBox[{"Max", "[", 
             RowBox[{"histCA", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], "}"}], 
         "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"listHist", " ", "=", 
        RowBox[{"HistogramList", "[", 
         RowBox[{"dVsZB", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "binLog", "}"}], ",", " ", 
            RowBox[{"{", "binZ", "}"}]}], "}"}], ",", " ", 
          "\"\<Probability\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"listHistC", " ", "=", 
        RowBox[{"HistogramList", "[", 
         RowBox[{"cVsZB", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "binC", "}"}], ",", " ", 
            RowBox[{"{", "binZ", "}"}]}], "}"}], ",", " ", 
          "\"\<Probability\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"plot", " ", "the", " ", "individual", " ", "histograms"}], 
        "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"plotHistD", "[", "j", "]"}], " ", "=", " ", 
        RowBox[{"ListLogLinearPlot", "[", 
         RowBox[{"histD", ",", " ", 
          RowBox[{"PlotStyle", "->", "Blue"}], ",", " ", 
          RowBox[{"Filling", "->", "Bottom"}], ",", " ", 
          RowBox[{"Joined", "->", "True"}], ",", " ", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0.001", "-", " ", "0.00022"}], ",", " ", 
               RowBox[{"500", " ", "+", "20"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "1"}], "}"}]}], "}"}]}], ",", " ", 
          RowBox[{"Frame", "->", "True"}], ",", "  ", 
          RowBox[{"AspectRatio", "->", 
           RowBox[{"1", "/", "4"}]}], ",", "  ", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
             "Black"}], "}"}]}], " ", ",", " ", 
          RowBox[{"FrameLabel", "->", "None"}], ",", " ", 
          RowBox[{"FrameTicks", "->", "None"}], 
          RowBox[{"(*", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Diffusion coefficent (\!\(\*SuperscriptBox[\(\[Micro]m\), \
\(2\)]\)/s)\>\"", ",", " ", "\"\<Frequency\>\""}], "}"}], "*)"}], ",", " ", 
          RowBox[{"GridLines", "->", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", " ", "None"}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"plotHistZ", "[", "j", "]"}], " ", "=", " ", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"histZ", ",", " ", 
          RowBox[{"Filling", "->", "Bottom"}], ",", " ", 
          RowBox[{"Joined", "->", "True"}], ",", " ", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0", " ", "-", "1.5"}], ",", 
               RowBox[{"70", " ", "+", " ", "1"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", " ", 
          RowBox[{"Frame", "->", "True"}], ",", " ", 
          RowBox[{"PlotStyle", "->", "Blue"}], ",", " ", 
          RowBox[{"AspectRatio", "->", 
           RowBox[{"1", "/", "4"}]}], ",", "  ", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
             "Black"}], "}"}]}], " ", ",", " ", 
          RowBox[{"FrameLabel", "->", "None"}], ",", " ", 
          RowBox[{"FrameTicks", "->", "None"}], 
          RowBox[{"(*", 
           RowBox[{"{", 
            RowBox[{"\"\<Z (nm)\>\"", ",", " ", "\"\<Frequency\>\""}], "}"}], 
           "*)"}], ",", " ", 
          RowBox[{"GridLines", "->", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", " ", "None"}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"plotHistC", "[", "j", "]"}], " ", "=", " ", 
        RowBox[{"ListPlot", "[", 
         RowBox[{"histC", ",", " ", 
          RowBox[{"Filling", "->", "Bottom"}], ",", " ", 
          RowBox[{"Joined", "->", "True"}], ",", " ", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0", " ", "-", ".5"}], ",", 
               RowBox[{"30", " ", "+", " ", ".5"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", " ", 
          RowBox[{"Frame", "->", "True"}], ",", " ", 
          RowBox[{"PlotStyle", "->", "Blue"}], ",", " ", 
          RowBox[{"AspectRatio", "->", 
           RowBox[{"1", "/", "4"}]}], ",", "  ", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontSize", "\[Rule]", "12"}], ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
             "Black"}], "}"}]}], " ", ",", " ", 
          RowBox[{"FrameLabel", "->", "None"}], ",", " ", 
          RowBox[{"FrameTicks", "->", "None"}], 
          RowBox[{"(*", 
           RowBox[{"{", 
            RowBox[{"\"\<Z (nm)\>\"", ",", " ", "\"\<Frequency\>\""}], "}"}], 
           "*)"}], ",", " ", 
          RowBox[{"GridLines", "->", 
           RowBox[{"{", 
            RowBox[{"Automatic", ",", " ", "None"}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "build", " ", "and", " ", "plot", " ", "two", " ", "dimendional", " ", 
         RowBox[{"histograms", ".", " ", "contacts"}], " ", "vs", " ", "Z"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"histCvsZ", " ", "=", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"MovingAverage", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"listHistC", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"MovingAverage", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"listHistC", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"listHistC", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], " ", "}"}], 
              "\[Transpose]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{
                  RowBox[{"listHistC", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}]}], "}"}], ",", 
             " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", " ", 
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{
                  RowBox[{"listHistC", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "-", "1"}]}], "}"}]}], 
            " ", "]"}], ",", "1"}], "]"}], "//", "N"}]}], ";", 
       "\[IndentingNewLine]", "\n", 
       RowBox[{"plotHistCvsZA", " ", "=", 
        RowBox[{"ListDensityPlot", "[", 
         RowBox[{"histCvsZ", ",", " ", 
          RowBox[{"InterpolationOrder", "->", "0"}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "30"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "70"}], "}"}], ",", " ", "All"}], 
            "}"}]}], ",", " ", 
          RowBox[{"AspectRatio", "->", "1"}], ",", " ", 
          RowBox[{"ImageSize", "->", "400"}], ",", 
          RowBox[{"ColorFunction", "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Blend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"White", ",", "Blue"}], "}"}], ",", " ", "#1"}], 
              "]"}], "&"}], ")"}]}], ",", 
          RowBox[{"ColorFunctionScaling", "->", "True"}], ",", " ", 
          RowBox[{"PlotRange", "->", "All"}], ",", "  ", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<Contacts\>\"", ",", " ", "\"\<z (nm)\>\""}], "}"}]}],
           ",", " ", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
             "Black"}], "}"}]}], ",", " ", 
          RowBox[{"GridLines", "->", "Automatic"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"plotHistCvsZ", "[", "j", "]"}], "=", " ", "plotHistCvsZA"}], 
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"D", " ", "vs", " ", "Z"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"histDvsZ", " ", "=", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"MovingAverage", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"listHist", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"MovingAverage", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"listHist", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", "2"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", " ", 
                RowBox[{
                 RowBox[{
                  RowBox[{"listHist", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], " ", "}"}], 
              "\[Transpose]"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", 
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{
                  RowBox[{"listHist", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}]}], "}"}], ",", 
             " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", " ", 
               RowBox[{
                RowBox[{"Length", "@", 
                 RowBox[{
                  RowBox[{"listHist", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "-", "1"}]}], "}"}]}], 
            " ", "]"}], ",", "1"}], "]"}], "//", "N"}]}], ";", "\n", 
       RowBox[{
        RowBox[{"plotHistDvsZ", "[", "j", "]"}], " ", "=", 
        RowBox[{"ListDensityPlot", "[", 
         RowBox[{"histDvsZ", ",", " ", 
          RowBox[{"ScalingFunctions", "->", 
           RowBox[{"{", 
            RowBox[{"\"\<Log10\>\"", ",", "None"}], "}"}]}], ",", " ", 
          RowBox[{"InterpolationOrder", "->", "0"}], ",", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0.001", ",", " ", "400"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "70"}], "}"}], ",", " ", "All"}], 
            "}"}]}], ",", " ", 
          RowBox[{"ColorFunction", "->", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Blend", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"White", ",", "Blue"}], "}"}], ",", " ", "#1"}], 
              "]"}], "&"}], ")"}]}], ",", 
          RowBox[{"ColorFunctionScaling", "->", "True"}], ",", " ", 
          RowBox[{"PlotRange", "->", "All"}], ",", "  ", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Diffusion coefficent (\!\(\*SuperscriptBox[\(\[Micro]m\), \
\(2\)]\)/s)\>\"", ",", " ", "\"\<z (nm)\>\""}], "}"}]}], ",", " ", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
             "Black"}], "}"}]}], ",", " ", 
          RowBox[{"GridLines", "->", "Automatic"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"cosmethics", " ", "and", " ", "assembly"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"zRot", " ", "=", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"ImageReflect", "[", 
           RowBox[{"ImageRotate", "[", 
            RowBox[{
             RowBox[{"plotHistZ", "[", "j", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"-", "Pi"}], "/", "2"}]}], "]"}], "]"}], ",", " ", 
          RowBox[{"PlotRangePadding", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "2"}], ",", " ", "0"}], "}"}]}], "}"}]}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"grrD", " ", "=", " ", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"White", ",", 
            RowBox[{"Rectangle", "[", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"10", ",", "1"}], "}"}]}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"ImagePadding", "->", "None"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"grrZ", " ", "=", " ", 
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"White", ",", 
            RowBox[{"Rectangle", "[", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"1", ",", "10"}], "}"}]}], "]"}]}], "}"}], ",", " ", 
          RowBox[{"ImagePadding", "->", "None"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"histGridA", " ", "=", " ", 
        RowBox[{"PlotGrid", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"plotHistD", "[", "j", "]"}], ",", " ", "None", ",", 
              " ", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"grrD", ",", " ", "None", ",", " ", "None"}], "}"}], " ",
             ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"plotHistDvsZ", "[", "j", "]"}], ",", "grrZ", ",", 
              "zRot"}], "}"}]}], "}"}], ",", " ", 
          RowBox[{"AspectRatio", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "1"}], "}"}], "->", "0.3"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", "1"}], "}"}], "->", ".02"}], ",", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "1"}], "}"}], "->", "1"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "2"}], "}"}], "->", "70"}], ",", " ", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "3"}], "}"}], "->", "3"}]}], " ", "}"}]}], 
          ",", " ", 
          RowBox[{"\"\<HideOuterTickLabels\>\"", "->", "False"}], ",", " ", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
             "Black"}], "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"dzcA", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
         "singleDiffMeanB", ",", "singleZMeanB", ",", " ", "singleCMeanB"}], 
         "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"histogramZ", "[", "j", "]"}], " ", "=", " ", "histZ"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"histogramD", "[", "j", "]"}], " ", "=", " ", "histD"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"histogramDvsZ", "[", "j", "]"}], " ", "=", " ", "histDvsZ"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"histogramC", "[", "j", "]"}], " ", "=", " ", "histC"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dzc", "[", "j", "]"}], " ", "=", " ", "dzcA"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<total time \>\"", "<>", " ", 
         RowBox[{"StringDelete", "[", 
          RowBox[{
           RowBox[{"fileNames", "[", 
            RowBox[{"[", "filenumA", "]"}], "]"}], ",", " ", "\"\<.h5\>\""}], 
          "]"}], "<>", "\"\< = \>\"", "<>", 
         RowBox[{"ToString", "[", 
          RowBox[{
           RowBox[{"AbsoluteTime", "[", "]"}], " ", "-", " ", "tre1"}], "]"}],
          "<>", "\"\<s\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\</export/\>\"", "<>",
           "launch", "<>", "\"\</plots/\>\"", "<>", 
          RowBox[{"StringDelete", "[", 
           RowBox[{
            RowBox[{"fileNames", "[", 
             RowBox[{"[", "filenumA", "]"}], "]"}], ",", " ", "\"\<.h5\>\""}],
            "]"}], "<>", "\"\<_gridHistDvsZ.png\>\""}], ",", "histGridA", ",", 
         RowBox[{"ImageResolution", "->", "500"}], ",", " ", 
         RowBox[{"OverwriteTarget", "->", "\"\<KeepBoth\>\""}]}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", ",", " ", 
    RowBox[{"{", 
     RowBox[{"j", ",", " ", "rr"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.866610966257272*^9, 3.8666109824806967`*^9}, 
   3.86661111300806*^9, {3.876390202199662*^9, 3.876390203459754*^9}, {
   3.877436080395021*^9, 3.877436080731986*^9}, {3.87743789941658*^9, 
   3.877437942720709*^9}, {3.8775245224326687`*^9, 3.8775245476586237`*^9}, {
   3.877526317686084*^9, 3.877526365545067*^9}, {3.877526868773394*^9, 
   3.877526887895637*^9}, {3.878635223288615*^9, 3.8786353058389587`*^9}, {
   3.878636581684978*^9, 3.878636601892467*^9}, 3.878636655445355*^9, 
   3.8786371882616863`*^9, 3.8786372441981773`*^9, {3.8786373057249813`*^9, 
   3.878637310484639*^9}, 3.878637455746963*^9, 3.878637498984686*^9, 
   3.8786413817565327`*^9, 3.879390765030747*^9, 3.879390838317243*^9, {
   3.879391132825135*^9, 3.879391134713869*^9}, 3.879391240123163*^9, {
   3.882529373496645*^9, 3.882529382760848*^9}, {3.882529997819746*^9, 
   3.882530002366172*^9}, {3.882530266010931*^9, 3.882530378494485*^9}, 
   3.882530582722891*^9, {3.882531692089402*^9, 3.882531702477083*^9}, {
   3.882533186989501*^9, 3.882533197174889*^9}, {3.8825338084687843`*^9, 
   3.8825338089052687`*^9}, {3.882534056177066*^9, 3.882534061694233*^9}, {
   3.883197215412325*^9, 3.8831972155894213`*^9}, {3.8831974273283653`*^9, 
   3.883197428047501*^9}, {3.883197581306608*^9, 3.883197587283473*^9}, {
   3.8831980349509773`*^9, 3.8831980370602427`*^9}, 3.883198509728307*^9, {
   3.883203837642303*^9, 3.883203854779293*^9}, {3.883203988423925*^9, 
   3.88320401106494*^9}, {3.883204057753414*^9, 3.883204165962825*^9}, {
   3.883204222696143*^9, 3.883204225893713*^9}, {3.883204744234144*^9, 
   3.883204744691819*^9}, {3.883209524583311*^9, 3.883209525686301*^9}, 
   3.88321053812698*^9, 3.883217707180971*^9, 3.883217789122772*^9, 
   3.883221128455001*^9, {3.883660211580608*^9, 3.883660359262311*^9}, {
   3.883660401867886*^9, 3.883660499482442*^9}, {3.8848522605264187`*^9, 
   3.884852261059828*^9}, {3.884852307169593*^9, 3.884852307380886*^9}, {
   3.8848523399394903`*^9, 3.884852341300606*^9}, 3.886047644047797*^9, {
   3.886049815975376*^9, 3.886049817301415*^9}, {3.886050033222212*^9, 
   3.886050038309475*^9}, {3.886050116245861*^9, 3.886050187490262*^9}, {
   3.8860502299386806`*^9, 3.8860502970939093`*^9}, {3.886050360679878*^9, 
   3.8860503612253103`*^9}, {3.886050845376656*^9, 3.8860508838252783`*^9}, 
   3.886145006221806*^9, {3.888642424002305*^9, 3.88864244134381*^9}, {
   3.888642474606084*^9, 3.888642491823039*^9}, {3.888642547488851*^9, 
   3.888642578943026*^9}, {3.888642728448928*^9, 3.888642764479706*^9}, {
   3.888642991084701*^9, 3.8886430098196163`*^9}, 3.888643042384441*^9, {
   3.8886466953157787`*^9, 3.888646735975089*^9}, {3.88864676629875*^9, 
   3.8886467814508667`*^9}, {3.888646814853655*^9, 3.888646859415752*^9}, {
   3.8886469333086853`*^9, 3.888646950281575*^9}, {3.888652814216216*^9, 
   3.888652931967847*^9}, {3.888652974218618*^9, 3.888653067408708*^9}, {
   3.888653284557178*^9, 3.888653402799971*^9}, {3.8886545877778587`*^9, 
   3.888654612770934*^9}, {3.888654662019752*^9, 3.888654663046318*^9}, {
   3.888654696385333*^9, 3.888654769193124*^9}, {3.888654822983424*^9, 
   3.888654837133658*^9}, {3.888656562011013*^9, 3.888656570913252*^9}, 
   3.888656687119039*^9, {3.888656737458749*^9, 3.888656758926619*^9}, {
   3.888656809274165*^9, 3.888656819934967*^9}, {3.888656994967092*^9, 
   3.8886569985155277`*^9}, {3.888657032630262*^9, 3.8886571036097803`*^9}, {
   3.888657246633254*^9, 3.888657289348112*^9}, {3.88865732384723*^9, 
   3.888657410866961*^9}, {3.888657496775964*^9, 3.8886574972056293`*^9}, {
   3.888657547743528*^9, 3.888657562549151*^9}, {3.8886616107301273`*^9, 
   3.8886616220009737`*^9}, 3.888662348728465*^9, {3.8886624304207697`*^9, 
   3.88866243059484*^9}, {3.888669897089691*^9, 3.8886699008325233`*^9}, {
   3.8886699359168663`*^9, 3.88867006917948*^9}, 3.888670919730197*^9, {
   3.888671159282529*^9, 3.888671166116539*^9}, {3.888671373802733*^9, 
   3.888671399533214*^9}, {3.888671468755671*^9, 3.888671482804223*^9}, {
   3.888688928732644*^9, 3.888688951411271*^9}, {3.8886889944556026`*^9, 
   3.8886889976531477`*^9}, {3.888689040960836*^9, 3.8886891078649693`*^9}, {
   3.8886899516148453`*^9, 3.888689965138318*^9}, {3.888690122879801*^9, 
   3.88869015166572*^9}, 3.8886904255754642`*^9, {3.888692748100882*^9, 
   3.888692752027546*^9}, {3.888692801433136*^9, 3.8886928330725946`*^9}, {
   3.888692876665289*^9, 3.888692896714347*^9}, {3.88869294120719*^9, 
   3.888692966550159*^9}, {3.888693574647545*^9, 3.888693605043887*^9}, {
   3.888768345680359*^9, 3.888768348303095*^9}, {3.888811388563407*^9, 
   3.888811390697872*^9}, {3.889009891098235*^9, 3.889009898827181*^9}, {
   3.8890099354522257`*^9, 3.889009947322134*^9}, {3.889009977546311*^9, 
   3.8890100162782907`*^9}, {3.88950135436729*^9, 3.889501411949494*^9}, {
   3.889502616581459*^9, 3.889502616967298*^9}, {3.8895035067238007`*^9, 
   3.889503534022553*^9}, 3.889505634364518*^9, 3.88951853945656*^9, {
   3.8895219048340883`*^9, 3.889521905146162*^9}, {3.890121009090991*^9, 
   3.890121085144434*^9}, {3.890121135665518*^9, 3.890121187173139*^9}, {
   3.89012121748205*^9, 3.890121271876504*^9}, {3.890121719300913*^9, 
   3.8901217209283943`*^9}, {3.890121795722926*^9, 3.8901218045041*^9}, {
   3.890122252795075*^9, 3.890122257627678*^9}, {3.890122624461059*^9, 
   3.890122624865069*^9}, {3.890122664829475*^9, 3.890122691415975*^9}, {
   3.8901227362589703`*^9, 3.890122856576015*^9}, {3.890124931152747*^9, 
   3.890124977394209*^9}, {3.890125023285151*^9, 3.890125063114584*^9}, {
   3.890125107516492*^9, 3.8901251087849007`*^9}, {3.890126912743078*^9, 
   3.890127006703835*^9}, {3.890127051089922*^9, 3.890127057511855*^9}, {
   3.8901272546127377`*^9, 3.8901272846191463`*^9}, {3.890127321573731*^9, 
   3.890127323018455*^9}, {3.8901279031958838`*^9, 3.890127922948492*^9}, {
   3.890128237119727*^9, 3.8901282468817368`*^9}, {3.890128421289879*^9, 
   3.890128422918878*^9}, {3.890208941785717*^9, 3.890208944888522*^9}, {
   3.89020934481975*^9, 3.8902093461368313`*^9}, {3.890234349087491*^9, 
   3.890234381335163*^9}, {3.890283322481509*^9, 3.89028333182043*^9}, {
   3.890289587115324*^9, 3.890289622998445*^9}, {3.8902948339588118`*^9, 
   3.890294838831161*^9}, {3.8902950770521173`*^9, 3.8902951117062902`*^9}, {
   3.8902973993338127`*^9, 3.890297466239563*^9}, {3.890297508640172*^9, 
   3.890297604856324*^9}, {3.890298322019289*^9, 3.890298484487071*^9}, 
   3.890298838965234*^9, {3.890299060325623*^9, 3.890299077996771*^9}, {
   3.890300034646617*^9, 3.890300067708778*^9}, {3.890300213503899*^9, 
   3.890300217856501*^9}, {3.890300324872156*^9, 3.89030033088518*^9}, {
   3.890300802953096*^9, 3.890300803291254*^9}, {3.890300930932406*^9, 
   3.89030096542089*^9}, {3.890301139086484*^9, 3.890301139367406*^9}, {
   3.8903017640098886`*^9, 3.8903018223416758`*^9}, {3.8903021419892693`*^9, 
   3.890302148137507*^9}, {3.890302357447372*^9, 3.8903023722735357`*^9}, {
   3.890303682374812*^9, 3.890303689720343*^9}, {3.890303904723033*^9, 
   3.8903039086188173`*^9}, {3.890304025032552*^9, 3.890304032775931*^9}, {
   3.890304382576405*^9, 3.890304384886097*^9}, {3.890304775982267*^9, 
   3.890304777047557*^9}, 3.890307858432749*^9, {3.890310168084199*^9, 
   3.890310168372921*^9}, {3.890310396857267*^9, 3.890310426805955*^9}, 
   3.890310572793208*^9, 3.8911718126603737`*^9, {3.891171883769622*^9, 
   3.891171961709182*^9}, {3.891172032929315*^9, 3.8911720472691727`*^9}, {
   3.891178227575265*^9, 3.891178314010523*^9}, {3.891178360871386*^9, 
   3.891178595072043*^9}, {3.891178730476988*^9, 3.8911787552373734`*^9}, {
   3.891178801306785*^9, 3.891178818910472*^9}, {3.891178916008526*^9, 
   3.891178920822713*^9}, {3.891178978571459*^9, 3.8911789802558537`*^9}, {
   3.891179319053183*^9, 3.891179346140307*^9}, {3.891179568751877*^9, 
   3.891179599022809*^9}, {3.8911796777475367`*^9, 3.8911796803189917`*^9}, {
   3.89117980592106*^9, 3.8911798104813833`*^9}, {3.891185608637266*^9, 
   3.891185613069056*^9}, 3.8912242053920116`*^9, {3.891227058378285*^9, 
   3.89122720574271*^9}, {3.891227608323804*^9, 3.891227697940839*^9}, {
   3.89122803621523*^9, 3.89122817812038*^9}, 3.8912285908439817`*^9, {
   3.891228675629381*^9, 3.891228681237505*^9}, {3.891228765428814*^9, 
   3.891228901742744*^9}, {3.89122907388628*^9, 3.891229074027195*^9}, {
   3.891229156897263*^9, 3.891229157449497*^9}, {3.891229564194312*^9, 
   3.891229597261491*^9}, {3.891229631548524*^9, 3.891229653981045*^9}, {
   3.89123001073862*^9, 3.891230028561502*^9}, 3.891230452555504*^9, 
   3.891230539352627*^9, {3.891230585161497*^9, 3.8912306530332108`*^9}, {
   3.8912315430087748`*^9, 3.891231543175584*^9}, {3.8912323171937017`*^9, 
   3.891232321050211*^9}, {3.8912404637946568`*^9, 3.891240463975245*^9}, {
   3.891241010297058*^9, 3.8912410335754538`*^9}, {3.891241646956328*^9, 
   3.8912416472113256`*^9}, {3.891241721633616*^9, 3.891241726210194*^9}, 
   3.891241788134392*^9, {3.8915225617809753`*^9, 3.891522563650379*^9}, {
   3.8915299849518013`*^9, 3.89152998875708*^9}, {3.891530019014441*^9, 
   3.8915300413238277`*^9}, {3.8915300789762583`*^9, 3.891530079075047*^9}, {
   3.902917671917697*^9, 3.902917912363783*^9}, {3.9029179872526083`*^9, 
   3.902917989280957*^9}, {3.902919567350573*^9, 3.90291957349825*^9}, {
   3.902919651197674*^9, 3.902919678034441*^9}, {3.902920062796011*^9, 
   3.902920117481555*^9}, {3.902920365513934*^9, 3.902920395107566*^9}, {
   3.902920643110565*^9, 3.902920659419611*^9}, {3.902920721510973*^9, 
   3.9029208019048567`*^9}},ExpressionUUID->"f121540d-71cb-496c-8b78-\
199a66390f95"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Nups analysis", "Section",
 CellChangeTimes->{{3.882434433842217*^9, 
  3.8824344386717243`*^9}},ExpressionUUID->"52de1a85-19b1-416f-a720-\
008eb19e189f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"filenum", " ", "=", " ", "20"}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"pay", " ", "attention", " ", "to", " ", "the", " ", "file", " ", 
    RowBox[{"number", "!"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"condition", " ", "=", " ", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"fileNames", "[", 
       RowBox[{"[", "filenum", "]"}], "]"}], ",", " ", "\"\<Datasets\>\""}], 
     "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "set", " ", "the", " ", "condition", " ", "you", " ", "want", " ", "to", 
    " ", "analyse", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Kap", " ", "/", " ", "NTF2"}], " ", "concentration"}], ")"}]}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"fileNames", "[", 
  RowBox[{"[", "filenum", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"zNupsBeads1", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"fileNames", "[", 
       RowBox[{"[", "filenum", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@", 
   "condition"}]}]}], "Input",
 CellChangeTimes->{{3.882434452914525*^9, 3.8824344538418713`*^9}, {
   3.8824345141264267`*^9, 3.882434602064846*^9}, {3.8824347207354593`*^9, 
   3.882434720898158*^9}, {3.882434768401162*^9, 3.882434783649542*^9}, {
   3.88243530738834*^9, 3.882435345019189*^9}, {3.886611016310294*^9, 
   3.8866110164541273`*^9}, {3.886611071005498*^9, 3.8866110711608*^9}, 
   3.886611163402075*^9, {3.886611206039513*^9, 3.88661122434566*^9}, {
   3.886611391868779*^9, 3.886611403741476*^9}, {3.888731048451619*^9, 
   3.888731048618174*^9}, {3.902920868905694*^9, 
   3.9029209205725317`*^9}},ExpressionUUID->"2b34ff4a-3608-4880-a2b7-\
2ab3839986cc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "there", " ", "is", " ", "an", " ", "error", " ", "in", " ", "no", " ", 
     "Kap", " ", "file"}], ",", " ", 
    RowBox[{"run", " ", "this", " ", "patch"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"zNupsBeads", " ", "=", " ", "zNupsBeads1"}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"zNupsBeads", "[", 
      RowBox[{"[", 
       RowBox[{"-", "2"}], "]"}], "]"}], " ", "=", " ", 
     RowBox[{"zNupsBeads1", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"zNupsBeads", "[", 
      RowBox[{"[", 
       RowBox[{"-", "1"}], "]"}], "]"}], "=", 
     RowBox[{"zNupsBeads1", "[", 
      RowBox[{"[", 
       RowBox[{"-", "2"}], "]"}], "]"}]}], ";"}], "*)"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"hist", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"HistogramList", "[", 
        RowBox[{"#", ",", " ", 
         RowBox[{"{", "1", "}"}], ",", " ", "\"\<Probability\>\""}], "]"}], 
       "&"}], "/@", "zNupsBeads"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
    "builds", " ", "the", " ", "histogram", " ", "with", " ", "bin", " ", "1",
      " ", "nm"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "aesthetics", "*)"}], "\n", 
   RowBox[{
    RowBox[{"color", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"Black", ",", " ", 
       RowBox[{"Blue", "//", "Lighter"}], ",", " ", "Red"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"titleHist", " ", "=", 
    RowBox[{"{", 
     RowBox[{"None", ",", "None", ",", "None"}], "}"}]}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<Nsp1 beads   |   g = 4 nM\>\"", ",", " ", 
       "\"\<Nsp1 beads   |   g = 6 nM\>\"", ",", " ", 
       "\"\<Nsp1 beads   |   g = 9 nM\>\""}], "}"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"legendHist", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Single NTF2\>\"", ",", " ", "\"\<Half saturation\>\"", ",", " ", 
       "\"\<Full saturation\>\""}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"bin", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"BinCounts", "[", 
        RowBox[{"#", ",", " ", 
         RowBox[{"{", "1", "}"}]}], "]"}], "&"}], "/@", "zNupsBeads"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"median", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Median", "[", "#", "]"}], "&"}], "/@", "zNupsBeads"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"lineStyle", "=", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Thin", ",", 
           RowBox[{"color", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"i", "-", "1"}], ",", " ", "3"}], "]"}], " ", "+", 
              "1"}], "]"}], "]"}], ",", "Dashed"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "9"}], "}"}]}], "]"}], ",", "3"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lines", " ", "=", " ", 
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"median", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"median", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "0.1"}], "}"}]}], "}"}], 
          "]"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", " ", "9"}], "}"}]}], "]"}], ",", "3"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.886611142425889*^9, 3.8866112490151787`*^9}, 
   3.888728782875998*^9, 3.888730341288121*^9, {3.888730930958498*^9, 
   3.888730958812737*^9}, {3.888731100866311*^9, 3.888731101897541*^9}, {
   3.902920937957664*^9, 
   3.9029210217376337`*^9}},ExpressionUUID->"7e2073f4-c649-46d6-815f-\
5a4e20127f66"],

Cell[BoxData[
 RowBox[{"(*", "plotting", "*)"}]], "Input",
 CellChangeTimes->{{3.902921008934834*^9, 
  3.902921012056857*^9}},ExpressionUUID->"a5422d0d-8914-4782-b018-\
1624d7079648"],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotHistNups", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Show", "[", "#", "]"}], "&"}], "/@", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"MovingAverage", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"hist", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "2"}], "]"}], ",", " ", 
             RowBox[{
              RowBox[{"hist", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "\[Transpose]"}], ",", 
          " ", 
          RowBox[{"Frame", "->", "True"}], ",", " ", 
          RowBox[{"Filling", "->", "None"}], ",", " ", 
          RowBox[{"Joined", "->", "True"}], ",", " ", 
          RowBox[{"PlotStyle", "->", 
           RowBox[{"color", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"Mod", "[", 
               RowBox[{
                RowBox[{"i", "-", "1"}], ",", " ", "3"}], "]"}], " ", "+", 
              "1"}], "]"}], "]"}]}], ",", 
          RowBox[{"PlotMarkers", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "[", 
                 RowBox[{"{", "Black", "}"}], "]"}], ",", 
                RowBox[{"Disk", "[", "]"}]}], "}"}], "]"}], ",", "7"}], 
            "}"}]}], ",", " ", 
          RowBox[{"PlotRange", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "32"}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"0", ",", " ", "0.1"}], "}"}]}], "}"}]}], ",", " ", 
          RowBox[{"AspectRatio", "->", 
           RowBox[{"1", "/", "3"}]}], ",", " ", 
          RowBox[{"FrameLabel", "->", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\"\<Frequency\>\"", ",", " ", "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Z (nm)\>\"", ",", 
               RowBox[{"titleHist", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"Floor", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "/", "3"}], "]"}], "+", 
                  " ", "1"}], "]"}], "]"}]}], " ", "}"}]}], "}"}]}], ",", 
          RowBox[{"LabelStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"FontSize", "\[Rule]", "16"}], ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
             "Black"}], "}"}]}], ",", " ", 
          RowBox[{"ImageSize", "->", "Large"}], ",", " ", 
          RowBox[{"PlotLegends", "->", 
           RowBox[{"Placed", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"legendHist", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"Mod", "[", 
                  RowBox[{
                   RowBox[{"i", "-", "1"}], ",", " ", "3"}], "]"}], " ", "+", 
                 "1"}], "]"}], "]"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"Right", ",", " ", "Top"}], "}"}]}], "]"}]}], ",", " ", 
          
          RowBox[{"Epilog", "->", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Directive", "[", 
                RowBox[{"{", 
                 RowBox[{"Thick", ",", 
                  RowBox[{"color", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], ",", " ", "Dashed"}], 
                 "}"}], "]"}], ",", 
               RowBox[{
                RowBox[{"lines", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"Floor", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"i", "-", "1"}], ")"}], "/", "3"}], "]"}], "+", 
                   " ", "1"}], "]"}], "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "}"}], ",", " ", 
             RowBox[{"{", 
              RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", "9"}], "}"}]}], "]"}], ",", " ", "3"}], 
     "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.882453305062439*^9, 3.882453318358029*^9}, {
   3.8824536395442657`*^9, 3.882453796884047*^9}, {3.882849367076602*^9, 
   3.882849367307629*^9}, {3.882849938989254*^9, 3.882849958960828*^9}, {
   3.88285000011845*^9, 3.882850002137006*^9}, {3.8828500554688263`*^9, 
   3.882850121012705*^9}, {3.882854683550556*^9, 3.882854707561668*^9}, {
   3.882854851205675*^9, 3.882854882743149*^9}, 3.882854965386897*^9, {
   3.882855111992977*^9, 3.8828551121480503`*^9}, {3.882855310547062*^9, 
   3.882855341639408*^9}, {3.882855373670199*^9, 3.882855378599517*^9}, {
   3.882855487927022*^9, 3.8828555630982723`*^9}, {3.882855797639648*^9, 
   3.882855812720913*^9}, {3.882855844850539*^9, 3.882855923011676*^9}, {
   3.882856095138525*^9, 3.882856097346265*^9}, {3.88285643517091*^9, 
   3.882856628325489*^9}, 3.882856666342514*^9, {3.882856870984271*^9, 
   3.882856887647337*^9}, {3.882856988238408*^9, 3.8828569925835857`*^9}, {
   3.8828575501102457`*^9, 3.882857584780669*^9}, {3.8828576444649878`*^9, 
   3.8828576863645144`*^9}, {3.882857744541147*^9, 3.88285782789894*^9}, {
   3.882857863427294*^9, 3.882857929504157*^9}, {3.882858332935974*^9, 
   3.882858402690955*^9}, {3.8828588382010403`*^9, 3.882858863814253*^9}, {
   3.882858895092443*^9, 3.8828589521820707`*^9}, 3.882859007308213*^9, {
   3.8828591001565437`*^9, 3.8828591277233*^9}, {3.884835288205604*^9, 
   3.884835289577162*^9}, {3.888729136282175*^9, 3.888729136755558*^9}, {
   3.888730885695853*^9, 3.888730909580703*^9}},
 CellLabel->
  "In[390]:=",ExpressionUUID->"5685085f-aaab-4118-8278-fe13e73e7432"],

Cell[BoxData[
 RowBox[{"gridNups", " ", "=", " ", 
  RowBox[{"PlotGrid", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"plotHistNups", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"plotHistNups", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"plotHistNups", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "}"}]}], "}"}], ",", " ", 
    RowBox[{"ImageSize", "->", "Large"}], ",", " ", 
    RowBox[{"\"\<HideOuterTickLabels\>\"", "->", "All"}], ",", 
    RowBox[{"Spacings", "->", "5"}], ",", " ", 
    RowBox[{"\"\<ShowFrameLabels\>\"", "->", "Automatic"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.888728947678279*^9, 3.8887289997435417`*^9}, {
  3.88872903826548*^9, 3.888729044788898*^9}, {3.888729084681718*^9, 
  3.888729088026037*^9}, {3.888729596384283*^9, 3.888729655925721*^9}, {
  3.888729686622669*^9, 3.8887297277865753`*^9}, {3.8887298965926733`*^9, 
  3.8887299579769163`*^9}, {3.888729998901021*^9, 3.888730034315683*^9}, {
  3.888730092990095*^9, 3.888730135449813*^9}, {3.888730178766377*^9, 
  3.888730185540833*^9}, {3.8887302725491056`*^9, 3.88873031676153*^9}},
 CellLabel->
  "In[391]:=",ExpressionUUID->"45fe1da9-6af4-4115-91e8-05d913a560c0"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
    "\"\</export/nups_NTF2.png\>\""}], ",", " ", "gridNups", ",", " ", 
   RowBox[{"ImageResolution", "->", "500"}], ",", 
   RowBox[{"OverwriteTarget", "\[Rule]", "\"\<KeepBoth\>\""}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.888730987426693*^9, 3.888731040980783*^9}, {
  3.8887311285782223`*^9, 3.888731129395117*^9}},
 CellLabel->
  "In[468]:=",ExpressionUUID->"c444db9c-48f0-4531-b6a0-0f0dddd35b33"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nupsExportName", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "\"\<nup_Z_4nM\>\"", ",", "\"\<nup_Z_6nM\>\"", ",", "\"\<nup_Z_9nM\>\""}],
     "}"}]}], " "}], "\[IndentingNewLine]", 
 RowBox[{"Table", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"nupsExportName", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "<>", "\"\<.png\>\""}], ",", " ", 
     RowBox[{"plotHistNups", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
     RowBox[{"ImageResolution", "->", "500"}], ",", 
     RowBox[{"OverwriteTarget", "\[Rule]", "\"\<KeepBoth\>\""}]}], "]"}], ",",
    " ", 
   RowBox[{"{", 
    RowBox[{"i", ",", " ", "3"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.8835797936700907`*^9, 3.883579897896405*^9}, {
  3.886611316795083*^9, 3.886611330491342*^9}, {3.886611454188018*^9, 
  3.8866114584258747`*^9}},
 CellLabel->
  "In[252]:=",ExpressionUUID->"a7d1773a-fe78-4f42-9c11-bde165b3be86"]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
Magnification->1.25,
FrontEndVersion->"13.2 for Mac OS X x86 (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d2a0d6fe-510f-45b1-99eb-36f81a12a612"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Definition"->{
  Cell[7123, 186, 1346, 31, 86, "Section",ExpressionUUID->"b0442a9c-2762-4c8a-a4c8-11fd400fa5a9",
   InitializationCell->True,
   CellTags->{"Definition", "Function", "TemplateCellGroup"},
   CellID->72845326]},
 "Function"->{
  Cell[7123, 186, 1346, 31, 86, "Section",ExpressionUUID->"b0442a9c-2762-4c8a-a4c8-11fd400fa5a9",
   InitializationCell->True,
   CellTags->{"Definition", "Function", "TemplateCellGroup"},
   CellID->72845326]},
 "TemplateCellGroup"->{
  Cell[7123, 186, 1346, 31, 86, "Section",ExpressionUUID->"b0442a9c-2762-4c8a-a4c8-11fd400fa5a9",
   InitializationCell->True,
   CellTags->{"Definition", "Function", "TemplateCellGroup"},
   CellID->72845326]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Definition", 538984, 12759},
 {"Function", 539211, 12764},
 {"TemplateCellGroup", 539447, 12769}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 129, 3, 37, "Input",ExpressionUUID->"4fe4a2a3-ae81-4ad0-a74e-dcec2796e3d1"],
Cell[690, 25, 303, 6, 44, "Text",ExpressionUUID->"03adbc2d-a072-48b0-86ee-efc6951a1b40"],
Cell[CellGroupData[{
Cell[1018, 35, 207, 4, 84, "Section",ExpressionUUID->"30cb82fc-9e3a-4fb0-8586-6c89b6262d88"],
Cell[1228, 41, 648, 14, 37, "Input",ExpressionUUID->"cf0d33eb-ca81-4eb9-b55e-f160825e6732"],
Cell[1879, 57, 653, 15, 37, "Input",ExpressionUUID->"66f48270-8831-431e-9173-cc0fd5bdb869"],
Cell[2535, 74, 735, 14, 64, "Input",ExpressionUUID->"d2bd30ac-935d-40b9-a082-ec414d259944"],
Cell[3273, 90, 1563, 33, 116, "Input",ExpressionUUID->"c9933fd9-cd5e-4fd6-8356-a8542f1bb35b"],
Cell[4839, 125, 1869, 45, 565, "Text",ExpressionUUID->"ecb09c7d-f9f5-4191-87e5-88f7ef1e3dda"],
Cell[6711, 172, 375, 9, 64, "Input",ExpressionUUID->"e7eef984-1bcd-4805-964d-c1ded4b929ca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7123, 186, 1346, 31, 86, "Section",ExpressionUUID->"b0442a9c-2762-4c8a-a4c8-11fd400fa5a9",
 InitializationCell->True,
 CellTags->{"Definition", "Function", "TemplateCellGroup"},
 CellID->72845326],
Cell[CellGroupData[{
Cell[8494, 221, 253, 5, 67, "Subsection",ExpressionUUID->"c518af0f-915f-4520-90a0-63b217343949",
 InitializationCell->True,
 CellID->152203748],
Cell[8750, 228, 1333, 35, 188, "Input",ExpressionUUID->"24d7ed57-2698-4b39-9c01-494c217d342f",
 InitializationCell->True,
 CellID->289096428],
Cell[10086, 265, 574, 14, 84, "Input",ExpressionUUID->"10e2378d-159c-41bc-97cf-fdc7b088f89b",
 InitializationCell->True,
 CellID->306361106],
Cell[10663, 281, 779, 20, 84, "Input",ExpressionUUID->"2287e16d-42db-4595-92f3-ed65300ea569",
 InitializationCell->True,
 CellID->58823102],
Cell[11445, 303, 741, 20, 84, "Input",ExpressionUUID->"9251221f-44a0-4cbf-bbe1-567e91cb0b40",
 InitializationCell->True,
 CellID->923075236],
Cell[12189, 325, 944, 27, 84, "Input",ExpressionUUID->"3bc027a0-7fe0-4f40-b837-32cbe8149dce",
 InitializationCell->True,
 CellID->308709241],
Cell[13136, 354, 759, 20, 136, "Input",ExpressionUUID->"d9fad827-d900-448f-9479-d9f7232cfc37",
 InitializationCell->True,
 CellID->824826724],
Cell[13898, 376, 755, 20, 137, "Input",ExpressionUUID->"c1a6add3-8bed-4f71-9e89-c2c4c4619714",
 InitializationCell->True,
 CellID->390680010],
Cell[CellGroupData[{
Cell[14678, 400, 254, 5, 56, "Subsubsection",ExpressionUUID->"558bdba1-8d51-48ad-b39b-cb8931b05c0e",
 InitializationCell->True,
 CellID->940642573],
Cell[14935, 407, 1443, 44, 70, "Input",ExpressionUUID->"0eff8c2c-0a3c-408c-909d-aa24c7dfc735",
 InitializationCell->True,
 CellID->732001739],
Cell[16381, 453, 2627, 69, 70, "Input",ExpressionUUID->"6e95f046-0028-4960-9c53-14efffff5cf1",
 InitializationCell->True,
 CellID->301248954]
}, Closed]],
Cell[CellGroupData[{
Cell[19045, 527, 257, 5, 45, "Subsubsection",ExpressionUUID->"88a058cd-0aa3-46bf-876c-2d3eaa228f60",
 InitializationCell->True,
 CellID->260283402],
Cell[19305, 534, 3205, 63, 70, "Input",ExpressionUUID->"5e1cb352-d274-4f9a-a758-27f6b59c6496",
 InitializationCell->True,
 CellID->690908896],
Cell[22513, 599, 575, 13, 70, "Input",ExpressionUUID->"0290f93d-272f-4acd-9cd2-a278b2ce6390",
 InitializationCell->True,
 CellID->713837588],
Cell[23091, 614, 4240, 106, 70, "Input",ExpressionUUID->"ece42cca-fc5e-425b-894d-e181b44e7da5",
 InitializationCell->True,
 CellID->820700694],
Cell[27334, 722, 794, 18, 70, "Input",ExpressionUUID->"27d158bb-8e08-472f-b2ce-ce481608afb5",
 InitializationCell->True,
 CellID->916967185],
Cell[28131, 742, 731, 16, 70, "Input",ExpressionUUID->"02de36dc-c868-4ae1-a83e-cad1f47902c1",
 InitializationCell->True,
 CellID->737885415],
Cell[28865, 760, 1522, 34, 70, "Input",ExpressionUUID->"a8f8d46b-7c45-4793-b941-f4eebe491915",
 InitializationCell->True,
 CellID->922123141],
Cell[30390, 796, 2276, 53, 70, "Input",ExpressionUUID->"484a5ef1-c80f-421a-b5ad-f5278bff65ac",
 InitializationCell->True,
 CellID->229041047],
Cell[32669, 851, 12016, 275, 70, "Input",ExpressionUUID->"b72271a1-7b76-42da-8e9c-b482427d21ee",
 InitializationCell->True,
 CellID->292500001]
}, Closed]],
Cell[CellGroupData[{
Cell[44722, 1131, 250, 5, 45, "Subsubsection",ExpressionUUID->"7a870c63-434f-453c-a835-9754eebf1f7f",
 InitializationCell->True,
 CellID->760998641],
Cell[44975, 1138, 6431, 160, 70, "Input",ExpressionUUID->"a81ba905-3353-449e-9c4c-d5d6d13776f0",
 InitializationCell->True,
 CellID->796316054]
}, Closed]],
Cell[CellGroupData[{
Cell[51443, 1303, 251, 5, 45, "Subsubsection",ExpressionUUID->"a5d7b2e4-5bc4-485a-84c1-72492f6dfbfe",
 InitializationCell->True,
 CellID->441622855],
Cell[51697, 1310, 593, 14, 70, "Input",ExpressionUUID->"2c697aa4-c0b8-4257-93ff-22d938f6f834",
 InitializationCell->True,
 CellID->368260565],
Cell[52293, 1326, 2293, 65, 70, "Input",ExpressionUUID->"edeef76b-560e-4fad-b8f0-ac8cf61263ca",
 InitializationCell->True,
 CellID->926230887]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[54635, 1397, 263, 5, 67, "Subsection",ExpressionUUID->"094c3c56-4c10-4e54-9505-9c20fc53625d",
 InitializationCell->True,
 CellID->616778948],
Cell[54901, 1404, 707, 17, 70, "Input",ExpressionUUID->"78b231de-e05f-47cd-a007-8c3fe3137008",
 InitializationCell->True,
 CellID->377657318],
Cell[55611, 1423, 654, 15, 70, "Input",ExpressionUUID->"9c760c82-0515-4f30-9591-3389ed35aeb1",
 InitializationCell->True,
 CellID->563255732],
Cell[56268, 1440, 950, 23, 70, "Input",ExpressionUUID->"5d273c4a-a075-46c8-abaa-afdb387d52f5",
 InitializationCell->True,
 CellID->930882098],
Cell[57221, 1465, 1103, 29, 70, "Input",ExpressionUUID->"2b47f38c-b138-4cf2-a50f-e029acc326ac",
 InitializationCell->True,
 CellID->626549822],
Cell[58327, 1496, 6778, 209, 70, "Input",ExpressionUUID->"3ea0a306-100d-41a1-be33-9bdcf2508239",
 InitializationCell->True,
 CellID->534234148],
Cell[65108, 1707, 819, 20, 70, "Input",ExpressionUUID->"8f6ab0be-bbad-429d-8fbb-a8ef0eacf5ca",
 InitializationCell->True,
 CellID->721367411],
Cell[65930, 1729, 2817, 86, 70, "Input",ExpressionUUID->"2c15302b-0ecd-46d3-bc44-00d0335df4fc",
 InitializationCell->True,
 CellID->108847668]
}, Closed]],
Cell[CellGroupData[{
Cell[68784, 1820, 249, 5, 46, "Subsection",ExpressionUUID->"0d8ff6df-dcab-4ffc-8fda-901aa54ea82f",
 InitializationCell->True,
 CellID->565806496],
Cell[69036, 1827, 1359, 40, 70, "Input",ExpressionUUID->"bee9791a-4218-42ec-8d8e-d9cba2ef404a",
 InitializationCell->True,
 CellID->694794920],
Cell[70398, 1869, 431, 11, 70, "Input",ExpressionUUID->"54860345-4ea1-43ff-98f3-c9b3ff9e78df",
 InitializationCell->True,
 CellID->297140442],
Cell[70832, 1882, 1128, 27, 70, "Input",ExpressionUUID->"23377df4-4951-4b36-9d1c-11825f259607",
 InitializationCell->True,
 CellID->940807826],
Cell[71963, 1911, 1877, 43, 70, "Input",ExpressionUUID->"d6ade48e-643a-4e6f-a42e-3067040ff730",
 InitializationCell->True,
 CellID->248472887],
Cell[73843, 1956, 2146, 56, 70, "Input",ExpressionUUID->"2a8a3a68-f7ac-4969-beb1-0d0b2bd4960c",
 InitializationCell->True,
 CellID->382795528],
Cell[75992, 2014, 669, 17, 70, "Input",ExpressionUUID->"a397b754-136b-41ef-a41f-8fa72ad45d47",
 InitializationCell->True,
 CellID->382204180],
Cell[76664, 2033, 8156, 181, 70, "Input",ExpressionUUID->"ee8996e0-25ee-47dd-b4a9-5a8d748eb716",
 InitializationCell->True,
 CellID->601058855],
Cell[84823, 2216, 500, 13, 70, "Input",ExpressionUUID->"777b740f-b4af-4f35-a2ad-2a79da91aaca",
 InitializationCell->True,
 CellID->450571210],
Cell[85326, 2231, 622, 14, 70, "Input",ExpressionUUID->"cb03ab3e-c562-447d-a949-0bf276eedbc2",
 InitializationCell->True,
 CellID->932096797],
Cell[85951, 2247, 4715, 109, 70, "Input",ExpressionUUID->"1022629a-9a8f-44fc-acdc-5901f81434d0",
 InitializationCell->True,
 CellID->740530040],
Cell[90669, 2358, 1225, 33, 70, "Input",ExpressionUUID->"23385f9f-850f-4ab5-994f-895067d2e23a",
 InitializationCell->True,
 CellID->54921205],
Cell[91897, 2393, 568, 14, 70, "Input",ExpressionUUID->"e9095644-efbc-422e-b9cc-9116e38a1131",
 InitializationCell->True,
 CellID->821709349],
Cell[92468, 2409, 529, 12, 70, "Input",ExpressionUUID->"d019e7dc-7688-41ad-8a94-82ff0dc902fe",
 InitializationCell->True,
 CellID->904915662],
Cell[93000, 2423, 443, 10, 70, "Input",ExpressionUUID->"3f9a98e7-9063-474e-930f-2b71b172e561",
 InitializationCell->True,
 CellID->940433468],
Cell[93446, 2435, 460, 11, 70, "Input",ExpressionUUID->"ed5d81b8-0a91-41a9-b0c4-2de19fb1eb79",
 InitializationCell->True,
 CellID->720206912],
Cell[93909, 2448, 1426, 31, 70, "Input",ExpressionUUID->"55993401-a502-4cb3-b4fc-121dfa8b2f04",
 InitializationCell->True,
 CellID->142680264],
Cell[95338, 2481, 3393, 76, 70, "Input",ExpressionUUID->"b63c9304-f170-4d2a-a7ea-a5d26d6f3f52",
 InitializationCell->True,
 CellID->107678237],
Cell[98734, 2559, 1395, 28, 70, "Input",ExpressionUUID->"d3015dad-24b2-42c4-8f5a-3d3f350ef387",
 InitializationCell->True,
 CellID->250187017]
}, Closed]],
Cell[CellGroupData[{
Cell[100166, 2592, 253, 5, 46, "Subsection",ExpressionUUID->"648574a0-2d04-489e-8c43-f927b0bcce78",
 InitializationCell->True,
 CellID->639419290],
Cell[100422, 2599, 5746, 119, 70, "Input",ExpressionUUID->"c167ae54-09f9-428d-af74-1fe34b55d8ad",
 InitializationCell->True,
 CellID->303179503],
Cell[106171, 2720, 2051, 57, 70, "Input",ExpressionUUID->"2cf2e5d9-112d-4bda-9de8-ddf586782053",
 InitializationCell->True,
 CellID->659952330],
Cell[108225, 2779, 1242, 29, 70, "Input",ExpressionUUID->"07317893-8b67-4a96-8d93-593f2d6d08a1",
 InitializationCell->True,
 CellID->877718539],
Cell[109470, 2810, 1354, 40, 70, "Input",ExpressionUUID->"6e920734-d029-43e1-bbe6-b6584a865eb8",
 InitializationCell->True,
 CellID->107703583],
Cell[110827, 2852, 939, 20, 70, "Input",ExpressionUUID->"ab80ba74-8736-4555-96db-53d51d5014a4",
 InitializationCell->True,
 CellID->147855450],
Cell[111769, 2874, 9027, 179, 70, "Input",ExpressionUUID->"d2375f80-d285-4b1a-ad4c-f70f0a8ba164",
 InitializationCell->True,
 CellID->299137681]
}, Closed]],
Cell[CellGroupData[{
Cell[120833, 3058, 250, 5, 46, "Subsection",ExpressionUUID->"00f457db-8cc5-4a9f-89a1-33599a011ac1",
 InitializationCell->True,
 CellID->359909545],
Cell[121086, 3065, 634, 14, 70, "Input",ExpressionUUID->"10f9b509-be45-4ec2-bd0b-719b39f031ed",
 InitializationCell->True,
 CellID->240991414],
Cell[121723, 3081, 845, 24, 70, "Input",ExpressionUUID->"7f82a039-d41e-4ded-8d95-d296fbceb2d7",
 InitializationCell->True,
 CellID->583224903],
Cell[122571, 3107, 1471, 39, 70, "Input",ExpressionUUID->"251f0c58-7573-470d-8385-dbfdc8382d7e",
 InitializationCell->True,
 CellID->161918558],
Cell[124045, 3148, 1030, 23, 70, "Input",ExpressionUUID->"c67cddaa-f241-469a-aacb-0b624aca687c",
 InitializationCell->True,
 CellID->820312788],
Cell[125078, 3173, 793, 19, 70, "Input",ExpressionUUID->"f02f7477-a651-4267-b387-f956a3a95ac5",
 InitializationCell->True,
 CellID->377721146],
Cell[125874, 3194, 6425, 197, 70, "Input",ExpressionUUID->"bc5bb327-4bb1-4fd4-9056-809c06b1b288",
 InitializationCell->True,
 CellID->180268058],
Cell[132302, 3393, 1290, 31, 70, "Input",ExpressionUUID->"532cea54-f147-4574-897f-f801f3beb5d9",
 InitializationCell->True,
 CellID->884347754],
Cell[133595, 3426, 3142, 65, 70, "Input",ExpressionUUID->"af27519f-ece2-48e9-9c6b-6bfa5ac1e06d",
 InitializationCell->True,
 CellID->234189366],
Cell[136740, 3493, 1541, 33, 70, "Input",ExpressionUUID->"b28e0d31-4edc-4f3d-b795-296a5dbd609b",
 InitializationCell->True,
 CellID->975494157],
Cell[138284, 3528, 2189, 63, 70, "Input",ExpressionUUID->"0e64cd65-2feb-4932-98af-8482c63f9aa2",
 InitializationCell->True,
 CellID->207196137],
Cell[140476, 3593, 986, 27, 70, "Input",ExpressionUUID->"fab2864a-33fc-4c92-9ca0-410474a657d0",
 InitializationCell->True,
 CellID->675298955],
Cell[141465, 3622, 2651, 54, 70, "Input",ExpressionUUID->"ffb1776d-c968-44a3-b257-d439cffc2a6f",
 InitializationCell->True,
 CellID->900120093],
Cell[144119, 3678, 1859, 34, 70, "Input",ExpressionUUID->"a62347c1-634b-41a6-869d-3c2afbf5b1fe",
 InitializationCell->True,
 CellID->763314989],
Cell[CellGroupData[{
Cell[146003, 3716, 314, 6, 70, "Subsubsection",ExpressionUUID->"3948634d-5eca-4def-b5c9-0227fc705cda",
 InitializationCell->True,
 CellID->260816754],
Cell[146320, 3724, 3401, 82, 70, "Input",ExpressionUUID->"2324a58c-4bf3-4a62-a520-e6ef2627b5ed",
 InitializationCell->True,
 CellID->190229175]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[149770, 3812, 313, 6, 46, "Subsection",ExpressionUUID->"03326429-2404-44c3-b912-489e077ae9f0",
 InitializationCell->True,
 CellID->919750589],
Cell[150086, 3820, 381, 8, 64, "Input",ExpressionUUID->"917681e5-f024-4673-9392-3e36465536bf",
 InitializationCell->True,
 CellID->900218393],
Cell[150470, 3830, 479, 12, 37, "Input",ExpressionUUID->"85379755-4147-431b-818e-d1fd8bea5f2a",
 InitializationCell->True,
 CellID->378427751],
Cell[150952, 3844, 5894, 164, 896, "Input",ExpressionUUID->"f23eddde-c58c-4fe0-994e-cec57548260f",
 InitializationCell->True,
 CellID->790853506],
Cell[156849, 4010, 1456, 39, 116, "Input",ExpressionUUID->"2ee887ac-f70b-498a-9bee-14f9813106c1",
 InitializationCell->True,
 CellID->486254629],
Cell[158308, 4051, 3755, 95, 610, "Input",ExpressionUUID->"218e669c-6c21-4a46-89f9-fae5d9766bc6",
 InitializationCell->True,
 CellID->906007813]
}, Closed]],
Cell[CellGroupData[{
Cell[162100, 4151, 262, 5, 46, "Subsection",ExpressionUUID->"acee532d-e461-47c2-9fb8-89649906cb9f",
 InitializationCell->True,
 CellID->529696902],
Cell[CellGroupData[{
Cell[162387, 4160, 252, 5, 70, "Subsubsection",ExpressionUUID->"325db50e-c57d-4bb5-876f-e8f028d4d7c9",
 InitializationCell->True,
 CellID->569693012],
Cell[162642, 4167, 2639, 69, 70, "Input",ExpressionUUID->"378f005d-fcfa-49b6-8813-0bb50ad9906f",
 InitializationCell->True,
 CellID->558972006],
Cell[165284, 4238, 435, 11, 70, "Input",ExpressionUUID->"f89dc21f-6015-4cac-aa86-88bdc93d11c8",
 InitializationCell->True,
 CellID->975237799]
}, Closed]],
Cell[CellGroupData[{
Cell[165756, 4254, 310, 6, 70, "Subsubsection",ExpressionUUID->"94633074-2ade-44be-83ff-d79475fd2640",
 InitializationCell->True,
 CellID->106977048],
Cell[166069, 4262, 1534, 32, 70, "Input",ExpressionUUID->"cfcb3ad9-66b2-4921-8137-1e4156a397a4",
 InitializationCell->True,
 CellID->187238631],
Cell[167606, 4296, 1286, 35, 70, "Input",ExpressionUUID->"f5f59878-6fea-4db7-88eb-3d76f08fed3e",
 InitializationCell->True,
 CellID->102496335],
Cell[168895, 4333, 682, 18, 70, "Input",ExpressionUUID->"173fa9ec-c27a-4589-aa94-2dfde032fc43",
 InitializationCell->True,
 CellID->57346187],
Cell[169580, 4353, 7536, 159, 70, "Input",ExpressionUUID->"d0eb8f25-d061-4c36-8a38-d2ea80367664",
 InitializationCell->True,
 CellID->179999806]
}, Closed]],
Cell[CellGroupData[{
Cell[177153, 4517, 254, 5, 70, "Subsubsection",ExpressionUUID->"f8cdf53c-92dd-4786-b36e-0448b5f4fea0",
 InitializationCell->True,
 CellID->697357334],
Cell[177410, 4524, 1031, 25, 70, "Input",ExpressionUUID->"5e0198bb-eacd-48d5-b0c2-0929efcbcf2b",
 InitializationCell->True,
 CellID->334662486],
Cell[178444, 4551, 2349, 52, 70, "Input",ExpressionUUID->"0d6befdb-a623-4ead-9aae-84f462bd4319",
 InitializationCell->True,
 CellID->652936861],
Cell[180796, 4605, 1925, 48, 70, "Input",ExpressionUUID->"e0cf4751-4f09-404a-8bd0-0312d5176073",
 InitializationCell->True,
 CellID->435925896],
Cell[182724, 4655, 7670, 157, 70, "Input",ExpressionUUID->"f9fef2e2-b5dd-423c-848d-27598c2eab1e",
 InitializationCell->True,
 CellID->721795260]
}, Closed]],
Cell[CellGroupData[{
Cell[190431, 4817, 247, 5, 70, "Subsubsection",ExpressionUUID->"c6745fbb-a2dd-4252-ad35-9969cdd4662a",
 InitializationCell->True,
 CellID->408637084],
Cell[190681, 4824, 13805, 344, 70, "Input",ExpressionUUID->"ee41bf09-28c3-4d97-92e4-22edcb0b0296",
 InitializationCell->True,
 CellID->787997724],
Cell[204489, 5170, 3781, 98, 70, "Input",ExpressionUUID->"a3cc7e5f-be5f-4586-ad9c-80f04a9b5e38",
 InitializationCell->True,
 CellID->787433824],
Cell[208273, 5270, 1198, 30, 70, "Input",ExpressionUUID->"5acca74d-076b-4809-af92-19e1b3a6d41a",
 InitializationCell->True,
 CellID->815931685],
Cell[209474, 5302, 2123, 51, 70, "Input",ExpressionUUID->"63ad67ae-d225-49e3-b7d3-d4be448c38fb",
 InitializationCell->True,
 CellID->76340959],
Cell[211600, 5355, 2357, 55, 70, "Input",ExpressionUUID->"684aa5eb-c05b-4654-b4ba-a9d5940828b8",
 InitializationCell->True,
 CellID->76494887],
Cell[213960, 5412, 6593, 154, 70, "Input",ExpressionUUID->"4ff60b06-b7e0-4bcd-a558-2a4964976415",
 InitializationCell->True,
 CellID->645166440],
Cell[220556, 5568, 4046, 94, 70, "Input",ExpressionUUID->"f8f2b0b0-89a9-4eb0-b492-2df6921b3c05",
 InitializationCell->True,
 CellID->845029217],
Cell[224605, 5664, 591, 16, 70, "Input",ExpressionUUID->"f9b3c71a-c746-4254-8697-f9b29260589b",
 InitializationCell->True,
 CellID->772201501],
Cell[225199, 5682, 11270, 234, 70, "Input",ExpressionUUID->"afeae381-3c99-49bc-9099-5da657ef3c27",
 InitializationCell->True,
 CellID->500707295]
}, Closed]],
Cell[CellGroupData[{
Cell[236506, 5921, 248, 5, 70, "Subsubsection",ExpressionUUID->"c0e41f41-2a15-41e8-888d-f7712a97ae7a",
 InitializationCell->True,
 CellID->15425267],
Cell[236757, 5928, 1099, 30, 70, "Input",ExpressionUUID->"7fd21c8c-7499-40a1-b5b8-e31d4c6d569c",
 InitializationCell->True,
 CellID->80216683],
Cell[237859, 5960, 1720, 34, 70, "Input",ExpressionUUID->"d3fdec20-e737-4c1e-85ab-b596a859e29a",
 InitializationCell->True,
 CellID->730056147],
Cell[239582, 5996, 1366, 32, 70, "Input",ExpressionUUID->"da845074-f0bd-4dda-b82c-3be8a70bb05b",
 InitializationCell->True,
 CellID->800540372],
Cell[240951, 6030, 684, 17, 70, "Input",ExpressionUUID->"1d4ae347-75d7-4ec2-8824-d622f8a00fcc",
 InitializationCell->True,
 CellID->283922630],
Cell[241638, 6049, 1384, 36, 70, "Input",ExpressionUUID->"c06edf69-1525-4ea7-96df-740d96fcb96c",
 InitializationCell->True,
 CellID->646114537],
Cell[243025, 6087, 2615, 46, 70, "Input",ExpressionUUID->"8b1b832a-7864-4f42-80e8-8e0e7233e415",
 InitializationCell->True,
 CellID->472923146]
}, Open  ]],
Cell[CellGroupData[{
Cell[245677, 6138, 277, 5, 70, "Subsubsection",ExpressionUUID->"1eb6c217-0fb2-42d4-bab3-381e690f8c94",
 InitializationCell->True,
 CellID->257574721],
Cell[245957, 6145, 11944, 330, 70, "Input",ExpressionUUID->"148acea2-a2c1-4f50-9f5f-d7bf75ceb578",
 InitializationCell->True,
 CellID->290611100],
Cell[257904, 6477, 1574, 39, 70, "Input",ExpressionUUID->"c56a4a04-0f29-437a-bd70-ce7afe18efca",
 InitializationCell->True,
 CellID->611926726],
Cell[259481, 6518, 4191, 105, 70, "Input",ExpressionUUID->"19be4188-4103-4d9c-83d8-dc843db72b70",
 InitializationCell->True,
 CellID->389552384],
Cell[263675, 6625, 3216, 74, 70, "Input",ExpressionUUID->"d24468db-eb5b-4ebf-959f-fba2226b2eec",
 InitializationCell->True,
 CellID->471851365]
}, Closed]],
Cell[CellGroupData[{
Cell[266928, 6704, 324, 6, 70, "Subsubsection",ExpressionUUID->"a8af4052-d60d-4782-995e-b262fca4c2e7",
 InitializationCell->True,
 CellID->440005765],
Cell[267255, 6712, 617, 13, 70, "Input",ExpressionUUID->"3e6126f7-380f-43b3-845b-cd9a279c8a83",
 InitializationCell->True,
 CellID->544679977],
Cell[267875, 6727, 1822, 42, 70, "Input",ExpressionUUID->"32fb6764-b93b-4aa4-a9bd-f36defe71079",
 InitializationCell->True,
 CellID->478663745],
Cell[269700, 6771, 1135, 25, 70, "Input",ExpressionUUID->"1495592d-c61e-4ff6-b4ae-dc8c15e31c1f",
 InitializationCell->True,
 CellID->850655271],
Cell[270838, 6798, 1555, 40, 70, "Input",ExpressionUUID->"a9f1f399-7891-4e2c-865c-cff95d8bb973",
 InitializationCell->True,
 CellID->40517464],
Cell[272396, 6840, 1434, 43, 70, "Input",ExpressionUUID->"bc29dfd6-6321-4f2f-bcb0-5a456a2abd9b",
 InitializationCell->True,
 CellID->673856316],
Cell[273833, 6885, 1140, 31, 70, "Input",ExpressionUUID->"45050bf3-4ac8-41c8-8f2c-17e67b0f7945",
 InitializationCell->True,
 CellID->673344323],
Cell[274976, 6918, 7362, 165, 70, "Input",ExpressionUUID->"42c10863-7f8b-4b0f-989a-b7a558dda7bb",
 InitializationCell->True,
 CellID->744227904],
Cell[282341, 7085, 5336, 106, 70, "Input",ExpressionUUID->"5ec87228-ab41-4ad2-b835-52c2bb39c317",
 InitializationCell->True,
 CellID->513481655],
Cell[287680, 7193, 1123, 28, 70, "Input",ExpressionUUID->"f5e7a2fe-de0c-4c9e-8b13-6b0deedc723d",
 InitializationCell->True,
 CellID->388956661]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[288852, 7227, 262, 5, 46, "Subsection",ExpressionUUID->"f4624ae0-9755-4e01-951f-2e056fe703dc",
 InitializationCell->True,
 CellID->932789901],
Cell[289117, 7234, 6087, 141, 70, "Input",ExpressionUUID->"5efc3dcd-b2f4-41bf-a79c-d3b4927036ae",
 InitializationCell->True,
 CellID->793998039],
Cell[295207, 7377, 3047, 71, 70, "Input",ExpressionUUID->"0f84ca5f-6775-4083-ad65-9124b58449c6",
 InitializationCell->True,
 CellID->95492130]
}, Closed]],
Cell[CellGroupData[{
Cell[298291, 7453, 249, 5, 46, "Subsection",ExpressionUUID->"a6dcbabb-0fcf-495f-ab8c-bf7e8e0d0166",
 InitializationCell->True,
 CellID->222074788],
Cell[298543, 7460, 2767, 75, 220, "Input",ExpressionUUID->"682b520e-99a5-4741-913d-5912f69ab981",
 InitializationCell->True,
 CellID->181122374],
Cell[301313, 7537, 1364, 31, 262, "Input",ExpressionUUID->"e2d1c32c-e435-4d90-95a8-d5c0d07d9ec5",
 InitializationCell->True,
 CellID->569998995],
Cell[302680, 7570, 990, 27, 94, "Input",ExpressionUUID->"040f9130-e044-4f7b-bcc3-1cc0837776b5",
 InitializationCell->True,
 CellID->496118738],
Cell[303673, 7599, 1539, 35, 136, "Input",ExpressionUUID->"80e918b5-1b0a-4a16-af62-0cf042452d63",
 InitializationCell->True,
 CellID->412091572],
Cell[305215, 7636, 1414, 33, 178, "Input",ExpressionUUID->"e7029e7b-6ec4-4c59-9a44-2cc69b84829a",
 InitializationCell->True,
 CellID->797560982],
Cell[306632, 7671, 2516, 54, 157, "Input",ExpressionUUID->"4b7e240b-9344-42ca-845a-60c311d96d42",
 InitializationCell->True,
 CellID->755403888],
Cell[309151, 7727, 881, 22, 52, "Input",ExpressionUUID->"10f0cafa-407c-48f1-8129-aaa7379ad40e",
 InitializationCell->True,
 CellID->261345476],
Cell[310035, 7751, 3705, 81, 619, "Input",ExpressionUUID->"1715f43f-17a0-43f2-9825-c49d42961c2c",
 InitializationCell->True,
 CellID->607750395],
Cell[313743, 7834, 10752, 224, 1035, "Input",ExpressionUUID->"66c3ba6a-09df-44cb-a04b-cc6e70782f00",
 InitializationCell->True,
 CellID->422156207]
}, Closed]],
Cell[CellGroupData[{
Cell[324532, 8063, 245, 5, 46, "Subsection",ExpressionUUID->"4585abea-ebaa-4636-be77-b55c38129cb7",
 InitializationCell->True,
 CellID->896902103],
Cell[324780, 8070, 563, 13, 70, "Input",ExpressionUUID->"57c454c8-1b72-41e0-95b7-96af91e3c4e2",
 InitializationCell->True,
 CellID->66800584],
Cell[325346, 8085, 426, 10, 70, "Input",ExpressionUUID->"cfffffd0-7510-498d-98ee-41d3fb8e36c7",
 InitializationCell->True,
 CellID->44914782],
Cell[325775, 8097, 882, 20, 70, "Input",ExpressionUUID->"58043040-f895-46c3-bcba-7fb2f1f8fada",
 InitializationCell->True,
 CellID->148941611],
Cell[326660, 8119, 98183, 1950, 14471, "Input",ExpressionUUID->"41e3f9ec-9157-48ad-9d55-ac75f303a04b",
 InitializationCell->True,
 CellID->663758714],
Cell[424846, 10071, 203, 4, 57, "Input",ExpressionUUID->"b16a6ba5-e22e-4f7b-bbda-9082e56ddfc6",
 InitializationCell->True]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[425098, 10081, 201, 4, 65, "Section",ExpressionUUID->"e1eb2d18-e001-4872-85bc-3c0f09883927"],
Cell[CellGroupData[{
Cell[425324, 10089, 506, 8, 67, "Subsection",ExpressionUUID->"6bb7b5ee-cbd7-4952-9ffc-6b93d000d321"],
Cell[425833, 10099, 2903, 73, 264, "Input",ExpressionUUID->"332cec7b-3e82-479b-bb04-0515d7b2c8a6"],
Cell[428739, 10174, 1177, 33, 64, "Input",ExpressionUUID->"811d8229-5be8-46b5-a7cd-f26120f6acc2"],
Cell[429919, 10209, 22212, 521, 1559, "Input",ExpressionUUID->"6bc01139-d2b7-4988-9b49-efa2151e287a"],
Cell[452134, 10732, 4982, 130, 168, "Input",ExpressionUUID->"3c2d6783-1e98-4d59-9906-c7c1d4160611"],
Cell[457119, 10864, 5723, 144, 471, "Input",ExpressionUUID->"b0d27459-57d1-4299-9393-8fcc084fb570"],
Cell[462845, 11010, 5731, 139, 365, "Input",ExpressionUUID->"73b203b1-df71-405a-bdb5-7a6986a45268"],
Cell[468579, 11151, 1657, 36, 90, "Input",ExpressionUUID->"7e4cf6ba-2f3e-4ab0-a462-11ed754e4cec"],
Cell[470239, 11189, 543, 12, 64, "Input",ExpressionUUID->"1eed9959-a836-41d8-80fd-eb541fe7cb62"],
Cell[470785, 11203, 1037, 24, 64, "Input",ExpressionUUID->"d8643d46-b3f3-45ff-b226-c5dc1d7ef2c6"]
}, Closed]],
Cell[CellGroupData[{
Cell[471859, 11232, 418, 6, 46, "Subsection",ExpressionUUID->"55b93bf3-4ef8-4782-bdf1-e8ebcc5f4f2a"],
Cell[472280, 11240, 3633, 93, 233, "Input",ExpressionUUID->"74cdc800-a803-49ab-b3b5-9e43bd389e98"],
Cell[475916, 11335, 1822, 32, 116, "Input",ExpressionUUID->"517ee54e-a310-402d-bcff-b81d1be33253"],
Cell[477741, 11369, 45389, 977, 3212, "Input",ExpressionUUID->"f121540d-71cb-496c-8b78-199a66390f95"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[523179, 12352, 160, 3, 84, "Section",ExpressionUUID->"52de1a85-19b1-416f-a720-008eb19e189f"],
Cell[523342, 12357, 1740, 42, 116, "Input",ExpressionUUID->"2b34ff4a-3608-4880-a2b7-2ab3839986cc"],
Cell[525085, 12401, 4228, 123, 376, "Input",ExpressionUUID->"7e2073f4-c649-46d6-815f-5a4e20127f66"],
Cell[529316, 12526, 184, 4, 37, "Input",ExpressionUUID->"a5422d0d-8914-4782-b018-1624d7079648"],
Cell[529503, 12532, 6213, 141, 298, "Input",ExpressionUUID->"5685085f-aaab-4118-8278-fe13e73e7432"],
Cell[535719, 12675, 1351, 28, 90, "Input",ExpressionUUID->"45fe1da9-6af4-4115-91e8-05d913a560c0"],
Cell[537073, 12705, 521, 12, 37, "Input",ExpressionUUID->"c444db9c-48f0-4531-b6a0-0f0dddd35b33"],
Cell[537597, 12719, 1001, 25, 90, "Input",ExpressionUUID->"a7d1773a-fe78-4f42-9c11-bde165b3be86"]
}, Open  ]]
}
]
*)

